import{A as he,B as ie,C as ne,D as Ut,c as Gt,e as me,g as de,h as q,k as rn,l as K,m as w,n as Z,o as Q,p as X,q as xe,r as Qe,s as an,t as on,u as ee,v as te,w as Ie,x as Re,y as Be,z as ln}from"./chunk-7KW3T4SJ.js";import{a as Ht}from"./chunk-MKP3GHMR.js";import{$b as ke,Ab as pe,Bb as Te,Cb as $e,E as $i,G as Fi,Ib as D,Jb as Ct,Jc as Le,Kb as b,Kc as be,Lb as st,Lc as Pe,M as Gi,Mb as m,Mc as nn,O as se,Oa as ot,Pa as zi,Q as Nt,Ra as qt,S as Ti,Sa as l,Tc as fe,Ub as Ji,V as ve,Vb as $,Wb as J,Wc as T,Xb as a,Xc as sn,Yb as f,Zb as C,_ as g,_b as Y,a as ue,b as Ve,c as Vi,d as Vt,da as E,dc as Yi,e as ce,ea as y,eb as V,ec as Wi,fa as u,fc as Ki,g as mr,ga as S,ha as Ui,ic as Zi,ja as Ot,jc as W,kc as Qi,l as De,m as Ni,mc as I,n as Oi,nb as lt,nc as ye,oc as O,pb as p,pc as Xi,qa as j,qb as $t,ra as Hi,rb as c,sa as wi,t as qi,tb as _e,tc as N,ub as L,vb as P,wb as h,wc as en,xb as i,xc as tn,yb as r,yc as Ze,zb as d}from"./chunk-PPKC6JMY.js";var fn=ce((Yp,Li)=>{"use strict";var ki=(function(n){"use strict";var t=Object.prototype,e=t.hasOwnProperty,o=Object.defineProperty||function(A,_,x){A[_]=x.value},s,v=typeof Symbol=="function"?Symbol:{},F=v.iterator||"@@iterator",R=v.asyncIterator||"@@asyncIterator",B=v.toStringTag||"@@toStringTag";function z(A,_,x){return Object.defineProperty(A,_,{value:x,enumerable:!0,configurable:!0,writable:!0}),A[_]}try{z({},"")}catch{z=function(_,x,M){return _[x]=M}}function Oe(A,_,x,M){var k=_&&_.prototype instanceof je?_:je,G=Object.create(k.prototype),oe=new xt(M||[]);return o(G,"_invoke",{value:_t(A,x,oe)}),G}n.wrap=Oe;function re(A,_,x){try{return{type:"normal",arg:A.call(_,x)}}catch(M){return{type:"throw",arg:M}}}var ge="suspendedStart",qe="suspendedYield",He="executing",Se="completed",ae={};function je(){}function Ae(){}function We(){}var ft={};z(ft,F,function(){return this});var gt=Object.getPrototypeOf,at=gt&&gt(gt(ht([])));at&&at!==t&&e.call(at,F)&&(ft=at);var Ke=We.prototype=je.prototype=Object.create(ft);Ae.prototype=We,o(Ke,"constructor",{value:We,configurable:!0}),o(We,"constructor",{value:Ae,configurable:!0}),Ae.displayName=z(We,B,"GeneratorFunction");function Bt(A){["next","throw","return"].forEach(function(_){z(A,_,function(x){return this._invoke(_,x)})})}n.isGeneratorFunction=function(A){var _=typeof A=="function"&&A.constructor;return _?_===Ae||(_.displayName||_.name)==="GeneratorFunction":!1},n.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,We):(A.__proto__=We,z(A,B,"GeneratorFunction")),A.prototype=Object.create(Ke),A},n.awrap=function(A){return{__await:A}};function et(A,_){function x(G,oe,Fe,Ce){var Ee=re(A[G],A,oe);if(Ee.type==="throw")Ce(Ee.arg);else{var Ai=Ee.arg,St=Ai.value;return St&&typeof St=="object"&&e.call(St,"__await")?_.resolve(St.__await).then(function(tt){x("next",tt,Fe,Ce)},function(tt){x("throw",tt,Fe,Ce)}):_.resolve(St).then(function(tt){Ai.value=tt,Fe(Ai)},function(tt){return x("throw",tt,Fe,Ce)})}}var M;function k(G,oe){function Fe(){return new _(function(Ce,Ee){x(G,oe,Ce,Ee)})}return M=M?M.then(Fe,Fe):Fe()}o(this,"_invoke",{value:k})}Bt(et.prototype),z(et.prototype,R,function(){return this}),n.AsyncIterator=et,n.async=function(A,_,x,M,k){k===void 0&&(k=Promise);var G=new et(Oe(A,_,x,M),k);return n.isGeneratorFunction(_)?G:G.next().then(function(oe){return oe.done?oe.value:G.next()})};function _t(A,_,x){var M=ge;return function(G,oe){if(M===He)throw new Error("Generator is already running");if(M===Se){if(G==="throw")throw oe;return jt()}for(x.method=G,x.arg=oe;;){var Fe=x.delegate;if(Fe){var Ce=Mt(Fe,x);if(Ce){if(Ce===ae)continue;return Ce}}if(x.method==="next")x.sent=x._sent=x.arg;else if(x.method==="throw"){if(M===ge)throw M=Se,x.arg;x.dispatchException(x.arg)}else x.method==="return"&&x.abrupt("return",x.arg);M=He;var Ee=re(A,_,x);if(Ee.type==="normal"){if(M=x.done?Se:qe,Ee.arg===ae)continue;return{value:Ee.arg,done:x.done}}else Ee.type==="throw"&&(M=Se,x.method="throw",x.arg=Ee.arg)}}}function Mt(A,_){var x=_.method,M=A.iterator[x];if(M===s)return _.delegate=null,x==="throw"&&A.iterator.return&&(_.method="return",_.arg=s,Mt(A,_),_.method==="throw")||x!=="return"&&(_.method="throw",_.arg=new TypeError("The iterator does not provide a '"+x+"' method")),ae;var k=re(M,A.iterator,_.arg);if(k.type==="throw")return _.method="throw",_.arg=k.arg,_.delegate=null,ae;var G=k.arg;if(!G)return _.method="throw",_.arg=new TypeError("iterator result is not an object"),_.delegate=null,ae;if(G.done)_[A.resultName]=G.value,_.next=A.nextLoc,_.method!=="return"&&(_.method="next",_.arg=s);else return G;return _.delegate=null,ae}Bt(Ke),z(Ke,B,"Generator"),z(Ke,F,function(){return this}),z(Ke,"toString",function(){return"[object Generator]"});function yi(A){var _={tryLoc:A[0]};1 in A&&(_.catchLoc=A[1]),2 in A&&(_.finallyLoc=A[2],_.afterLoc=A[3]),this.tryEntries.push(_)}function bt(A){var _=A.completion||{};_.type="normal",delete _.arg,A.completion=_}function xt(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(yi,this),this.reset(!0)}n.keys=function(A){var _=Object(A),x=[];for(var M in _)x.push(M);return x.reverse(),function k(){for(;x.length;){var G=x.pop();if(G in _)return k.value=G,k.done=!1,k}return k.done=!0,k}};function ht(A){if(A){var _=A[F];if(_)return _.call(A);if(typeof A.next=="function")return A;if(!isNaN(A.length)){var x=-1,M=function k(){for(;++x<A.length;)if(e.call(A,x))return k.value=A[x],k.done=!1,k;return k.value=s,k.done=!0,k};return M.next=M}}return{next:jt}}n.values=ht;function jt(){return{value:s,done:!0}}return xt.prototype={constructor:xt,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(bt),!A)for(var _ in this)_.charAt(0)==="t"&&e.call(this,_)&&!isNaN(+_.slice(1))&&(this[_]=s)},stop:function(){this.done=!0;var A=this.tryEntries[0],_=A.completion;if(_.type==="throw")throw _.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var _=this;function x(Ce,Ee){return G.type="throw",G.arg=A,_.next=Ce,Ee&&(_.method="next",_.arg=s),!!Ee}for(var M=this.tryEntries.length-1;M>=0;--M){var k=this.tryEntries[M],G=k.completion;if(k.tryLoc==="root")return x("end");if(k.tryLoc<=this.prev){var oe=e.call(k,"catchLoc"),Fe=e.call(k,"finallyLoc");if(oe&&Fe){if(this.prev<k.catchLoc)return x(k.catchLoc,!0);if(this.prev<k.finallyLoc)return x(k.finallyLoc)}else if(oe){if(this.prev<k.catchLoc)return x(k.catchLoc,!0)}else if(Fe){if(this.prev<k.finallyLoc)return x(k.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(A,_){for(var x=this.tryEntries.length-1;x>=0;--x){var M=this.tryEntries[x];if(M.tryLoc<=this.prev&&e.call(M,"finallyLoc")&&this.prev<M.finallyLoc){var k=M;break}}k&&(A==="break"||A==="continue")&&k.tryLoc<=_&&_<=k.finallyLoc&&(k=null);var G=k?k.completion:{};return G.type=A,G.arg=_,k?(this.method="next",this.next=k.finallyLoc,ae):this.complete(G)},complete:function(A,_){if(A.type==="throw")throw A.arg;return A.type==="break"||A.type==="continue"?this.next=A.arg:A.type==="return"?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):A.type==="normal"&&_&&(this.next=_),ae},finish:function(A){for(var _=this.tryEntries.length-1;_>=0;--_){var x=this.tryEntries[_];if(x.finallyLoc===A)return this.complete(x.completion,x.afterLoc),bt(x),ae}},catch:function(A){for(var _=this.tryEntries.length-1;_>=0;--_){var x=this.tryEntries[_];if(x.tryLoc===A){var M=x.completion;if(M.type==="throw"){var k=M.arg;bt(x)}return k}}throw new Error("illegal catch attempt")},delegateYield:function(A,_,x){return this.delegate={iterator:ht(A),resultName:_,nextLoc:x},this.method==="next"&&(this.arg=s),ae}},n})(typeof Li=="object"?Li.exports:{});try{regeneratorRuntime=ki}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=ki:Function("r","regeneratorRuntime = r")(ki)}});var oi=ce((Wp,gn)=>{"use strict";gn.exports=(n,t)=>`${n}-${t}-${Math.random().toString(16).slice(3,8)}`});var Pi=ce((Kp,bn)=>{"use strict";var wo=oi(),_n=0;bn.exports=({id:n,action:t,payload:e={}})=>{let o=n;return typeof o>"u"&&(o=wo("Job",_n),_n+=1),{id:o,action:t,payload:e}}});var li=ce(Dt=>{"use strict";var Ii=!1;Dt.logging=Ii;Dt.setLogging=n=>{Ii=n};Dt.log=(...n)=>Ii?console.log.apply(Dt,n):null});var Cn=ce((hn,Sn)=>{"use strict";var Do=Pi(),{log:si}=li(),ko=oi(),xn=0;Sn.exports=()=>{let n=ko("Scheduler",xn),t={},e={},o=[];xn+=1;let s=()=>o.length,v=()=>Object.keys(t).length,F=()=>{if(o.length!==0){let re=Object.keys(t);for(let ge=0;ge<re.length;ge+=1)if(typeof e[re[ge]]>"u"){o[0](t[re[ge]]);break}}},R=(re,ge)=>new Promise((qe,He)=>{let Se=Do({action:re,payload:ge});o.push(async ae=>{o.shift(),e[ae.id]=Se;try{qe(await ae[re].apply(hn,[...ge,Se.id]))}catch(je){He(je)}finally{delete e[ae.id],F()}}),si(`[${n}]: Add ${Se.id} to JobQueue`),si(`[${n}]: JobQueue length=${o.length}`),F()});return{addWorker:re=>(t[re.id]=re,si(`[${n}]: Add ${re.id}`),si(`[${n}]: Number of workers=${v()}`),F(),re.id),addJob:async(re,...ge)=>{if(v()===0)throw Error(`[${n}]: You need to have at least one worker before adding jobs`);return R(re,ge)},terminate:async()=>{Object.keys(t).forEach(async re=>{await t[re].terminate()}),o=[]},getQueueLen:s,getNumWorkers:v}}});var yn=ce((Qp,En)=>{"use strict";En.exports=n=>{let t={};return typeof WorkerGlobalScope<"u"?t.type="webworker":typeof document=="object"?t.type="browser":typeof process=="object"&&typeof Vi=="function"&&(t.type="node"),typeof n>"u"?t:t[n]}});var Fn=ce((ec,An)=>{"use strict";var Lo=yn()("type")==="browser",Po=Lo?n=>new URL(n,window.location.href).href:n=>n;An.exports=n=>{let t=ue({},n);return["corePath","workerPath","langPath"].forEach(e=>{n[e]&&(t[e]=Po(t[e]))}),t}});var Ri=ce((ic,Tn)=>{"use strict";Tn.exports={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}});var wn=ce((nc,Io)=>{Io.exports={name:"tesseract.js",version:"7.0.0",description:"Pure Javascript Multilingual OCR",main:"src/index.js",type:"commonjs",types:"src/index.d.ts",unpkg:"dist/tesseract.min.js",jsdelivr:"dist/tesseract.min.js",scripts:{start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser test:node:all","test:browser":"karma start karma.conf.js","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.mjs","test:node:all":"npm run test:node -- ./tests/*.test.mjs",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},browser:{"./src/worker/node/index.js":"./src/worker/browser/index.js"},author:"",contributors:["jeromewu"],license:"Apache-2.0",devDependencies:{"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","npm-run-all":"^4.1.5",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-webpack":"^5.0.0",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},dependencies:{"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^7.0.0","wasm-feature-detect":"^1.8.0",zlibjs:"^0.3.1"},overrides:{"@rollup/pluginutils":"^5.0.2"},repository:{type:"git",url:"https://github.com/naptha/tesseract.js.git"},bugs:{url:"https://github.com/naptha/tesseract.js/issues"},homepage:"https://github.com/naptha/tesseract.js",collective:{type:"opencollective",url:"https://opencollective.com/tesseractjs"}}});var kn=ce((rc,Dn)=>{"use strict";Dn.exports={workerBlobURL:!0,logger:()=>{}}});var Pn=ce((ac,Ln)=>{"use strict";var Ro=wn().version,Bo=kn();Ln.exports=Ve(ue({},Bo),{workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${Ro}/dist/worker.min.js`})});var Rn=ce((lc,In)=>{"use strict";In.exports=({workerPath:n,workerBlobURL:t})=>{let e;if(Blob&&URL&&t){let o=new Blob([`importScripts("${n}");`],{type:"application/javascript"});e=new Worker(URL.createObjectURL(o))}else e=new Worker(n);return e}});var Mn=ce((sc,Bn)=>{"use strict";Bn.exports=n=>{n.terminate()}});var Vn=ce((mc,jn)=>{"use strict";jn.exports=(n,t)=>{n.onmessage=({data:e})=>{t(e)}}});var On=ce((dc,Nn)=>{"use strict";Nn.exports=async(n,t)=>{n.postMessage(t)}});var $n=ce((uc,qn)=>{"use strict";var Bi=n=>new Promise((t,e)=>{let o=new FileReader;o.onload=()=>{t(o.result)},o.onerror=({target:{error:{code:s}}})=>{e(Error(`File could not be read! Code=${s}`))},o.readAsArrayBuffer(n)}),Mi=async n=>{let t=n;if(typeof n>"u")return"undefined";if(typeof n=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n)?t=atob(n.split(",")[1]).split("").map(e=>e.charCodeAt(0)):t=await(await fetch(n)).arrayBuffer();else if(typeof HTMLElement<"u"&&n instanceof HTMLElement)n.tagName==="IMG"&&(t=await Mi(n.src)),n.tagName==="VIDEO"&&(t=await Mi(n.poster)),n.tagName==="CANVAS"&&await new Promise(e=>{n.toBlob(async o=>{t=await Bi(o),e()})});else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){let e=await n.convertToBlob();t=await Bi(e)}else(n instanceof File||n instanceof Blob)&&(t=await Bi(n));return new Uint8Array(t)};qn.exports=Mi});var Un=ce((pc,Gn)=>{"use strict";var Mo=Pn(),jo=Rn(),Vo=Mn(),No=Vn(),Oo=On(),qo=$n();Gn.exports={defaultOptions:Mo,spawnWorker:jo,terminateWorker:Vo,onMessage:No,send:Oo,loadImage:qo}});var ji=ce((cc,Yn)=>{"use strict";var $o=Fn(),Ye=Pi(),{log:Hn}=li(),Go=oi(),rt=Ri(),{defaultOptions:Uo,spawnWorker:Ho,terminateWorker:zo,onMessage:Jo,loadImage:zn,send:Yo}=Un(),Jn=0;Yn.exports=async(n="eng",t=rt.LSTM_ONLY,e={},o={})=>{let s=Go("Worker",Jn),A=$o(ue(ue({},Uo),e)),{logger:v,errorHandler:F}=A,R=Vt(A,["logger","errorHandler"]),B={},z=typeof n=="string"?n.split("+"):n,Oe=t,re=o,ge=[rt.DEFAULT,rt.LSTM_ONLY].includes(t)&&!R.legacyCore,qe,He,Se=new Promise((_,x)=>{He=_,qe=x}),ae=_=>{qe(_.message)},je=Ho(R);je.onerror=ae,Jn+=1;let Ae=({id:_,action:x,payload:M})=>new Promise((k,G)=>{Hn(`[${s}]: Start ${_}, action=${x}`);let oe=`${x}-${_}`;B[oe]={resolve:k,reject:G},Yo(je,{workerId:s,jobId:_,action:x,payload:M})}),We=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),ft=_=>Ae(Ye({id:_,action:"load",payload:{options:{lstmOnly:ge,corePath:R.corePath,logging:R.logging}}})),gt=(_,x,M)=>Ae(Ye({id:M,action:"FS",payload:{method:"writeFile",args:[_,x]}})),at=(_,x)=>Ae(Ye({id:x,action:"FS",payload:{method:"readFile",args:[_,{encoding:"utf8"}]}})),Ke=(_,x)=>Ae(Ye({id:x,action:"FS",payload:{method:"unlink",args:[_]}})),Bt=(_,x,M)=>Ae(Ye({id:M,action:"FS",payload:{method:_,args:x}})),et=(_,x)=>Ae(Ye({id:x,action:"loadLanguage",payload:{langs:_,options:{langPath:R.langPath,dataPath:R.dataPath,cachePath:R.cachePath,cacheMethod:R.cacheMethod,gzip:R.gzip,lstmOnly:[rt.DEFAULT,rt.LSTM_ONLY].includes(Oe)&&!R.legacyLang}}})),_t=(_,x,M,k)=>Ae(Ye({id:k,action:"initialize",payload:{langs:_,oem:x,config:M}})),Mt=(_="eng",x,M,k)=>{if(ge&&[rt.TESSERACT_ONLY,rt.TESSERACT_LSTM_COMBINED].includes(x))throw Error("Legacy model requested but code missing.");let G=x||Oe;Oe=G;let oe=M||re;re=oe;let Ce=(typeof _=="string"?_.split("+"):_).filter(Ee=>!z.includes(Ee));return z.push(...Ce),Ce.length>0?et(Ce,k).then(()=>_t(_,G,oe,k)):_t(_,G,oe,k)},yi=(_={},x)=>Ae(Ye({id:x,action:"setParameters",payload:{params:_}})),bt=async(_,x={},M={text:!0},k)=>Ae(Ye({id:k,action:"recognize",payload:{image:await zn(_),options:x,output:M}})),xt=async(_,x)=>{if(ge)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return Ae(Ye({id:x,action:"detect",payload:{image:await zn(_)}}))},ht=async()=>(je!==null&&(zo(je),je=null),Promise.resolve());Jo(je,({workerId:_,jobId:x,status:M,action:k,data:G})=>{let oe=`${k}-${x}`;if(M==="resolve")Hn(`[${_}]: Complete ${x}`),B[oe].resolve({jobId:x,data:G}),delete B[oe];else if(M==="reject")if(B[oe].reject(G),delete B[oe],k==="load"&&qe(G),F)F(G);else throw Error(G);else M==="progress"&&v(Ve(ue({},G),{userJobId:x}))});let jt={id:s,worker:je,load:We,writeText:gt,readText:at,removeFile:Ke,FS:Bt,reinitialize:Mt,setParameters:yi,recognize:bt,detect:xt,terminate:ht};return ft().then(()=>et(n)).then(()=>_t(n,t,o)).then(()=>He(jt)).catch(()=>{}),Se}});var Zn=ce((fc,Kn)=>{"use strict";var Wn=ji(),Wo=async(n,t,e)=>{let o=await Wn(t,1,e);return o.recognize(n).finally(async()=>{await o.terminate()})},Ko=async(n,t)=>{let e=await Wn("osd",0,t);return e.detect(n).finally(async()=>{await e.terminate()})};Kn.exports={recognize:Wo,detect:Ko}});var Xn=ce((gc,Qn)=>{"use strict";Qn.exports={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}});var tr=ce((_c,er)=>{"use strict";er.exports={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}});var nr=ce((bc,ir)=>{"use strict";fn();var Zo=Cn(),Qo=ji(),Xo=Zn(),el=Xn(),tl=Ri(),il=tr(),{setLogging:nl}=li();ir.exports=ue({languages:el,OEM:tl,PSM:il,createScheduler:Zo,createWorker:Qo,setLogging:nl},Xo)});var U=n=>{let t=g(sn),e=g(de),o=n.data.permission;return o?t.hasPermission(o)?!0:e.createUrlTree(["/error/403"]):!0};function Me(n,t){let e=t?.injector??g(Ui),o=new Ni(1),s=Hi(()=>{let v;try{v=n()}catch(F){wi(()=>o.error(F));return}wi(()=>o.next(v))},{injector:e,manualCleanup:!0});return e.get(Ot).onDestroy(()=>{s.destroy(),o.complete()}),o.asObservable()}function we(n,t){let o=!t?.manualCleanup?t?.injector?.get(Ot)??g(Ot):null,s=dr(t?.equal),v;t?.requireSync?v=j({kind:0},{equal:s}):v=j({kind:1,value:t?.initialValue},{equal:s});let F,R=n.subscribe({next:B=>v.set({kind:1,value:B}),error:B=>{v.set({kind:2,error:B}),F?.()},complete:()=>{F?.()}});if(t?.requireSync&&v().kind===0)throw new Ti(601,!1);return F=o?.onDestroy(R.unsubscribe.bind(R)),N(()=>{let B=v();switch(B.kind){case 1:return B.value;case 2:throw B.error;case 0:throw new Ti(601,!1)}},{equal:t?.equal})}function dr(n=Object.is){return(t,e)=>t.kind===1&&e.kind===1&&n(t.value,e.value)}var mt=class n{http=g(fe);getAll(){return this.http.get(`${T.apiUrl}/users`)}getPaged(t,e){return this.http.get(`${T.apiUrl}/users`,{params:{page:t,pageSize:e}})}getById(t){return this.http.get(`${T.apiUrl}/users/${t}`)}create(t){return this.http.post(`${T.apiUrl}/users`,t)}update(t,e){return this.http.patch(`${T.apiUrl}/users/${t}`,e)}delete(t){return this.http.delete(`${T.apiUrl}/users/${t}`)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})};var ze=class n{http=g(fe);getAll(){return this.http.get(`${T.apiUrl}/roles`)}getById(t){return this.http.get(`${T.apiUrl}/roles/${t}`)}create(t){return this.http.post(`${T.apiUrl}/roles`,t)}update(t,e){return this.http.patch(`${T.apiUrl}/roles/${t}`,e)}delete(t){return this.http.delete(`${T.apiUrl}/roles/${t}`)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})};var ur=n=>[n,"edit"],pr=n=>[n],cr=(n,t)=>t.id;function vr(n,t){if(n&1&&(i(0,"div",21),a(1),r()),n&2){let e=m().$implicit;l(),C("\u4EE3\u7406\u4EBA\uFF1A",e.agentName)}}function fr(n,t){if(n&1&&(i(0,"div",24),a(1),I(2,"date"),r()),n&2){let e=m().$implicit;l(),C("\u96E2\u8077\uFF1A",O(2,1,e.resignDate,"yyyy-MM-dd"))}}function gr(n,t){if(n&1&&(i(0,"span",25),a(1),r()),n&2){let e=t.$implicit,o=m(2);l(),f(o.getRoleNames(W(1,pr,e)))}}function _r(n,t){if(n&1){let e=D();i(0,"tr")(1,"td")(2,"div",20),a(3),r(),p(4,vr,2,1,"div",21),r(),i(5,"td",22),a(6),r(),i(7,"td",15),a(8),r(),i(9,"td",15),a(10),r(),i(11,"td",23),a(12),I(13,"date"),p(14,fr,3,4,"div",24),r(),i(15,"td",16),a(16),I(17,"currency"),r(),i(18,"td"),L(19,gr,2,3,"span",25,_e),r(),i(21,"td",17)(22,"span",26),a(23),r()(),i(24,"td",27)(25,"div",28)(26,"a",29),u(),i(27,"svg",7),d(28,"use",30),r()(),S(),i(29,"button",31),b("click",function(){let s=E(e).$implicit,v=m();return y(v.delete(s))}),u(),i(30,"svg",7),d(31,"use",32),r()()()()()}if(n&2){let e=t.$implicit;l(3),f(e.name),l(),c(e.agentName?4:-1),l(2),f(e.email),l(2),C(" ",e.departmentName||"\u2014"," "),l(2),C(" ",e.jobTitleName||"\u2014"," "),l(2),C(" ",e.hireDate?O(13,14,e.hireDate,"yyyy-MM-dd"):"\u2014"," "),l(2),c(e.resignDate?14:-1),l(2),C(" ",e.baseSalary?Xi(17,17,e.baseSalary,"TWD","symbol","1.0-0"):"\u2014"," "),l(3),P(e.roleIds),l(3),$("bg-success",e.status==="active")("bg-secondary",e.status==="inactive"),l(),C(" ",e.status==="active"?"\u5728\u8077":"\u96E2\u8077"," "),l(3),h("routerLink",W(22,ur,e.id))}}function br(n,t){n&1&&(i(0,"tr")(1,"td",33),a(2,"\u5C1A\u7121\u54E1\u5DE5\u8CC7\u6599\u3002"),r()())}function xr(n,t){n&1&&(i(0,"li",41)(1,"span",43),a(2,"\u2026"),r()())}function hr(n,t){if(n&1){let e=D();i(0,"li",39)(1,"button",40),b("click",function(){E(e);let s=m().$implicit,v=m(2);return y(v.goTo(s))}),a(2),r()()}if(n&2){let e=m().$implicit,o=m(2);$("active",e===o.page()),l(2),f(e)}}function Sr(n,t){if(n&1&&p(0,xr,3,0,"li",41)(1,hr,3,3,"li",42),n&2){let e=t.$implicit;c(e===-1?0:1)}}function Cr(n,t){if(n&1){let e=D();i(0,"div",19)(1,"span",34),a(2),r(),i(3,"div",35)(4,"button",36),b("click",function(){E(e);let s=m();return y(s.prev())}),a(5,"\u2039"),r(),i(6,"span",37),a(7),r(),i(8,"button",36),b("click",function(){E(e);let s=m();return y(s.next())}),a(9,"\u203A"),r()(),i(10,"ul",38)(11,"li",39)(12,"button",40),b("click",function(){E(e);let s=m();return y(s.prev())}),a(13,"\u2039"),r()(),L(14,Sr,2,1,null,null,_e),i(16,"li",39)(17,"button",40),b("click",function(){E(e);let s=m();return y(s.next())}),a(18,"\u203A"),r()()()()}if(n&2){let e=m();l(2),ke("\u5171 ",e.totalCount()," \u7B46\uFF0C\u7B2C ",e.page()," / ",e.totalPages()," \u9801"),l(2),$("disabled",e.page()===1),l(3),Y("",e.page()," / ",e.totalPages()),l(),$("disabled",e.page()===e.totalPages()),l(3),$("disabled",e.page()===1),l(3),P(e.pageNumbers()),l(2),$("disabled",e.page()===e.totalPages())}}var zt=class n{userService=g(mt);roleService=g(ze);roles=we(this.roleService.getAll(),{initialValue:[]});PAGE_SIZE=20;page=j(1);refresh=j(0);result=we(Me(N(()=>({page:this.page(),refresh:this.refresh()}))).pipe(se(({page:t})=>this.userService.getPaged(t,this.PAGE_SIZE))),{initialValue:{items:[],totalCount:0,page:1,pageSize:20,totalPages:1}});pagedUsers=N(()=>this.result().items);totalCount=N(()=>this.result().totalCount);totalPages=N(()=>this.result().totalPages);pageNumbers=N(()=>Er(this.page(),this.totalPages()));goTo(t){this.page.set(t)}prev(){this.page()>1&&this.page.update(t=>t-1)}next(){this.page()<this.totalPages()&&this.page.update(t=>t+1)}getRoleNames(t){let e=this.roles();return t.map(o=>e.find(s=>s.id===o)?.name??o).join(", ")}delete(t){confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u54E1\u5DE5\u300C${t.name}\u300D\u55CE\uFF1F`)&&this.userService.delete(t.id).subscribe(()=>this.refresh.update(e=>e+1))}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-user-list"]],decls:40,vars:2,consts:[[1,"container-fluid","py-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-2","mb-6"],[1,"flex","items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#user"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","inline-flex","items-center","gap-1"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"hidden","md:table-cell"],[1,"hidden","lg:table-cell"],[1,"hidden","xl:table-cell"],[1,"hidden","sm:table-cell"],[1,"text-right"],[1,"flex","flex-col","gap-2","sm:flex-row","sm:items-center","sm:justify-between","px-4","py-3","border-t"],[1,"fw-500"],[1,"text-muted","small"],[1,"text-muted","hidden","md:table-cell"],[1,"text-muted","small","hidden","xl:table-cell"],[1,"text-danger"],[1,"badge","bg-secondary","me-1"],[1,"badge"],[1,"text-right",2,"white-space","nowrap"],[1,"flex","justify-end","gap-1"],[1,"btn","btn-sm","btn-ghost-primary","inline-flex","items-center",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],[1,"btn","btn-sm","btn-ghost-danger","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#trash"],["colspan","9",1,"text-center","text-muted","py-4"],[1,"text-muted","small","text-center","sm:text-left"],[1,"flex","sm:hidden","items-center","gap-1"],[1,"page-link","rounded",3,"click"],[1,"px-2","text-sm"],[1,"hidden","sm:flex","pagination","mb-0"],[1,"page-item"],[1,"page-link",3,"click"],[1,"page-item","disabled"],[1,"page-item",3,"active"],[1,"page-link"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),u(),i(3,"svg",3),d(4,"use",4),r(),S(),i(5,"h4",5),a(6,"\u54E1\u5DE5\u7BA1\u7406"),r()(),i(7,"a",6),u(),i(8,"svg",7),d(9,"use",8),r(),a(10," \u65B0\u589E\u54E1\u5DE5 "),r()(),S(),i(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u59D3\u540D"),r(),i(19,"th",14),a(20,"Email"),r(),i(21,"th",15),a(22,"\u90E8\u9580"),r(),i(23,"th",15),a(24,"\u8077\u7A31"),r(),i(25,"th",16),a(26,"\u5165\u8077\u65E5"),r(),i(27,"th",16),a(28,"\u5E95\u85AA"),r(),i(29,"th"),a(30,"\u89D2\u8272"),r(),i(31,"th",17),a(32,"\u72C0\u614B"),r(),i(33,"th",18),a(34,"\u64CD\u4F5C"),r()()(),i(35,"tbody"),L(36,_r,32,24,"tr",null,cr,!1,br,3,0,"tr"),r()()(),p(39,Cr,19,13,"div",19),r()()()),e&2&&(l(36),P(o.pagedUsers()),l(3),c(o.totalPages()>1?39:-1))},dependencies:[q,be,nn],encapsulation:2})};function Er(n,t){if(t<=9)return Array.from({length:t},(s,v)=>v+1);let e=[],o=0;for(let s=1;s<=t;s++)(s===1||s===t||s>=n-2&&s<=n+2)&&(o&&s-o>1&&e.push(-1),e.push(s),o=s);return e}var Ge=class n{http=g(fe);getAll(){return this.http.get(`${T.apiUrl}/departments`)}getById(t){return this.http.get(`${T.apiUrl}/departments/${t}`)}create(t){return this.http.post(`${T.apiUrl}/departments`,t)}update(t,e){return this.http.patch(`${T.apiUrl}/departments/${t}`,e)}delete(t){return this.http.delete(`${T.apiUrl}/departments/${t}`)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})};var Je=class n{http=g(fe);getAll(){return this.http.get(`${T.apiUrl}/job-titles`)}getById(t){return this.http.get(`${T.apiUrl}/job-titles/${t}`)}create(t){return this.http.post(`${T.apiUrl}/job-titles`,t)}update(t,e){return this.http.patch(`${T.apiUrl}/job-titles/${t}`,e)}delete(t){return this.http.delete(`${T.apiUrl}/job-titles/${t}`)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})};var Jt=(n,t)=>t.id;function yr(n,t){if(n&1&&(i(0,"div",6),u(),i(1,"svg",39),d(2,"use",40),r(),a(3),r()),n&2){let e=m();l(3),C(" ",e.errorMsg()," ")}}function Ar(n,t){n&1&&(i(0,"div",18),a(1,"\u8ACB\u8F38\u5165\u59D3\u540D\u3002"),r())}function Fr(n,t){n&1&&(i(0,"div",18),a(1,"\u8ACB\u8F38\u5165\u6709\u6548\u7684\u96FB\u5B50\u90F5\u4EF6\u3002"),r())}function Tr(n,t){if(n&1&&(i(0,"div",24),d(1,"input",41),i(2,"label",42),a(3),r()()),n&2){let e=t.$implicit;l(),h("id","role-"+e.id)("value",e.id),l(),h("for","role-"+e.id),l(),f(e.name)}}function wr(n,t){n&1&&(i(0,"div",18),a(1,"\u8ACB\u9078\u64C7\u89D2\u8272\u3002"),r())}function Dr(n,t){if(n&1&&(i(0,"option",26),a(1),r()),n&2){let e=t.$implicit;h("ngValue",e.id),l(),f(e.name)}}function kr(n,t){if(n&1&&(i(0,"option",26),a(1),r()),n&2){let e=t.$implicit;h("ngValue",e.id),l(),Y("",e.name,"\uFF08L",e.level,"\uFF09")}}function Lr(n,t){if(n&1&&(i(0,"option",35),a(1),r()),n&2){let e=t.$implicit;h("value",e.id),l(),f(e.name)}}var Et=class n{fb=g(ie);userService=g(mt);roleService=g(ze);deptService=g(Ge);jtService=g(Je);route=g(me);router=g(de);roles=[];departments=[];jobTitles=[];allUsers=[];isEdit=!1;userId="";errorMsg=j("");form=this.fb.group({name:["",w.required],email:["",[w.required,w.email]],roleId:["",w.required],status:["active",w.required],departmentId:[null],jobTitleId:[null],hireDate:[""],resignDate:[""],baseSalary:[null],agentUserId:[""]});ngOnInit(){this.roleService.getAll().subscribe(t=>this.roles=t),this.deptService.getAll().subscribe(t=>this.departments=t),this.jtService.getAll().subscribe(t=>this.jobTitles=t),this.userService.getAll().subscribe(t=>this.allUsers=t),this.userId=this.route.snapshot.paramMap.get("id")??"",this.userId&&(this.isEdit=!0,this.userService.getById(this.userId).subscribe(t=>{t&&this.form.patchValue(Ve(ue({},t),{roleId:t.roleIds[0]??"",departmentId:t.departmentId??null,jobTitleId:t.jobTitleId??null,hireDate:t.hireDate?this.toDateString(t.hireDate):"",resignDate:t.resignDate?this.toDateString(t.resignDate):"",baseSalary:t.baseSalary??null,agentUserId:t.agentUserId??""}))}))}getAvailableAgents(){return this.allUsers.filter(t=>t.id!==this.userId)}toDateString(t){return new Date(t).toISOString().substring(0,10)}submit(){if(this.form.invalid)return;let Se=this.form.value,{roleId:t,hireDate:e,resignDate:o,departmentId:s,jobTitleId:v,agentUserId:F}=Se,R=Vt(Se,["roleId","hireDate","resignDate","departmentId","jobTitleId","agentUserId"]),B=s||void 0,z=v||void 0,Oe=B?this.departments.find(ae=>ae.id===B)?.name:void 0,re=z?this.jobTitles.find(ae=>ae.id===z)?.name:void 0,ge=F?this.allUsers.find(ae=>ae.id===F):void 0,qe=Ve(ue({},R),{roleIds:t?[t]:[],departmentId:B,departmentName:Oe,jobTitleId:z,jobTitleName:re,hireDate:e?new Date(e):void 0,resignDate:o?new Date(o):void 0,agentUserId:F||void 0,agentName:ge?.name}),He=this.isEdit?this.userService.update(this.userId,qe):this.userService.create(qe);this.errorMsg.set(""),He.subscribe({next:()=>this.router.navigate(["/admin/users"]),error:ae=>{this.errorMsg.set(ae.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-user-form"]],decls:96,vars:10,consts:[[1,"container-fluid","py-3"],[1,"flex","items-center","gap-2","mb-6"],["routerLink","/admin/users",1,"btn","btn-sm","btn-outline-secondary"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],[1,"row"],[1,"col-12","col-xl-8"],[3,"ngSubmit","formGroup"],[1,"card","border-0","shadow-sm","mb-4"],[1,"card-header","bg-transparent","fw-500"],[1,"card-body"],[1,"row","g-3"],[1,"col-12","col-md-6"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","name","placeholder","\u8ACB\u8F38\u5165\u59D3\u540D",1,"form-control"],[1,"text-danger","small","mt-1"],["type","email","formControlName","email","placeholder","user@example.com",1,"form-control"],["formControlName","status",1,"form-select"],["value","active"],["value","inactive"],[1,"flex","flex-wrap","gap-4","mt-1"],[1,"form-check"],["formControlName","departmentId",1,"form-select"],[3,"ngValue"],["formControlName","jobTitleId",1,"form-select"],["type","date","formControlName","hireDate",1,"form-control"],["type","date","formControlName","resignDate",1,"form-control"],[1,"input-group"],[1,"input-group-text"],["type","number","formControlName","baseSalary","placeholder","\u4F8B\u5982\uFF1A50000","min","0",1,"form-control"],["formControlName","agentUserId",1,"form-select"],["value",""],[3,"value"],[1,"mt-6","flex","gap-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["routerLink","/admin/users",1,"btn","btn-outline-secondary"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#alert-triangle"],["type","radio","name","roleId","formControlName","roleId",1,"form-check-input",3,"id","value"],[1,"form-check-label",3,"for"]],template:function(e,o){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"a",2),u(),i(3,"svg",3),d(4,"use",4),r()(),S(),i(5,"h4",5),a(6),r()(),p(7,yr,4,1,"div",6),i(8,"div",7)(9,"div",8)(10,"form",9),b("ngSubmit",function(){return o.submit()}),i(11,"div",10)(12,"div",11),a(13,"\u57FA\u672C\u8CC7\u6599"),r(),i(14,"div",12)(15,"div",13)(16,"div",14)(17,"label",15),a(18,"\u59D3\u540D "),i(19,"span",16),a(20,"*"),r()(),d(21,"input",17),p(22,Ar,2,0,"div",18),r(),i(23,"div",14)(24,"label",15),a(25,"Email "),i(26,"span",16),a(27,"*"),r()(),d(28,"input",19),p(29,Fr,2,0,"div",18),r(),i(30,"div",14)(31,"label",15),a(32,"\u72C0\u614B"),r(),i(33,"select",20)(34,"option",21),a(35,"\u5728\u8077"),r(),i(36,"option",22),a(37,"\u96E2\u8077"),r()()(),i(38,"div",14)(39,"label",15),a(40,"\u89D2\u8272 "),i(41,"span",16),a(42,"*"),r()(),i(43,"div",23),L(44,Tr,4,4,"div",24,Jt),r(),p(46,wr,2,0,"div",18),r()()()(),i(47,"div",10)(48,"div",11),a(49,"\u54E1\u5DE5\u8CC7\u8A0A"),r(),i(50,"div",12)(51,"div",13)(52,"div",14)(53,"label",15),a(54,"\u90E8\u9580"),r(),i(55,"select",25)(56,"option",26),a(57,"\u2014 \u672A\u6307\u5B9A \u2014"),r(),L(58,Dr,2,2,"option",26,Jt),r()(),i(60,"div",14)(61,"label",15),a(62,"\u8077\u7A31"),r(),i(63,"select",27)(64,"option",26),a(65,"\u2014 \u672A\u6307\u5B9A \u2014"),r(),L(66,kr,2,3,"option",26,Jt),r()(),i(68,"div",14)(69,"label",15),a(70,"\u5165\u8077\u65E5"),r(),d(71,"input",28),r(),i(72,"div",14)(73,"label",15),a(74,"\u96E2\u8077\u65E5"),r(),d(75,"input",29),r(),i(76,"div",14)(77,"label",15),a(78,"\u5E95\u85AA"),r(),i(79,"div",30)(80,"span",31),a(81,"NT$"),r(),d(82,"input",32),r()(),i(83,"div",14)(84,"label",15),a(85,"\u8077\u52D9\u4EE3\u7406\u4EBA"),r(),i(86,"select",33)(87,"option",34),a(88,"\u2014 \u7121\u4EE3\u7406\u4EBA \u2014"),r(),L(89,Lr,2,2,"option",35,Jt),r()()()()(),i(91,"div",36)(92,"button",37),a(93),r(),i(94,"a",38),a(95,"\u53D6\u6D88"),r()()()()()()),e&2){let s,v,F;l(6),f(o.isEdit?"\u7DE8\u8F2F\u54E1\u5DE5":"\u65B0\u589E\u54E1\u5DE5"),l(),c(o.errorMsg()?7:-1),l(3),h("formGroup",o.form),l(12),c((s=o.form.get("name"))!=null&&s.invalid&&((s=o.form.get("name"))!=null&&s.touched)?22:-1),l(7),c((v=o.form.get("email"))!=null&&v.invalid&&((v=o.form.get("email"))!=null&&v.touched)?29:-1),l(15),P(o.roles),l(2),c((F=o.form.get("roleId"))!=null&&F.invalid&&((F=o.form.get("roleId"))!=null&&F.touched)?46:-1),l(10),h("ngValue",null),l(2),P(o.departments),l(6),h("ngValue",null),l(2),P(o.jobTitles),l(23),P(o.getAvailableAgents()),l(3),h("disabled",o.form.invalid),l(),C(" ",o.isEdit?"\u66F4\u65B0":"\u5EFA\u7ACB"," ")}},dependencies:[ne,X,Re,Be,K,xe,Ie,Qe,Z,Q,he,te,ee,q],encapsulation:2})};var Pr=n=>[n,"edit"],Ir=(n,t)=>t.id;function Rr(n,t){if(n&1){let e=D();i(0,"tr")(1,"td",17),a(2),r(),i(3,"td",18),a(4),r(),i(5,"td")(6,"span",19),a(7),r()(),i(8,"td",20),a(9),I(10,"date"),r(),i(11,"td",21)(12,"div",22)(13,"a",23),u(),i(14,"svg",7),d(15,"use",24),r()(),S(),i(16,"button",25),b("click",function(){let s=E(e).$implicit,v=m();return y(v.delete(s))}),u(),i(17,"svg",7),d(18,"use",26),r()()()()()}if(n&2){let e=t.$implicit;l(2),f(e.name),l(2),f(e.description),l(3),C("",e.permissionCodes.length," \u500B\u6B0A\u9650"),l(2),f(O(10,5,e.createdAt,"yyyy-MM-dd")),l(4),h("routerLink",W(8,Pr,e.id))}}function Br(n,t){n&1&&(i(0,"tr")(1,"td",27),a(2,"\u5C1A\u7121\u89D2\u8272\u8CC7\u6599\u3002"),r()())}var Yt=class n{roleService=g(ze);refresh$=new De(void 0);roles$=this.refresh$.pipe(se(()=>this.roleService.getAll()));delete(t){confirm(`Delete role "${t.name}"?`)&&this.roleService.delete(t.id).subscribe(()=>this.refresh$.next())}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-role-list"]],decls:32,vars:3,consts:[[1,"container-fluid","py-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-2","mb-6"],[1,"flex","items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#shield"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","inline-flex","items-center","gap-1"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"hidden","md:table-cell"],[1,"hidden","lg:table-cell"],[1,"text-right"],[1,"fw-500"],[1,"text-muted","hidden","md:table-cell"],[1,"badge","bg-info"],[1,"text-muted","hidden","lg:table-cell"],[1,"text-right",2,"white-space","nowrap"],[1,"flex","justify-end","gap-1"],[1,"btn","btn-sm","btn-ghost-primary","inline-flex","items-center",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],[1,"btn","btn-sm","btn-ghost-danger","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#trash"],["colspan","5",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),u(),i(3,"svg",3),d(4,"use",4),r(),S(),i(5,"h4",5),a(6,"\u89D2\u8272\u7BA1\u7406"),r()(),i(7,"a",6),u(),i(8,"svg",7),d(9,"use",8),r(),a(10," \u65B0\u589E\u89D2\u8272 "),r()(),S(),i(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u540D\u7A31"),r(),i(19,"th",14),a(20,"\u63CF\u8FF0"),r(),i(21,"th"),a(22,"\u6B0A\u9650"),r(),i(23,"th",15),a(24,"\u5EFA\u7ACB\u65E5\u671F"),r(),i(25,"th",16),a(26,"\u64CD\u4F5C"),r()()(),i(27,"tbody"),L(28,Rr,19,10,"tr",null,Ir,!1,Br,3,0,"tr"),I(31,"async"),r()()()()()()),e&2&&(l(28),P(ye(31,1,o.roles$)))},dependencies:[q,Le,be],encapsulation:2})};var Xe=class n{http=g(fe);items$=new De([]);getAll(){return this.http.get(`${T.apiUrl}/permissions`).pipe(Nt(t=>this.items$.next(t)))}getById(t){return this.http.get(`${T.apiUrl}/permissions/${t}`)}getModules(){return[...new Set(this.items$.getValue().map(t=>t.module))]}create(t){return this.http.post(`${T.apiUrl}/permissions`,t)}update(t,e){return this.http.patch(`${T.apiUrl}/permissions/${t}`,e)}delete(t){return this.http.delete(`${T.apiUrl}/permissions/${t}`)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})};var Mr=(n,t)=>t.id;function jr(n,t){if(n&1&&(i(0,"div",6),u(),i(1,"svg",24),d(2,"use",25),r(),a(3),r()),n&2){let e=m();l(3),C(" ",e.errorMsg()," ")}}function Vr(n,t){n&1&&(i(0,"div",16),a(1,"\u8ACB\u8F38\u5165\u89D2\u8272\u540D\u7A31\u3002"),r())}function Nr(n,t){if(n&1){let e=D();i(0,"div",30)(1,"input",27),b("change",function(){let s=E(e).$implicit,v=m(2);return y(v.togglePermission(s.code))}),r(),i(2,"label",31),a(3),r()()}if(n&2){let e=t.$implicit,o=m(2);l(),h("id","perm-"+e.id)("checked",o.isPermissionSelected(e.code)),l(),h("for","perm-"+e.id),l(),f(e.name)}}function Or(n,t){if(n&1){let e=D();i(0,"div",12)(1,"div",26)(2,"input",27),b("change",function(s){let v=E(e).$implicit,F=m();return y(F.toggleModule(v,s.target.checked))}),r(),i(3,"label",28),a(4),r()(),i(5,"div",29),L(6,Nr,4,4,"div",30,Mr),r()()}if(n&2){let e=t.$implicit,o=m();l(2),h("id","module-"+e)("checked",o.isModuleAllSelected(e)),l(),h("for","module-"+e),l(),f(e),l(2),P(o.getPermissionsByModule(e))}}var yt=class n{fb=g(ie);roleService=g(ze);permissionService=g(Xe);route=g(me);router=g(de);permissions=[];modules=[];isEdit=!1;roleId="";errorMsg=j("");form=this.fb.group({name:["",w.required],description:[""],permissionCodes:[[]]});ngOnInit(){this.permissionService.getAll().subscribe(t=>{this.permissions=t,this.modules=[...new Set(t.map(e=>e.module))]}),this.roleId=this.route.snapshot.paramMap.get("id")??"",this.roleId&&(this.isEdit=!0,this.roleService.getById(this.roleId).subscribe(t=>{t&&this.form.patchValue(ue({},t))}))}getPermissionsByModule(t){return this.permissions.filter(e=>e.module===t)}isPermissionSelected(t){return(this.form.value.permissionCodes??[]).includes(t)}togglePermission(t){let e=this.form.value.permissionCodes??[],o=e.includes(t)?e.filter(s=>s!==t):[...e,t];this.form.patchValue({permissionCodes:o})}toggleModule(t,e){let o=this.getPermissionsByModule(t).map(F=>F.code),s=this.form.value.permissionCodes??[],v=e?[...new Set([...s,...o])]:s.filter(F=>!o.includes(F));this.form.patchValue({permissionCodes:v})}isModuleAllSelected(t){return this.getPermissionsByModule(t).map(o=>o.code).every(o=>this.isPermissionSelected(o))}submit(){if(this.form.invalid)return;let t=this.form.value,e=this.isEdit?this.roleService.update(this.roleId,t):this.roleService.create(t);this.errorMsg.set(""),e.subscribe({next:()=>this.router.navigate(["/admin/roles"]),error:o=>{this.errorMsg.set(o.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-role-form"]],decls:37,vars:7,consts:[[1,"container-fluid","py-3"],[1,"flex","items-center","gap-2","mb-6"],["routerLink","/admin/roles",1,"btn","btn-sm","btn-outline-secondary"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-xl-10"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[1,"mb-4"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","name","placeholder","\u4F8B\u5982\uFF1A\u4E3B\u7BA1",1,"form-control"],[1,"text-danger","small","mt-1"],[1,"mb-6"],["type","text","formControlName","description","placeholder","\u7C21\u77ED\u63CF\u8FF0",1,"form-control"],[1,"border","rounded","p-4"],[1,"text-muted","small","mt-1"],[1,"mt-6","flex","gap-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["routerLink","/admin/roles",1,"btn","btn-outline-secondary"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#alert-triangle"],[1,"flex","items-center","gap-2","mb-2"],["type","checkbox",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label","fw-600",3,"for"],[1,"flex","flex-wrap","gap-4","ms-4"],[1,"form-check"],[1,"form-check-label","small",3,"for"]],template:function(e,o){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"a",2),u(),i(3,"svg",3),d(4,"use",4),r()(),S(),i(5,"h4",5),a(6),r()(),p(7,jr,4,1,"div",6),i(8,"form",7),b("ngSubmit",function(){return o.submit()}),i(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12)(14,"label",13),a(15,"\u89D2\u8272\u540D\u7A31 "),i(16,"span",14),a(17,"*"),r()(),d(18,"input",15),p(19,Vr,2,0,"div",16),r(),i(20,"div",17)(21,"label",13),a(22,"\u63CF\u8FF0"),r(),d(23,"input",18),r(),i(24,"div",5)(25,"label",13),a(26,"\u6B0A\u9650"),r(),i(27,"div",19),L(28,Or,8,4,"div",12,_e),r(),i(30,"div",20),a(31),r()()()(),i(32,"div",21)(33,"button",22),a(34),r(),i(35,"a",23),a(36,"\u53D6\u6D88"),r()()()()()()),e&2){let s;l(6),f(o.isEdit?"\u7DE8\u8F2F\u89D2\u8272":"\u65B0\u589E\u89D2\u8272"),l(),c(o.errorMsg()?7:-1),l(),h("formGroup",o.form),l(11),c((s=o.form.get("name"))!=null&&s.invalid&&((s=o.form.get("name"))!=null&&s.touched)?19:-1),l(9),P(o.modules),l(3),C(" \u5DF2\u9078\u53D6 ",(o.form.value.permissionCodes==null?null:o.form.value.permissionCodes.length)??0," \u500B\u6B0A\u9650 "),l(2),h("disabled",o.form.invalid),l(),C(" ",o.isEdit?"\u66F4\u65B0":"\u5EFA\u7ACB"," ")}},dependencies:[ne,X,K,Z,Q,te,ee,q],encapsulation:2})};var qr=()=>[],$r=n=>[n,"edit"],Gr=(n,t)=>t.id;function Ur(n,t){if(n&1){let e=D();i(0,"tr")(1,"td",18)(2,"code",22),a(3),r()(),i(4,"td",23),a(5),r(),i(6,"td",24),a(7),r(),i(8,"td",25)(9,"div",26)(10,"a",27),u(),i(11,"svg",7),d(12,"use",28),r()(),S(),i(13,"button",29),b("click",function(){let s=E(e).$implicit,v=m(3);return y(v.delete(s))}),u(),i(14,"svg",7),d(15,"use",30),r()()()()()}if(n&2){let e=t.$implicit;l(3),f(e.code),l(2),f(e.name),l(2),f(e.description??"\u2014"),l(3),h("routerLink",W(4,$r,e.id))}}function Hr(n,t){if(n&1&&(i(0,"div",9)(1,"div",11),u(),i(2,"svg",12),d(3,"use",13),r(),a(4),r(),S(),i(5,"div",14)(6,"div",15)(7,"table",16)(8,"thead",17)(9,"tr")(10,"th",18),a(11,"\u4EE3\u78BC"),r(),i(12,"th",19),a(13,"\u540D\u7A31"),r(),i(14,"th",20),a(15,"\u63CF\u8FF0"),r(),i(16,"th",21),a(17,"\u64CD\u4F5C"),r()()(),i(18,"tbody"),L(19,Ur,16,6,"tr",null,Gr),r()()()()()),n&2){let e=t.$implicit,o=m(),s=m();l(4),C(" ",e," "),l(15),P(s.getByModule(o,e))}}function zr(n,t){n&1&&(i(0,"div",10),a(1,"\u5C1A\u7121\u6B0A\u9650\u8CC7\u6599\u3002"),r())}function Jr(n,t){if(n&1&&(L(0,Hr,21,1,"div",9,_e,!1,zr,2,0,"div",10),I(3,"async")),n&2){let e=m();P(ye(3,1,e.modules$)??Zi(3,qr))}}var Wt=class n{permissionService=g(Xe);refresh$=new De(void 0);all$=this.refresh$.pipe(se(()=>this.permissionService.getAll()),Gi(1));permissions$=this.all$;modules$=this.all$.pipe(qi(t=>[...new Set(t.map(e=>e.module))]));getByModule(t,e){return t.filter(o=>o.module===e)}delete(t){confirm(`Delete permission "${t.name}"?`)&&this.permissionService.delete(t.id).subscribe(()=>this.refresh$.next())}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-permission-list"]],decls:13,vars:3,consts:[[1,"container-fluid","py-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-2","mb-6"],[1,"flex","items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#lock"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","inline-flex","items-center","gap-1"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm","mb-4"],[1,"text-center","text-muted","py-8"],[1,"card-header","bg-[--bg-base]","fw-600","flex","items-center"],[1,"sa-icon","mr-2","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#folder"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0",2,"table-layout","fixed"],[1,"table-light"],[1,"w-[30%]"],[1,"w-[25%]"],[1,"w-[35%]","hidden","md:table-cell"],[1,"w-[10%]","text-right"],[1,"text-primary"],[1,"w-[25%]","fw-500"],[1,"w-[35%]","text-muted","hidden","md:table-cell"],[1,"w-[10%]","text-right","whitespace-nowrap"],[1,"flex","justify-end","gap-1"],[1,"btn","btn-sm","btn-ghost-primary","inline-flex","items-center",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],[1,"btn","btn-sm","btn-ghost-danger","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#trash"]],template:function(e,o){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),u(),i(3,"svg",3),d(4,"use",4),r(),S(),i(5,"h4",5),a(6,"\u6B0A\u9650\u7BA1\u7406"),r()(),i(7,"a",6),u(),i(8,"svg",7),d(9,"use",8),r(),a(10," \u65B0\u589E\u6B0A\u9650 "),r()(),p(11,Jr,4,4),I(12,"async"),r()),e&2){let s;l(11),c((s=ye(12,1,o.permissions$))?11:-1,s)}},dependencies:[q,Le],encapsulation:2})};function Yr(n,t){if(n&1&&(i(0,"div",6),u(),i(1,"svg",23),d(2,"use",24),r(),a(3),r()),n&2){let e=m();l(3),C(" ",e.errorMsg()," ")}}var At=class n{fb=g(ie);service=g(Xe);route=g(me);router=g(de);isEdit=!1;permId="";errorMsg=j("");form=this.fb.group({code:["",w.required],name:["",w.required],module:["",w.required],description:[""]});ngOnInit(){this.permId=this.route.snapshot.paramMap.get("id")??"",this.permId&&(this.isEdit=!0,this.service.getById(this.permId).subscribe(t=>{t&&this.form.patchValue(ue({},t))}))}submit(){if(this.form.invalid)return;let t=this.form.value,e=this.isEdit?this.service.update(this.permId,t):this.service.create(t);this.errorMsg.set(""),e.subscribe({next:()=>this.router.navigate(["/admin/permissions"]),error:o=>{this.errorMsg.set(o.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-permission-form"]],decls:47,vars:5,consts:[[1,"container-fluid","py-3"],[1,"flex","items-center","gap-2","mb-6"],["routerLink","/admin/permissions",1,"btn","btn-sm","btn-outline-secondary"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-lg-8","col-xl-6"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[1,"mb-4"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","code","placeholder","module:action",1,"form-control","font-monospace"],[1,"text-muted","small","mt-1"],["type","text","formControlName","name","placeholder","\u986F\u793A\u540D\u7A31",1,"form-control"],["type","text","formControlName","module","placeholder","\u4F8B\u5982\uFF1AUsers\u3001Roles",1,"form-control"],["type","text","formControlName","description","placeholder","\u9078\u586B\u8AAA\u660E",1,"form-control"],[1,"mt-6","flex","gap-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["routerLink","/admin/permissions",1,"btn","btn-outline-secondary"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#alert-triangle"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"a",2),u(),i(3,"svg",3),d(4,"use",4),r()(),S(),i(5,"h4",5),a(6),r()(),p(7,Yr,4,1,"div",6),i(8,"form",7),b("ngSubmit",function(){return o.submit()}),i(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12)(14,"label",13),a(15,"\u4EE3\u78BC "),i(16,"span",14),a(17,"*"),r()(),d(18,"input",15),i(19,"div",16),a(20,"\u4F8B\u5982\uFF1A"),i(21,"code"),a(22,"users:read"),r(),a(23,"\u3001"),i(24,"code"),a(25,"roles:write"),r()()(),i(26,"div",12)(27,"label",13),a(28,"\u540D\u7A31 "),i(29,"span",14),a(30,"*"),r()(),d(31,"input",17),r(),i(32,"div",12)(33,"label",13),a(34,"\u6A21\u7D44 "),i(35,"span",14),a(36,"*"),r()(),d(37,"input",18),r(),i(38,"div",5)(39,"label",13),a(40,"\u63CF\u8FF0"),r(),d(41,"input",19),r()()(),i(42,"div",20)(43,"button",21),a(44),r(),i(45,"a",22),a(46,"\u53D6\u6D88"),r()()()()()()),e&2&&(l(6),f(o.isEdit?"\u7DE8\u8F2F\u6B0A\u9650":"\u65B0\u589E\u6B0A\u9650"),l(),c(o.errorMsg()?7:-1),l(),h("formGroup",o.form),l(35),h("disabled",o.form.invalid),l(),C(" ",o.isEdit?"\u66F4\u65B0":"\u5EFA\u7ACB"," "))},dependencies:[ne,X,K,Z,Q,te,ee,q],encapsulation:2})};var Kt=class n{http=g(fe);get(){return this.http.get(`${T.apiUrl}/settings`)}save(t){return this.http.patch(`${T.apiUrl}/settings`,t)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})};function Wr(n,t){if(n&1&&(i(0,"div",5),u(),i(1,"svg",25),d(2,"use",27),r(),a(3),r()),n&2){let e=m();l(3),C(" ",e.errorMsg()," ")}}function Kr(n,t){n&1&&(i(0,"div",6),u(),i(1,"svg",25),d(2,"use",28),r(),a(3," \u8A2D\u5B9A\u5DF2\u5132\u5B58\u6210\u529F\u3002 "),r())}function Zr(n,t){n&1&&(i(0,"div",22),a(1,"\u8ACB\u8F38\u5165 0 \u5230 200 \u4E4B\u9593\u7684\u6578\u503C\u3002"),r())}var Zt=class n{fb=g(ie);settingsService=g(Kt);saved=!1;errorMsg=j("");form=this.fb.group({workStartTime:["09:00",w.required],workEndTime:["18:00",w.required],monthlyOvertimeLimit:[46,[w.required,w.min(0),w.max(200)]]});ngOnInit(){this.settingsService.get().subscribe(t=>this.form.patchValue(t))}submit(){this.form.invalid||(this.errorMsg.set(""),this.settingsService.save(this.form.value).subscribe({next:()=>{this.saved=!0,setTimeout(()=>this.saved=!1,3e3)},error:t=>{this.errorMsg.set(t.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}}))}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-settings"]],decls:41,vars:5,consts:[[1,"container-fluid","py-3"],[1,"flex","items-center","gap-2","mb-6"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#settings"],[1,"mb-0"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],["role","alert",1,"alert","alert-success","flex","items-center","gap-2","mb-6","py-2"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-md-6","col-xl-4"],[1,"card","border-0","shadow-sm"],[1,"card-header","bg-transparent","border-bottom","flex","items-center","gap-2","fw-600"],[1,"sa-icon","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#clock"],[1,"card-body"],[1,"mb-4"],[1,"form-label","fw-500"],[1,"text-danger"],["type","time","formControlName","workStartTime",1,"form-control"],["type","time","formControlName","workEndTime",1,"form-control"],[1,"text-muted","font-normal"],["type","number","formControlName","monthlyOvertimeLimit","min","0","max","200",1,"form-control"],[1,"text-danger","small","mt-1"],[1,"mt-6","flex","gap-2"],["type","submit",1,"btn","btn-primary","inline-flex","items-center","gap-1",3,"disabled"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#save"],["href","/assets/icons/sprite.svg#alert-triangle"],["href","/assets/icons/sprite.svg#check-circle"]],template:function(e,o){if(e&1&&(i(0,"div",0)(1,"div",1),u(),i(2,"svg",2),d(3,"use",3),r(),S(),i(4,"h4",4),a(5,"\u7CFB\u7D71\u8A2D\u5B9A"),r()(),p(6,Wr,4,1,"div",5),p(7,Kr,4,0,"div",6),i(8,"form",7),b("ngSubmit",function(){return o.submit()}),i(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11),u(),i(13,"svg",12),d(14,"use",13),r(),a(15," \u5DE5\u4F5C\u6642\u9593 "),r(),S(),i(16,"div",14)(17,"div",15)(18,"label",16),a(19,"\u4E0A\u73ED\u6642\u9593 "),i(20,"span",17),a(21,"*"),r()(),d(22,"input",18),r(),i(23,"div",15)(24,"label",16),a(25,"\u4E0B\u73ED\u6642\u9593 "),i(26,"span",17),a(27,"*"),r()(),d(28,"input",19),r(),i(29,"div",4)(30,"label",16),a(31,"\u6BCF\u6708\u52A0\u73ED\u6642\u6578\u9650\u5236 "),i(32,"span",20),a(33,"\uFF08\u5C0F\u6642\uFF09"),r()(),d(34,"input",21),p(35,Zr,2,0,"div",22),r()()()()(),i(36,"div",23)(37,"button",24),u(),i(38,"svg",25),d(39,"use",26),r(),a(40," \u5132\u5B58\u8A2D\u5B9A "),r()()()()),e&2){let s;l(6),c(o.errorMsg()?6:-1),l(),c(o.saved?7:-1),l(),h("formGroup",o.form),l(27),c((s=o.form.get("monthlyOvertimeLimit"))!=null&&s.invalid&&((s=o.form.get("monthlyOvertimeLimit"))!=null&&s.touched)?35:-1),l(2),h("disabled",o.form.invalid)}},dependencies:[ne,X,K,xe,Z,Q,he,ln,te,ee],encapsulation:2})};var Qr=n=>[n,"edit"],Xr=(n,t)=>t.id;function ea(n,t){n&1&&(i(0,"span",18),a(1,"\u2514"),r())}function ta(n,t){if(n&1){let e=D();i(0,"tr")(1,"td",17),p(2,ea,2,0,"span",18),a(3),r(),i(4,"td",19)(5,"code"),a(6),r()(),i(7,"td",20),a(8),r(),i(9,"td",20),a(10),r(),i(11,"td")(12,"span",21),a(13),r()(),i(14,"td",22)(15,"div",23)(16,"a",24),u(),i(17,"svg",7),d(18,"use",25),r()(),S(),i(19,"button",26),b("click",function(){let s=E(e).$implicit,v=m();return y(v.delete(s))}),u(),i(20,"svg",7),d(21,"use",27),r()()()()()}if(n&2){let e=t.$implicit;l(2),c(e.parentId?2:-1),l(),C(" ",e.name," "),l(3),f(e.code??"\u2014"),l(2),f(e.parentName??"\u2014"),l(2),f(e.description??"\u2014"),l(3),C("",e.employeeCount," \u4EBA"),l(3),h("routerLink",W(7,Qr,e.id))}}function ia(n,t){n&1&&(i(0,"tr")(1,"td",28),a(2,"\u5C1A\u7121\u90E8\u9580\u8CC7\u6599\u3002"),r()())}var Qt=class n{deptService=g(Ge);refresh$=new De(void 0);departments$=this.refresh$.pipe(se(()=>this.deptService.getAll()));delete(t){confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u90E8\u9580\u300C${t.name}\u300D\u55CE\uFF1F`)&&this.deptService.delete(t.id).subscribe(()=>this.refresh$.next())}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-department-list"]],decls:34,vars:3,consts:[[1,"container-fluid","py-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-2","mb-6"],[1,"flex","items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#git-branch"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","inline-flex","items-center","gap-1"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"hidden","sm:table-cell"],[1,"hidden","md:table-cell"],[1,"text-right"],[1,"fw-500"],[1,"text-muted","me-1"],[1,"text-muted","hidden","sm:table-cell"],[1,"text-muted","hidden","md:table-cell"],[1,"badge","bg-info"],[1,"text-right",2,"white-space","nowrap"],[1,"flex","justify-end","gap-1"],[1,"btn","btn-sm","btn-ghost-primary","inline-flex","items-center",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],[1,"btn","btn-sm","btn-ghost-danger","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#trash"],["colspan","6",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),u(),i(3,"svg",3),d(4,"use",4),r(),S(),i(5,"h4",5),a(6,"\u90E8\u9580\u7BA1\u7406"),r()(),i(7,"a",6),u(),i(8,"svg",7),d(9,"use",8),r(),a(10," \u65B0\u589E\u90E8\u9580 "),r()(),S(),i(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u90E8\u9580\u540D\u7A31"),r(),i(19,"th",14),a(20,"\u4EE3\u78BC"),r(),i(21,"th",15),a(22,"\u6BCD\u90E8\u9580"),r(),i(23,"th",15),a(24,"\u63CF\u8FF0"),r(),i(25,"th"),a(26,"\u4EBA\u6578"),r(),i(27,"th",16),a(28,"\u64CD\u4F5C"),r()()(),i(29,"tbody"),L(30,ta,22,9,"tr",null,Xr,!1,ia,3,0,"tr"),I(33,"async"),r()()()()()()),e&2&&(l(30),P(ye(33,1,o.departments$)))},dependencies:[q,Le],encapsulation:2})};var na=(n,t)=>t.id;function ra(n,t){if(n&1&&(i(0,"div",6),u(),i(1,"svg",26),d(2,"use",27),r(),a(3),r()),n&2){let e=m();l(3),C(" ",e.errorMsg()," ")}}function aa(n,t){n&1&&(i(0,"div",16),a(1,"\u8ACB\u8F38\u5165\u90E8\u9580\u540D\u7A31\u3002"),r())}function oa(n,t){if(n&1&&(i(0,"option",19),a(1),r()),n&2){let e=t.$implicit;h("ngValue",e.id),l(),f(e.name)}}var Ft=class n{fb=g(ie);deptService=g(Ge);route=g(me);router=g(de);departments=[];isEdit=!1;deptId=0;errorMsg=j("");form=this.fb.group({name:["",w.required],code:[""],description:[""],parentId:[null],sortOrder:[0]});ngOnInit(){this.deptService.getAll().subscribe(e=>this.departments=e);let t=this.route.snapshot.paramMap.get("id");t&&(this.isEdit=!0,this.deptId=+t,this.deptService.getById(this.deptId).subscribe(e=>{e&&this.form.patchValue(Ve(ue({},e),{parentId:e.parentId??null}))}))}getAvailableParents(){return this.departments.filter(t=>t.id!==this.deptId)}submit(){if(this.form.invalid)return;let t=this.form.value,e=this.isEdit?this.deptService.update(this.deptId,t):this.deptService.create(t);this.errorMsg.set(""),e.subscribe({next:()=>this.router.navigate(["/admin/departments"]),error:o=>{this.errorMsg.set(o.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-department-form"]],decls:47,vars:7,consts:[[1,"container-fluid","py-3"],[1,"flex","items-center","gap-2","mb-6"],["routerLink","/admin/departments",1,"btn","btn-sm","btn-outline-secondary"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-lg-8","col-xl-6"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[1,"mb-4"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","name","placeholder","\u4F8B\u5982\uFF1A\u7814\u767C\u90E8",1,"form-control"],[1,"text-danger","small","mt-1"],["type","text","formControlName","code","placeholder","\u4F8B\u5982\uFF1ARD",1,"form-control","font-monospace"],["formControlName","parentId",1,"form-select"],[3,"ngValue"],["type","number","formControlName","sortOrder","min","0",1,"form-control"],[1,"text-muted","small","mt-1"],["formControlName","description","rows","2","placeholder","\u9078\u586B\u8AAA\u660E",1,"form-control"],[1,"mt-6","flex","gap-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["routerLink","/admin/departments",1,"btn","btn-outline-secondary"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#alert-triangle"]],template:function(e,o){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"a",2),u(),i(3,"svg",3),d(4,"use",4),r()(),S(),i(5,"h4",5),a(6),r()(),p(7,ra,4,1,"div",6),i(8,"form",7),b("ngSubmit",function(){return o.submit()}),i(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12)(14,"label",13),a(15,"\u90E8\u9580\u540D\u7A31 "),i(16,"span",14),a(17,"*"),r()(),d(18,"input",15),p(19,aa,2,0,"div",16),r(),i(20,"div",12)(21,"label",13),a(22,"\u90E8\u9580\u4EE3\u78BC"),r(),d(23,"input",17),r(),i(24,"div",12)(25,"label",13),a(26,"\u4E0A\u5C64\u90E8\u9580"),r(),i(27,"select",18)(28,"option",19),a(29,"\u2014 \u7121\uFF08\u9802\u5C64\u90E8\u9580\uFF09\u2014"),r(),L(30,oa,2,2,"option",19,na),r()(),i(32,"div",12)(33,"label",13),a(34,"\u6392\u5E8F\u865F"),r(),d(35,"input",20),i(36,"div",21),a(37,"\u6578\u5B57\u8D8A\u5C0F\u6392\u8D8A\u524D\u9762\u3002"),r()(),i(38,"div",5)(39,"label",13),a(40,"\u63CF\u8FF0"),r(),d(41,"textarea",22),r()()(),i(42,"div",23)(43,"button",24),a(44),r(),i(45,"a",25),a(46,"\u53D6\u6D88"),r()()()()()()),e&2){let s;l(6),f(o.isEdit?"\u7DE8\u8F2F\u90E8\u9580":"\u65B0\u589E\u90E8\u9580"),l(),c(o.errorMsg()?7:-1),l(),h("formGroup",o.form),l(11),c((s=o.form.get("name"))!=null&&s.invalid&&((s=o.form.get("name"))!=null&&s.touched)?19:-1),l(9),h("ngValue",null),l(2),P(o.getAvailableParents()),l(13),h("disabled",o.form.invalid),l(),C(" ",o.isEdit?"\u66F4\u65B0":"\u5EFA\u7ACB"," ")}},dependencies:[ne,X,Re,Be,K,xe,Ie,Z,Q,he,te,ee,q],encapsulation:2})};var la=n=>[n,"edit"],sa=(n,t)=>t.id;function ma(n,t){if(n&1){let e=D();i(0,"tr")(1,"td",17),a(2),r(),i(3,"td")(4,"span",18),a(5),r()(),i(6,"td",19),a(7),r(),i(8,"td"),a(9),r(),i(10,"td",20),a(11),I(12,"date"),r(),i(13,"td",21)(14,"div",22)(15,"a",23),u(),i(16,"svg",7),d(17,"use",24),r()(),S(),i(18,"button",25),b("click",function(){let s=E(e).$implicit,v=m();return y(v.delete(s))}),u(),i(19,"svg",7),d(20,"use",26),r()()()()()}if(n&2){let e=t.$implicit;l(2),f(e.name),l(3),C("L",e.level),l(2),f(e.description||"\u2014"),l(2),f(e.employeeCount),l(2),f(O(12,6,e.createdAt,"yyyy-MM-dd")),l(4),h("routerLink",W(9,la,e.id))}}function da(n,t){n&1&&(i(0,"tr")(1,"td",27),a(2,"\u5C1A\u7121\u8077\u7A31\u8CC7\u6599\u3002"),r()())}var Xt=class n{jobTitleService=g(Je);refresh$=new De(void 0);jobTitles$=this.refresh$.pipe(se(()=>this.jobTitleService.getAll()));delete(t){confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u8077\u7A31\u300C${t.name}\u300D\u55CE\uFF1F`)&&this.jobTitleService.delete(t.id).subscribe(()=>this.refresh$.next())}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-job-title-list"]],decls:34,vars:3,consts:[[1,"container-fluid","py-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-2","mb-6"],[1,"flex","items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#briefcase"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","inline-flex","items-center","gap-1"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"hidden","md:table-cell"],[1,"hidden","lg:table-cell"],[1,"text-right"],[1,"fw-500"],[1,"badge","bg-secondary-subtle","text-secondary"],[1,"text-muted","hidden","md:table-cell"],[1,"text-muted","small","hidden","lg:table-cell"],[1,"text-right",2,"white-space","nowrap"],[1,"flex","justify-end","gap-1"],[1,"btn","btn-sm","btn-ghost-primary","inline-flex","items-center",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],[1,"btn","btn-sm","btn-ghost-danger","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#trash"],["colspan","6",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),u(),i(3,"svg",3),d(4,"use",4),r(),S(),i(5,"h4",5),a(6,"\u8077\u7A31\u7BA1\u7406"),r()(),i(7,"a",6),u(),i(8,"svg",7),d(9,"use",8),r(),a(10," \u65B0\u589E\u8077\u7A31 "),r()(),S(),i(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u8077\u7A31\u540D\u7A31"),r(),i(19,"th"),a(20,"\u7B49\u7D1A"),r(),i(21,"th",14),a(22,"\u63CF\u8FF0"),r(),i(23,"th"),a(24,"\u54E1\u5DE5\u4EBA\u6578"),r(),i(25,"th",15),a(26,"\u5EFA\u7ACB\u6642\u9593"),r(),i(27,"th",16),a(28,"\u64CD\u4F5C"),r()()(),i(29,"tbody"),L(30,ma,21,11,"tr",null,sa,!1,da,3,0,"tr"),I(33,"async"),r()()()()()()),e&2&&(l(30),P(ye(33,1,o.jobTitles$)))},dependencies:[q,Le,be],encapsulation:2})};function ua(n,t){if(n&1&&(i(0,"div",6),u(),i(1,"svg",23),d(2,"use",24),r(),a(3),r()),n&2){let e=m();l(3),C(" ",e.errorMsg()," ")}}function pa(n,t){n&1&&(i(0,"div",16),a(1,"\u8ACB\u8F38\u5165\u8077\u7A31\u540D\u7A31\u3002"),r())}function ca(n,t){n&1&&(i(0,"div",16),a(1,"\u8ACB\u8F38\u5165\u6709\u6548\u7B49\u7D1A\uFF08\u6700\u5C0F\u503C\u70BA 1\uFF09\u3002"),r())}var Tt=class n{fb=g(ie);jobTitleService=g(Je);route=g(me);router=g(de);isEdit=!1;jobTitleId=0;errorMsg=j("");form=this.fb.group({name:["",w.required],level:[1,[w.required,w.min(1)]],description:[""]});ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t&&(this.isEdit=!0,this.jobTitleId=+t,this.jobTitleService.getById(this.jobTitleId).subscribe(e=>{e&&this.form.patchValue(e)}))}submit(){if(this.form.invalid)return;let t=this.form.value,e=this.isEdit?this.jobTitleService.update(this.jobTitleId,t):this.jobTitleService.create(t);this.errorMsg.set(""),e.subscribe({next:()=>this.router.navigate(["/admin/job-titles"]),error:o=>{this.errorMsg.set(o.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-job-title-form"]],decls:38,vars:7,consts:[[1,"container-fluid","py-3"],[1,"flex","items-center","gap-2","mb-6"],["routerLink","/admin/job-titles",1,"btn","btn-sm","btn-outline-secondary"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-lg-6","col-xl-4"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[1,"mb-4"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","name","placeholder","\u4F8B\u5982\uFF1A\u8CC7\u6DF1\u5DE5\u7A0B\u5E2B",1,"form-control"],[1,"text-danger","small","mt-1"],["type","number","formControlName","level","min","1","placeholder","\u4F8B\u5982\uFF1A2",1,"form-control"],[1,"text-muted","small","mt-1"],["formControlName","description","rows","2","placeholder","\u9078\u586B\u8AAA\u660E",1,"form-control"],[1,"mt-6","flex","gap-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["routerLink","/admin/job-titles",1,"btn","btn-outline-secondary"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#alert-triangle"]],template:function(e,o){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"a",2),u(),i(3,"svg",3),d(4,"use",4),r()(),S(),i(5,"h4",5),a(6),r()(),p(7,ua,4,1,"div",6),i(8,"form",7),b("ngSubmit",function(){return o.submit()}),i(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12)(14,"label",13),a(15,"\u8077\u7A31\u540D\u7A31 "),i(16,"span",14),a(17,"*"),r()(),d(18,"input",15),p(19,pa,2,0,"div",16),r(),i(20,"div",12)(21,"label",13),a(22,"\u7B49\u7D1A "),i(23,"span",14),a(24,"*"),r()(),d(25,"input",17),i(26,"div",18),a(27,"\u6578\u5B57\u8D8A\u5927\u7B49\u7D1A\u8D8A\u9AD8\u3002"),r(),p(28,ca,2,0,"div",16),r(),i(29,"div",5)(30,"label",13),a(31,"\u63CF\u8FF0"),r(),d(32,"textarea",19),r()()(),i(33,"div",20)(34,"button",21),a(35),r(),i(36,"a",22),a(37,"\u53D6\u6D88"),r()()()()()()),e&2){let s,v;l(6),f(o.isEdit?"\u7DE8\u8F2F\u8077\u7A31":"\u65B0\u589E\u8077\u7A31"),l(),c(o.errorMsg()?7:-1),l(),h("formGroup",o.form),l(11),c((s=o.form.get("name"))!=null&&s.invalid&&((s=o.form.get("name"))!=null&&s.touched)?19:-1),l(9),c((v=o.form.get("level"))!=null&&v.invalid&&((v=o.form.get("level"))!=null&&v.touched)?28:-1),l(6),h("disabled",o.form.invalid),l(),C(" ",o.isEdit?"\u66F4\u65B0":"\u5EFA\u7ACB"," ")}},dependencies:[ne,X,K,xe,Z,Q,he,te,ee,q],encapsulation:2})};var dt=class n{http=g(fe);getAll(){return this.http.get(`${T.apiUrl}/approval-items`)}getById(t){return this.http.get(`${T.apiUrl}/approval-items/${t}`)}create(t){return this.http.post(`${T.apiUrl}/approval-items`,t)}update(t,e){return this.http.patch(`${T.apiUrl}/approval-items/${t}`,e)}delete(t){return this.http.delete(`${T.apiUrl}/approval-items/${t}`)}addStep(t,e){return this.http.post(`${T.apiUrl}/approval-items/${t}/steps`,e)}updateStep(t,e,o){return this.http.patch(`${T.apiUrl}/approval-items/${t}/steps/${e}`,o)}deleteStep(t,e){return this.http.delete(`${T.apiUrl}/approval-items/${t}/steps/${e}`)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})};var it={payment_request:"\u8ACB\u6B3E\u7533\u8ACB",leave:"\u8ACB\u5047\u7533\u8ACB",travel:"\u51FA\u5DEE\u7533\u8ACB",overtime:"\u52A0\u73ED\u7533\u8ACB"},nt={payment_request:"bg-info-subtle text-info",leave:"bg-success-subtle text-success",travel:"bg-primary-subtle text-primary",overtime:"bg-warning-subtle text-warning-emphasis"};var va=n=>[n,"flow"],fa=(n,t)=>t.id,ga=(n,t)=>t.value;function _a(n,t){if(n&1&&(i(0,"div",9),u(),i(1,"svg",7),d(2,"use",20),r(),a(3),r()),n&2){let e=m();l(3),C(" ",e.errorMsg()," ")}}function ba(n,t){n&1&&(i(0,"div",32),a(1,"\u8ACB\u8F38\u5165\u9805\u76EE\u540D\u7A31\u3002"),r())}function xa(n,t){n&1&&(i(0,"div",32),a(1,"\u8ACB\u8F38\u5165\u4EE3\u78BC\u3002"),r())}function ha(n,t){if(n&1&&(i(0,"option",37),a(1),r()),n&2){let e=t.$implicit,o=m(),s=m(2);h("value",e.value)("disabled",s.isTypeDisabled(e.value,o)),l(),Y(" ",e.label,"",s.isTypeDisabled(e.value,o)?"\uFF08\u5DF2\u8A2D\u5B9A\uFF09":""," ")}}function Sa(n,t){if(n&1&&(i(0,"div",24)(1,"div",28)(2,"label",29),a(3,"\u9805\u76EE\u540D\u7A31 "),i(4,"span",30),a(5,"*"),r()(),d(6,"input",31),p(7,ba,2,0,"div",32),r(),i(8,"div",33)(9,"label",29),a(10,"\u4EE3\u78BC "),i(11,"span",30),a(12,"*"),r()(),d(13,"input",34),p(14,xa,2,0,"div",32),r(),i(15,"div",28)(16,"label",29),a(17,"\u63CF\u8FF0"),r(),d(18,"input",35),r(),i(19,"div",28)(20,"label",29),a(21,"\u9069\u7528\u985E\u578B"),r(),i(22,"select",36),L(23,ha,2,4,"option",37,ga),r()(),i(25,"div",38)(26,"div",39),d(27,"input",40),i(28,"label",41),a(29,"\u555F\u7528"),r()()()()),n&2){let e,o,s=m(2);l(7),c((e=s.form.get("name"))!=null&&e.invalid&&((e=s.form.get("name"))!=null&&e.touched)?7:-1),l(7),c((o=s.form.get("code"))!=null&&o.invalid&&((o=s.form.get("code"))!=null&&o.touched)?14:-1),l(9),P(s.appTypeOptions)}}function Ca(n,t){if(n&1){let e=D();i(0,"div",10)(1,"div",21),a(2),r(),i(3,"div",22)(4,"form",23),b("ngSubmit",function(){E(e);let s=m();return y(s.submit())}),p(5,Sa,30,2,"div",24),I(6,"async"),i(7,"div",25)(8,"button",26),a(9),r(),i(10,"button",27),b("click",function(){E(e);let s=m();return y(s.closeForm())}),a(11,"\u53D6\u6D88"),r()()()()()}if(n&2){let e,o=m();l(2),C(" ",o.editItem?"\u7DE8\u8F2F\u7C3D\u6838\u9805\u76EE":"\u65B0\u589E\u7C3D\u6838\u9805\u76EE"," "),l(2),h("formGroup",o.form),l(),c((e=ye(6,5,o.items$))?5:-1,e),l(3),h("disabled",o.form.invalid),l(),C(" ",o.editItem?"\u66F4\u65B0":"\u5EFA\u7ACB"," ")}}function Ea(n,t){if(n&1&&(i(0,"span"),a(1),r()),n&2){let e=m().$implicit,o=m();J("badge "+o.appTypeClasses[e.applicationType]),l(),C(" ",o.appTypeLabels[e.applicationType]," ")}}function ya(n,t){n&1&&(i(0,"span",43),a(1,"\u901A\u7528"),r())}function Aa(n,t){if(n&1){let e=D();i(0,"tr")(1,"td",42),a(2),r(),i(3,"td")(4,"code",43),a(5),r()(),i(6,"td",16),p(7,Ea,2,3,"span",44)(8,ya,2,0,"span",43),r(),i(9,"td",45),a(10),r(),i(11,"td")(12,"span",46),a(13),r()(),i(14,"td")(15,"span"),a(16),r()(),i(17,"td",47),a(18),I(19,"date"),r(),i(20,"td",48)(21,"div",49)(22,"a",50),u(),i(23,"svg",7),d(24,"use",51),r()(),S(),i(25,"button",52),b("click",function(){let s=E(e).$implicit,v=m();return y(v.openEdit(s))}),u(),i(26,"svg",7),d(27,"use",53),r()(),S(),i(28,"button",54),b("click",function(){let s=E(e).$implicit,v=m();return y(v.delete(s))}),u(),i(29,"svg",7),d(30,"use",55),r()()()()()}if(n&2){let e=t.$implicit;l(2),f(e.name),l(3),f(e.code),l(2),c(e.applicationType?7:8),l(3),f(e.description||"\u2014"),l(3),C("",e.steps.length," \u6B65"),l(2),J("badge "+(e.isActive?"bg-success-subtle text-success":"bg-secondary-subtle text-secondary")),l(),C(" ",e.isActive?"\u555F\u7528":"\u505C\u7528"," "),l(2),f(O(19,10,e.createdAt,"yyyy-MM-dd")),l(4),h("routerLink",W(13,va,e.id))}}function Fa(n,t){n&1&&(i(0,"tr")(1,"td",56),a(2,"\u5C1A\u7121\u7C3D\u6838\u9805\u76EE\u3002"),r()())}var ei=class n{approvalService=g(dt);fb=g(ie);refresh$=new De(void 0);items$=this.refresh$.pipe(se(()=>this.approvalService.getAll()));showForm=!1;editItem=null;errorMsg=j("");appTypeLabels=it;appTypeClasses=nt;appTypeOptions=[{value:"",label:"\u901A\u7528\uFF08\u4E0D\u7D81\u5B9A\uFF09"},{value:"payment_request",label:"\u8ACB\u6B3E\u7533\u8ACB"},{value:"leave",label:"\u8ACB\u5047\u7533\u8ACB"},{value:"travel",label:"\u51FA\u5DEE\u7533\u8ACB"}];form=this.fb.group({name:["",w.required],code:["",w.required],description:[""],isActive:[!0],applicationType:[""]});openCreate(){this.editItem=null,this.errorMsg.set(""),this.form.reset({isActive:!0,applicationType:""}),this.showForm=!0}openEdit(t){this.editItem=t,this.errorMsg.set(""),this.form.patchValue(Ve(ue({},t),{applicationType:t.applicationType??""})),this.showForm=!0}closeForm(){this.showForm=!1}isTypeDisabled(t,e){return t?e.some(o=>o.applicationType===t&&o.id!==this.editItem?.id):!1}submit(){if(this.form.invalid)return;let t=this.form.value,e=Ve(ue({},t),{applicationType:t.applicationType||void 0}),o=this.editItem?this.approvalService.update(this.editItem.id,e):this.approvalService.create(e);this.errorMsg.set(""),o.subscribe({next:()=>{this.showForm=!1,this.refresh$.next()},error:s=>{this.errorMsg.set(s.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}delete(t){confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u7C3D\u6838\u9805\u76EE\u300C${t.name}\u300D\u55CE\uFF1F`)&&this.approvalService.delete(t.id).subscribe(()=>this.refresh$.next())}toggleActive(t){this.approvalService.update(t.id,{isActive:!t.isActive}).subscribe(()=>this.refresh$.next())}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-approval-list"]],decls:40,vars:5,consts:[[1,"container-fluid","py-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-2","mb-6"],[1,"flex","items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#check-square"],[1,"mb-0"],[1,"btn","btn-primary","inline-flex","items-center","gap-1",3,"click"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],[1,"card","border-0","shadow-sm","mb-6"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"hidden","md:table-cell"],[1,"hidden","xl:table-cell"],[1,"hidden","lg:table-cell"],[1,"text-right"],["href","/assets/icons/sprite.svg#alert-triangle"],[1,"card-header","bg-transparent","fw-500"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"row","g-3"],[1,"flex","gap-2","mt-4"],["type","submit",1,"btn","btn-primary","btn-sm",3,"disabled"],["type","button",1,"btn","btn-outline-secondary","btn-sm",3,"click"],[1,"col-12","col-md-3"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","name","placeholder","\u4F8B\u5982\uFF1A\u8ACB\u5047\u7533\u8ACB",1,"form-control"],[1,"text-danger","small","mt-1"],[1,"col-12","col-md-2"],["type","text","formControlName","code","placeholder","\u4F8B\u5982\uFF1Aleave_request",1,"form-control","font-monospace"],["type","text","formControlName","description","placeholder","\u9078\u586B\u8AAA\u660E",1,"form-control"],["formControlName","applicationType",1,"form-select"],[3,"value","disabled"],[1,"col-12","col-md-1","flex","items-end"],[1,"form-check"],["type","checkbox","formControlName","isActive","id","isActive",1,"form-check-input"],["for","isActive",1,"form-check-label"],[1,"fw-500"],[1,"text-muted","small"],[3,"class"],[1,"text-muted","hidden","xl:table-cell"],[1,"badge","bg-info-subtle","text-info"],[1,"text-muted","small","hidden","lg:table-cell"],[1,"text-right",2,"white-space","nowrap"],[1,"flex","justify-end","gap-1"],["title","\u7BA1\u7406\u6D41\u7A0B",1,"btn","btn-sm","btn-ghost-info","inline-flex","items-center",3,"routerLink"],["href","/assets/icons/sprite.svg#git-merge"],["title","\u7DE8\u8F2F",1,"btn","btn-sm","btn-ghost-primary","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#edit"],["title","\u522A\u9664",1,"btn","btn-sm","btn-ghost-danger","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#trash"],["colspan","8",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),u(),i(3,"svg",3),d(4,"use",4),r(),S(),i(5,"h4",5),a(6,"\u7C3D\u6838\u7BA1\u7406"),r()(),i(7,"button",6),b("click",function(){return o.openCreate()}),u(),i(8,"svg",7),d(9,"use",8),r(),a(10," \u65B0\u589E\u9805\u76EE "),r()(),p(11,_a,4,1,"div",9),p(12,Ca,12,7,"div",10),S(),i(13,"div",11)(14,"div",12)(15,"div",13)(16,"table",14)(17,"thead",15)(18,"tr")(19,"th"),a(20,"\u9805\u76EE\u540D\u7A31"),r(),i(21,"th"),a(22,"\u4EE3\u78BC"),r(),i(23,"th",16),a(24,"\u9069\u7528\u985E\u578B"),r(),i(25,"th",17),a(26,"\u63CF\u8FF0"),r(),i(27,"th"),a(28,"\u6B65\u9A5F\u6578"),r(),i(29,"th"),a(30,"\u72C0\u614B"),r(),i(31,"th",18),a(32,"\u5EFA\u7ACB\u6642\u9593"),r(),i(33,"th",19),a(34,"\u64CD\u4F5C"),r()()(),i(35,"tbody"),L(36,Aa,31,15,"tr",null,fa,!1,Fa,3,0,"tr"),I(39,"async"),r()()()()()()),e&2&&(l(11),c(o.errorMsg()?11:-1),l(),c(o.showForm?12:-1),l(24),P(ye(39,3,o.items$)))},dependencies:[q,ne,X,Re,Be,K,rn,Ie,Z,Q,te,ee,Le,be],encapsulation:2})};var Di=(n,t)=>t.id;function Ta(n,t){if(n&1&&(i(0,"div",10),u(),i(1,"svg",15),d(2,"use",20),r(),a(3),r()),n&2){let e=m(2);l(3),C(" ",e.errorMsg()," ")}}function wa(n,t){if(n&1&&(i(0,"p",11),a(1),r()),n&2){let e=m();l(),f(e.description)}}function Da(n,t){if(n&1&&(i(0,"option",31),a(1),r()),n&2){let e=t.$implicit;h("ngValue",e.id),l(),f(e.name)}}function ka(n,t){if(n&1&&(i(0,"option",31),a(1),r()),n&2){let e=t.$implicit;h("ngValue",e.id),l(),Y("",e.name,"\uFF08L",e.level,"\uFF09")}}function La(n,t){if(n&1){let e=D();i(0,"div",17)(1,"div",21),a(2),r(),i(3,"div",22)(4,"form",23),b("ngSubmit",function(){E(e);let s=m(2);return y(s.submitStep())}),i(5,"div",24)(6,"div",25)(7,"label",26),a(8,"\u6B65\u9A5F\u9806\u5E8F "),i(9,"span",27),a(10,"*"),r()(),d(11,"input",28),r(),i(12,"div",29)(13,"label",26),a(14,"\u90E8\u9580"),r(),i(15,"select",30)(16,"option",31),a(17,"\u2014 \u4E0D\u9650\u90E8\u9580 \u2014"),r(),L(18,Da,2,2,"option",31,Di),r()(),i(20,"div",29)(21,"label",26),a(22,"\u8077\u7A31"),r(),i(23,"select",32)(24,"option",31),a(25,"\u2014 \u4E0D\u9650\u8077\u7A31 \u2014"),r(),L(26,ka,2,3,"option",31,Di),r()(),i(28,"div",33)(29,"label",26),a(30,"\u6B65\u9A5F\u8AAA\u660E"),r(),d(31,"input",34),r()(),i(32,"div",35),a(33,"\u90E8\u9580\u6216\u8077\u7A31\u81F3\u5C11\u9078\u4E00\u3002"),r(),i(34,"div",36)(35,"button",37),a(36),r(),i(37,"button",38),b("click",function(){E(e);let s=m(2);return y(s.closeStepForm())}),a(38,"\u53D6\u6D88"),r()()()()()}if(n&2){let e=m(2);l(2),C(" ",e.editStep?"\u7DE8\u8F2F\u6B65\u9A5F":"\u65B0\u589E\u6B65\u9A5F"," "),l(2),h("formGroup",e.stepForm),l(12),h("ngValue",null),l(2),P(e.departments),l(6),h("ngValue",null),l(2),P(e.jobTitles),l(10),C(" ",e.editStep?"\u66F4\u65B0":"\u65B0\u589E"," ")}}function Pa(n,t){n&1&&(i(0,"div",18)(1,"div",39),a(2,"\u5C1A\u672A\u8A2D\u5B9A\u4EFB\u4F55\u6B65\u9A5F"),r()())}function Ia(n,t){if(n&1&&(i(0,"span",47),u(),i(1,"svg",55),d(2,"use",56),r(),a(3),r()),n&2){let e=m().$implicit;l(3),C(" ",e.departmentName," ")}}function Ra(n,t){if(n&1&&(i(0,"span",48),u(),i(1,"svg",55),d(2,"use",57),r(),a(3),r()),n&2){let e=m().$implicit;l(3),C(" ",e.jobTitleName," ")}}function Ba(n,t){if(n&1&&(i(0,"span",49),a(1),r()),n&2){let e=m().$implicit;l(),f(e.note)}}function Ma(n,t){if(n&1){let e=D();i(0,"div",40)(1,"div",41)(2,"div",42),a(3),r()(),i(4,"div",43)(5,"div",44)(6,"div",45)(7,"div",46),p(8,Ia,4,1,"span",47),p(9,Ra,4,1,"span",48),p(10,Ba,2,1,"span",49),r(),i(11,"div",50)(12,"button",51),b("click",function(){let s=E(e).$implicit,v=m(3);return y(v.openEditStep(s))}),u(),i(13,"svg",15),d(14,"use",52),r()(),S(),i(15,"button",53),b("click",function(){let s=E(e).$implicit,v=m(3);return y(v.deleteStep(s))}),u(),i(16,"svg",15),d(17,"use",54),r()()()()()()()}if(n&2){let e=t.$implicit;l(3),C(" ",e.stepOrder," "),l(5),c(e.departmentName?8:-1),l(),c(e.jobTitleName?9:-1),l(),c(e.note?10:-1)}}function ja(n,t){if(n&1&&(i(0,"div",19),L(1,Ma,18,4,"div",40,Di),r()),n&2){let e=m();l(),P(e.steps)}}function Va(n,t){if(n&1){let e=D();i(0,"div",2)(1,"div",3)(2,"a",4),u(),i(3,"svg",5),d(4,"use",6),r()(),i(5,"svg",7),d(6,"use",8),r(),S(),i(7,"h4",9),a(8),r(),i(9,"span"),a(10),r()()(),p(11,Ta,4,1,"div",10),p(12,wa,2,1,"p",11),i(13,"div",12)(14,"h6",13),a(15),r(),i(16,"button",14),b("click",function(){E(e);let s=m();return y(s.openAddStep())}),u(),i(17,"svg",15),d(18,"use",16),r(),a(19," \u65B0\u589E\u6B65\u9A5F "),r()(),p(20,La,39,5,"div",17),p(21,Pa,3,0,"div",18)(22,ja,3,0,"div",19)}if(n&2){let e=t,o=m();l(8),C("",e.name,"\uFF5C\u7C3D\u6838\u6D41\u7A0B"),l(),J("badge "+(e.isActive?"bg-success-subtle text-success":"bg-secondary-subtle text-secondary")),l(),C(" ",e.isActive?"\u555F\u7528":"\u505C\u7528"," "),l(),c(o.errorMsg()?11:-1),l(),c(e.description?12:-1),l(3),C("\u7C3D\u6838\u6B65\u9A5F\uFF08\u5171 ",e.steps.length," \u6B65\uFF09"),l(5),c(o.showStepForm?20:-1),l(),c(e.steps.length===0?21:22)}}function Na(n,t){n&1&&(i(0,"p",1),a(1,"\u627E\u4E0D\u5230\u7C3D\u6838\u9805\u76EE\u3002"),r())}var ti=class n{route=g(me);approvalService=g(dt);deptService=g(Ge);jobTitleService=g(Je);fb=g(ie);itemId=0;item$=new De(void 0);departments=[];jobTitles=[];errorMsg=j("");showStepForm=!1;editStep=null;stepForm=this.fb.group({stepOrder:[1,[w.required,w.min(1)]],departmentId:[null],jobTitleId:[null],note:[""]});ngOnInit(){this.itemId=+(this.route.snapshot.paramMap.get("id")??0),this.approvalService.getById(this.itemId).subscribe(t=>this.item$.next(t)),this.deptService.getAll().pipe(Fi(1)).subscribe(t=>this.departments=t),this.jobTitleService.getAll().pipe(Fi(1)).subscribe(t=>this.jobTitles=t)}openAddStep(){this.editStep=null;let t=(this.item$.getValue()?.steps.length??0)+1;this.stepForm.reset({stepOrder:t,departmentId:null,jobTitleId:null,note:""}),this.showStepForm=!0}openEditStep(t){this.editStep=t,this.stepForm.patchValue({stepOrder:t.stepOrder,departmentId:t.departmentId??null,jobTitleId:t.jobTitleId??null,note:t.note??""}),this.showStepForm=!0}closeStepForm(){this.showStepForm=!1}submitStep(){if(this.stepForm.invalid)return;let t=this.stepForm.value,e=t.departmentId||void 0,o=t.jobTitleId||void 0;if(!e&&!o){alert("\u90E8\u9580\u6216\u8077\u7A31\u81F3\u5C11\u9078\u4E00\u3002");return}let s=e?this.departments.find(B=>B.id===e)?.name:void 0,v=o?this.jobTitles.find(B=>B.id===o)?.name:void 0,F={stepOrder:t.stepOrder,departmentId:e,departmentName:s,jobTitleId:o,jobTitleName:v,note:t.note??""},R=this.editStep?this.approvalService.updateStep(this.itemId,this.editStep.id,F):this.approvalService.addStep(this.itemId,F);this.errorMsg.set(""),R.subscribe({next:B=>{this.item$.next(B),this.showStepForm=!1},error:B=>{this.errorMsg.set(B.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}deleteStep(t){confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u6B65\u9A5F ${t.stepOrder} \u55CE\uFF1F`)&&(this.errorMsg.set(""),this.approvalService.deleteStep(this.itemId,t.id).subscribe({next:e=>this.item$.next(e),error:e=>{this.errorMsg.set(e.error?.message||"\u522A\u9664\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}}))}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-approval-flow"]],decls:4,vars:3,consts:[[1,"container-fluid","py-3"],[1,"text-muted"],[1,"flex","flex-wrap","items-center","justify-between","gap-2","mb-6"],[1,"flex","items-center","gap-2"],["routerLink","/admin/approvals",1,"btn","btn-sm","btn-outline-secondary"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#git-merge"],[1,"mb-0"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],[1,"text-muted","small","mb-6"],[1,"flex","items-center","justify-between","mb-4"],[1,"mb-0","text-muted"],[1,"btn","btn-outline-primary","btn-sm","inline-flex","items-center","gap-1",3,"click"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm","mb-6"],[1,"card","border-0","shadow-sm"],[1,"flex","flex-col","gap-2"],["href","/assets/icons/sprite.svg#alert-triangle"],[1,"card-header","bg-transparent","fw-500"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"row","g-3"],[1,"col-6","col-md-2"],[1,"form-label","fw-500"],[1,"text-danger"],["type","number","formControlName","stepOrder","min","1",1,"form-control"],[1,"col-12","col-md-4"],["formControlName","departmentId",1,"form-select"],[3,"ngValue"],["formControlName","jobTitleId",1,"form-select"],[1,"col-12","col-md-6"],["type","text","formControlName","note","placeholder","\u9078\u586B\u8AAA\u660E",1,"form-control"],[1,"text-muted","small","mt-2"],[1,"flex","gap-2","mt-4"],["type","submit",1,"btn","btn-primary","btn-sm"],["type","button",1,"btn","btn-outline-secondary","btn-sm",3,"click"],[1,"card-body","text-center","text-muted","py-5"],[1,"flex","gap-3","items-center"],[1,"flex","flex-col","items-center","shrink-0",2,"width","36px"],[1,"rounded-circle","bg-primary","text-white","flex","items-center","justify-center","font-bold",2,"width","32px","height","32px","font-size",".85rem"],[1,"card","border-0","shadow-sm","grow","min-w-0","mb-0"],[1,"card-body","py-2","px-3"],[1,"flex","items-center","justify-between","flex-wrap","gap-2"],[1,"flex","flex-wrap","gap-2","items-center"],[1,"badge","bg-primary-subtle","text-primary","inline-flex","items-center","gap-1",2,"white-space","nowrap"],[1,"badge","bg-warning-subtle","text-warning-emphasis","inline-flex","items-center","gap-1",2,"white-space","nowrap"],[1,"text-muted","small"],[1,"flex","gap-1"],["title","\u7DE8\u8F2F",1,"btn","btn-sm","btn-ghost-primary","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#edit"],["title","\u522A\u9664",1,"btn","btn-sm","btn-ghost-danger","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#trash"],[1,"sa-icon",2,"width","12px","height","12px","flex-shrink","0","stroke","currentColor"],["href","/assets/icons/sprite.svg#git-branch"],["href","/assets/icons/sprite.svg#briefcase"]],template:function(e,o){if(e&1&&(i(0,"div",0),p(1,Va,23,9),I(2,"async"),$t(3,Na,2,0,"p",1),r()),e&2){let s;l(),c((s=ye(2,1,o.item$))?1:3,s)}},dependencies:[q,ne,X,Re,Be,K,xe,Ie,Z,Q,he,te,ee,Le],encapsulation:2})};var Ue=class n{http=g(fe);getAll(){return this.http.get(`${T.apiUrl}/projects`)}getPaged(t,e){return this.http.get(`${T.apiUrl}/projects`,{params:{page:t,pageSize:e}})}getById(t){return this.http.get(`${T.apiUrl}/projects/${t}`)}create(t){return this.http.post(`${T.apiUrl}/projects`,t)}update(t,e){return this.http.patch(`${T.apiUrl}/projects/${t}`,e)}delete(t){return this.http.delete(`${T.apiUrl}/projects/${t}`)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})};var mn={active:"\u9032\u884C\u4E2D",closed:"\u5DF2\u7D50\u6848"},dn={active:"bg-success-subtle text-success",closed:"bg-secondary-subtle text-secondary"};var un=n=>[n,"edit"],Oa=(n,t)=>t.id;function qa(n,t){if(n&1&&(i(0,"span",18),a(1),r()),n&2){let e=m().$implicit;l(),f(e.departmentName)}}function $a(n,t){n&1&&(i(0,"span",19),a(1,"\u2014"),r())}function Ga(n,t){if(n&1&&(a(0),I(1,"number")),n&2){let e=m().$implicit;C(" ",O(1,1,e.budgetAmount,"1.0-0")," ")}}function Ua(n,t){n&1&&(i(0,"span",19),a(1,"\u2014"),r())}function Ha(n,t){if(n&1&&(a(0),I(1,"number")),n&2){let e=m().$implicit;C(" ",O(1,1,e.actualAmount,"1.0-0")," ")}}function za(n,t){n&1&&(i(0,"span",19),a(1,"\u2014"),r())}function Ja(n,t){if(n&1&&(a(0),I(1,"number")),n&2){let e=m().$implicit;C(" ",O(1,1,e.businessAmount,"1.0-0")," ")}}function Ya(n,t){n&1&&(i(0,"span",19),a(1,"\u2014"),r())}function Wa(n,t){if(n&1&&(i(0,"a",20),u(),i(1,"svg",24),d(2,"use",25),r(),a(3," \u958B\u555F "),r()),n&2){let e=m().$implicit;h("href",e.googleDriveUrl,ot)}}function Ka(n,t){n&1&&(i(0,"span",19),a(1,"\u2014"),r())}function Za(n,t){if(n&1){let e=D();i(0,"a",26),u(),i(1,"svg",7),d(2,"use",27),r()(),S(),i(3,"button",28),b("click",function(){E(e);let s=m().$implicit,v=m();return y(v.delete(s))}),u(),i(4,"svg",7),d(5,"use",29),r()()}if(n&2){let e=m().$implicit;h("routerLink",W(1,un,e.id))}}function Qa(n,t){if(n&1&&(i(0,"a",23),u(),i(1,"svg",7),d(2,"use",30),r()()),n&2){let e=m().$implicit;h("routerLink",W(1,un,e.id))}}function Xa(n,t){if(n&1&&(i(0,"tr")(1,"td",17),a(2),r(),i(3,"td")(4,"span"),a(5),r()(),i(6,"td"),p(7,qa,2,1,"span",18)(8,$a,2,0,"span",19),r(),i(9,"td",14),p(10,Ga,2,4)(11,Ua,2,0,"span",19),r(),i(12,"td",14),p(13,Ha,2,4)(14,za,2,0,"span",19),r(),i(15,"td",14),p(16,Ja,2,4)(17,Ya,2,0,"span",19),r(),i(18,"td",15),p(19,Wa,4,1,"a",20)(20,Ka,2,0,"span",19),r(),i(21,"td",21)(22,"div",22),p(23,Za,6,3)(24,Qa,3,3,"a",23),r()()()),n&2){let e=t.$implicit,o=m();l(2),f(e.code),l(2),J("badge "+o.statusClass[e.status]),l(),f(o.statusLabel[e.status]),l(2),c(e.departmentName?7:8),l(3),c(e.budgetAmount!=null?10:11),l(3),c(e.actualAmount!=null?13:14),l(3),c(e.businessAmount!=null?16:17),l(3),c(e.googleDriveUrl?19:20),l(4),c(e.status!=="closed"?23:24)}}function eo(n,t){n&1&&(i(0,"tr")(1,"td",31),a(2,"\u5C1A\u7121\u5C08\u6848\u8CC7\u6599\u3002"),r()())}function to(n,t){n&1&&(i(0,"li",39)(1,"span",41),a(2,"\u2026"),r()())}function io(n,t){if(n&1){let e=D();i(0,"li",37)(1,"button",38),b("click",function(){E(e);let s=m().$implicit,v=m(2);return y(v.goTo(s))}),a(2),r()()}if(n&2){let e=m().$implicit,o=m(2);$("active",e===o.page()),l(2),f(e)}}function no(n,t){if(n&1&&p(0,to,3,0,"li",39)(1,io,3,3,"li",40),n&2){let e=t.$implicit;c(e===-1?0:1)}}function ro(n,t){if(n&1){let e=D();i(0,"div",16)(1,"span",32),a(2),r(),i(3,"div",33)(4,"button",34),b("click",function(){E(e);let s=m();return y(s.prev())}),a(5,"\u2039"),r(),i(6,"span",35),a(7),r(),i(8,"button",34),b("click",function(){E(e);let s=m();return y(s.next())}),a(9,"\u203A"),r()(),i(10,"ul",36)(11,"li",37)(12,"button",38),b("click",function(){E(e);let s=m();return y(s.prev())}),a(13,"\u2039"),r()(),L(14,no,2,1,null,null,_e),i(16,"li",37)(17,"button",38),b("click",function(){E(e);let s=m();return y(s.next())}),a(18,"\u203A"),r()()()()}if(n&2){let e=m();l(2),ke("\u5171 ",e.totalCount()," \u7B46\uFF0C\u7B2C ",e.page()," / ",e.totalPages()," \u9801"),l(2),$("disabled",e.page()===1),l(3),Y("",e.page()," / ",e.totalPages()),l(),$("disabled",e.page()===e.totalPages()),l(3),$("disabled",e.page()===1),l(3),P(e.pageNumbers()),l(2),$("disabled",e.page()===e.totalPages())}}var ii=class n{projectService=g(Ue);PAGE_SIZE=20;page=j(1);refresh=j(0);result=we(Me(N(()=>({page:this.page(),refresh:this.refresh()}))).pipe(se(({page:t})=>this.projectService.getPaged(t,this.PAGE_SIZE))),{initialValue:{items:[],totalCount:0,page:1,pageSize:20,totalPages:1}});pagedProjects=N(()=>this.result().items);totalCount=N(()=>this.result().totalCount);totalPages=N(()=>this.result().totalPages);pageNumbers=N(()=>ao(this.page(),this.totalPages()));statusLabel=mn;statusClass=dn;goTo(t){this.page.set(t)}prev(){this.page()>1&&this.page.update(t=>t-1)}next(){this.page()<this.totalPages()&&this.page.update(t=>t+1)}delete(t){t.status!=="closed"&&confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u5C08\u6848\u300C${t.code}\u300D\u55CE\uFF1F`)&&this.projectService.delete(t.id).subscribe(()=>{this.refresh.update(e=>e+1)})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-project-list"]],decls:38,vars:2,consts:[[1,"container-fluid","py-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-2","mb-6"],[1,"flex","items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#folder"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","inline-flex","items-center","gap-1"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"text-right"],[1,"hidden","lg:table-cell"],[1,"flex","flex-col","gap-2","sm:flex-row","sm:items-center","sm:justify-between","px-4","py-3","border-t"],[1,"fw-500","font-monospace"],[1,"badge","bg-primary-subtle","text-primary"],[1,"text-muted"],["target","_blank","rel","noopener",1,"inline-flex","items-center","gap-1","text-decoration-none","text-muted","small",3,"href"],[1,"text-right",2,"white-space","nowrap"],[1,"flex","justify-end","gap-1"],[1,"btn","btn-sm","btn-ghost-secondary","inline-flex","items-center",3,"routerLink"],[1,"sa-icon",2,"stroke","currentColor","width","14px","height","14px"],["href","/assets/icons/sprite.svg#external-link"],[1,"btn","btn-sm","btn-ghost-primary","inline-flex","items-center",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],[1,"btn","btn-sm","btn-ghost-danger","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#trash"],["href","/assets/icons/sprite.svg#eye"],["colspan","8",1,"text-center","text-muted","py-4"],[1,"text-muted","small","text-center","sm:text-left"],[1,"flex","sm:hidden","items-center","gap-1"],[1,"page-link","rounded",3,"click"],[1,"px-2","text-sm"],[1,"hidden","sm:flex","pagination","mb-0"],[1,"page-item"],[1,"page-link",3,"click"],[1,"page-item","disabled"],[1,"page-item",3,"active"],[1,"page-link"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),u(),i(3,"svg",3),d(4,"use",4),r(),S(),i(5,"h4",5),a(6,"\u5C08\u6848\u7BA1\u7406"),r()(),i(7,"a",6),u(),i(8,"svg",7),d(9,"use",8),r(),a(10," \u65B0\u589E\u5C08\u6848 "),r()(),S(),i(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u7DE8\u865F"),r(),i(19,"th"),a(20,"\u72C0\u614B"),r(),i(21,"th"),a(22,"\u90E8\u9580"),r(),i(23,"th",14),a(24,"\u9810\u5B9A\u91D1\u984D"),r(),i(25,"th",14),a(26,"\u5BE6\u969B\u91D1\u984D"),r(),i(27,"th",14),a(28,"\u696D\u52D9\u91D1\u984D"),r(),i(29,"th",15),a(30,"Google Drive"),r(),i(31,"th",14),a(32,"\u64CD\u4F5C"),r()()(),i(33,"tbody"),L(34,Xa,25,10,"tr",null,Oa,!1,eo,3,0,"tr"),r()()(),p(37,ro,19,13,"div",16),r()()()),e&2&&(l(34),P(o.pagedProjects()),l(3),c(o.totalPages()>1?37:-1))},dependencies:[q,Pe],encapsulation:2})};function ao(n,t){if(t<=9)return Array.from({length:t},(s,v)=>v+1);let e=[],o=0;for(let s=1;s<=t;s++)(s===1||s===t||s>=n-2&&s<=n+2)&&(o&&s-o>1&&e.push(-1),e.push(s),o=s);return e}var oo=(n,t)=>t.id;function lo(n,t){if(n&1&&(i(0,"div",6),u(),i(1,"svg",28),d(2,"use",29),r(),a(3),r()),n&2){let e=m();l(3),C(" ",e.errorMsg()," ")}}function so(n,t){n&1&&(i(0,"div",16),a(1,"\u8ACB\u8F38\u5165\u5C08\u6848\u7DE8\u865F\u3002"),r())}function mo(n,t){if(n&1&&(i(0,"option",21),a(1),r()),n&2){let e=t.$implicit;h("ngValue",e.id),l(),f(e.name)}}function uo(n,t){n&1&&(i(0,"div",16),a(1,"\u8ACB\u9078\u64C7\u90E8\u9580\u3002"),r())}function po(n,t){n&1&&(i(0,"div",16),a(1,"\u8ACB\u8F38\u5165\u9810\u5B9A\u91D1\u984D\uFF08\u4E0D\u53EF\u70BA\u8CA0\u6578\uFF09\u3002"),r())}function co(n,t){n&1&&(i(0,"div",16),a(1,"\u8ACB\u8F38\u5165\u5BE6\u969B\u91D1\u984D\uFF08\u4E0D\u53EF\u70BA\u8CA0\u6578\uFF09\u3002"),r())}function vo(n,t){n&1&&(i(0,"div",16),a(1,"\u8ACB\u8F38\u5165\u696D\u52D9\u91D1\u984D\uFF08\u4E0D\u53EF\u70BA\u8CA0\u6578\uFF09\u3002"),r())}function fo(n,t){n&1&&(i(0,"div",16),a(1,"\u8ACB\u8F38\u5165 Google Drive \u9023\u7D50\u3002"),r())}function go(n,t){n&1&&(i(0,"div",26)(1,"a",30),a(2,"\u8FD4\u56DE\u5217\u8868"),r()())}function _o(n,t){if(n&1&&(i(0,"div",27)(1,"button",31),a(2),r(),i(3,"a",30),a(4,"\u53D6\u6D88"),r()()),n&2){let e=m();l(),h("disabled",e.form.invalid),l(),C(" ",e.isEdit?"\u66F4\u65B0":"\u5EFA\u7ACB"," ")}}var wt=class n{fb=g(ie);projectService=g(Ue);deptService=g(Ge);route=g(me);router=g(de);cdr=g(Ze);departments=[];loadingDepts=!0;isEdit=!1;isClosed=!1;projectId=0;errorMsg=j("");form=this.fb.group({code:["",w.required],status:["active",w.required],departmentId:[{value:null,disabled:!0},w.required],budgetAmount:[null,[w.required,w.min(0)]],actualAmount:[null,[w.required,w.min(0)]],businessAmount:[null,[w.required,w.min(0)]],googleDriveUrl:["",w.required]});ngOnInit(){this.deptService.getAll().subscribe({next:e=>{this.departments=e,this.loadingDepts=!1,this.isClosed||this.form.get("departmentId").enable(),this.cdr.markForCheck()},error:()=>{this.loadingDepts=!1,this.isClosed||this.form.get("departmentId").enable(),this.errorMsg.set("\u8F09\u5165\u90E8\u9580\u8CC7\u6599\u5931\u6557\u3002")}});let t=this.route.snapshot.paramMap.get("id");t&&(this.isEdit=!0,this.projectId=+t,this.projectService.getById(this.projectId).subscribe({next:e=>{e&&(this.isClosed=e.status==="closed",this.form.patchValue({code:e.code,status:e.status,departmentId:e.departmentId??null,budgetAmount:e.budgetAmount??null,actualAmount:e.actualAmount??null,businessAmount:e.businessAmount??null,googleDriveUrl:e.googleDriveUrl??""}),this.isClosed&&this.form.disable(),this.cdr.markForCheck())},error:()=>this.errorMsg.set("\u8F09\u5165\u5C08\u6848\u8CC7\u6599\u5931\u6557\u3002")}))}submit(){if(this.form.invalid||this.isClosed)return;let t=this.form.getRawValue();if(t.status==="closed"&&!confirm("\u78BA\u5B9A\u8981\u5C07\u6B64\u5C08\u6848\u8A2D\u70BA\u300C\u5DF2\u7D50\u6848\u300D\u55CE\uFF1F\u7D50\u6848\u5F8C\u5C07\u7121\u6CD5\u518D\u4FEE\u6539\u6216\u522A\u9664\u3002"))return;let e=this.departments.find(v=>v.id===t.departmentId),o={code:t.code,status:t.status,departmentId:t.departmentId??void 0,departmentName:e?.name,budgetAmount:t.budgetAmount??void 0,actualAmount:t.actualAmount??void 0,businessAmount:t.businessAmount??void 0,googleDriveUrl:t.googleDriveUrl||void 0},s=this.isEdit?this.projectService.update(this.projectId,o):this.projectService.create(o);this.errorMsg.set(""),s.subscribe({next:()=>this.router.navigate(["/admin/projects"]),error:v=>{this.errorMsg.set(v.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-project-form"]],decls:71,vars:12,consts:[[1,"container-fluid","py-3"],[1,"flex","items-center","gap-2","mb-6"],["routerLink","/admin/projects",1,"btn","btn-sm","btn-outline-secondary"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-lg-8","col-xl-6"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[1,"mb-4"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","code","placeholder","\u4F8B\u5982\uFF1AP2025-001",1,"form-control","font-monospace"],[1,"text-danger","small","mt-1"],["formControlName","status",1,"form-select"],["value","active"],["value","closed"],["formControlName","departmentId",1,"form-select"],[3,"ngValue"],["type","number","formControlName","budgetAmount","min","0",1,"form-control"],["type","number","formControlName","actualAmount","min","0",1,"form-control"],["type","number","formControlName","businessAmount","min","0",1,"form-control"],["type","url","formControlName","googleDriveUrl","placeholder","https://drive.google.com/drive/folders/...",1,"form-control"],[1,"mt-6"],[1,"mt-6","flex","gap-2"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#alert-triangle"],["routerLink","/admin/projects",1,"btn","btn-outline-secondary"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(e,o){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"a",2),u(),i(3,"svg",3),d(4,"use",4),r()(),S(),i(5,"h4",5),a(6),r()(),p(7,lo,4,1,"div",6),i(8,"form",7),b("ngSubmit",function(){return o.submit()}),i(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11)(13,"div",12)(14,"label",13),a(15,"\u5C08\u6848\u7DE8\u865F "),i(16,"span",14),a(17,"*"),r()(),d(18,"input",15),p(19,so,2,0,"div",16),r(),i(20,"div",12)(21,"label",13),a(22,"\u72C0\u614B "),i(23,"span",14),a(24,"*"),r()(),i(25,"select",17)(26,"option",18),a(27,"\u9032\u884C\u4E2D"),r(),i(28,"option",19),a(29,"\u5DF2\u7D50\u6848"),r()()(),i(30,"div",12)(31,"label",13),a(32,"\u90E8\u9580 "),i(33,"span",14),a(34,"*"),r()(),i(35,"select",20)(36,"option",21),a(37),r(),L(38,mo,2,2,"option",21,oo),r(),p(40,uo,2,0,"div",16),r(),i(41,"div",12)(42,"label",13),a(43,"\u9810\u5B9A\u91D1\u984D "),i(44,"span",14),a(45,"*"),r()(),d(46,"input",22),p(47,po,2,0,"div",16),r(),i(48,"div",12)(49,"label",13),a(50,"\u5BE6\u969B\u91D1\u984D "),i(51,"span",14),a(52,"*"),r()(),d(53,"input",23),p(54,co,2,0,"div",16),r(),i(55,"div",12)(56,"label",13),a(57,"\u696D\u52D9\u91D1\u984D "),i(58,"span",14),a(59,"*"),r()(),d(60,"input",24),p(61,vo,2,0,"div",16),r(),i(62,"div",5)(63,"label",13),a(64,"Google Drive \u9023\u7D50 "),i(65,"span",14),a(66,"*"),r()(),d(67,"input",25),p(68,fo,2,0,"div",16),r()()(),p(69,go,3,0,"div",26)(70,_o,5,2,"div",27),r()()()()),e&2){let s,v,F,R,B,z;l(6),f(o.isClosed?"\u6AA2\u8996\u5C08\u6848\uFF08\u5DF2\u7D50\u6848\uFF09":o.isEdit?"\u7DE8\u8F2F\u5C08\u6848":"\u65B0\u589E\u5C08\u6848"),l(),c(o.errorMsg()?7:-1),l(),h("formGroup",o.form),l(11),c((s=o.form.get("code"))!=null&&s.invalid&&((s=o.form.get("code"))!=null&&s.touched)?19:-1),l(17),h("ngValue",null),l(),f(o.loadingDepts?"\u8F09\u5165\u4E2D\u2026":"\u2014 \u8ACB\u9078\u64C7\u90E8\u9580 \u2014"),l(),P(o.departments),l(2),c((v=o.form.get("departmentId"))!=null&&v.invalid&&((v=o.form.get("departmentId"))!=null&&v.touched)?40:-1),l(7),c((F=o.form.get("budgetAmount"))!=null&&F.invalid&&((F=o.form.get("budgetAmount"))!=null&&F.touched)?47:-1),l(7),c((R=o.form.get("actualAmount"))!=null&&R.invalid&&((R=o.form.get("actualAmount"))!=null&&R.touched)?54:-1),l(7),c((B=o.form.get("businessAmount"))!=null&&B.invalid&&((B=o.form.get("businessAmount"))!=null&&B.touched)?61:-1),l(7),c((z=o.form.get("googleDriveUrl"))!=null&&z.invalid&&((z=o.form.get("googleDriveUrl"))!=null&&z.touched)?68:-1),l(),c(o.isClosed?69:70)}},dependencies:[ne,X,Re,Be,K,xe,Ie,Z,Q,he,te,ee,q],encapsulation:2})};var ut=class n{http=g(fe);getAll(){return this.http.get(`${T.apiUrl}/payment-requests`)}getPaged(t,e){return this.http.get(`${T.apiUrl}/payment-requests`,{params:{page:t,pageSize:e}})}getById(t){return this.http.get(`${T.apiUrl}/payment-requests/${t}`)}createWithFiles(t){return this.http.post(`${T.apiUrl}/payment-requests`,t)}updateWithFiles(t,e){return this.http.patch(`${T.apiUrl}/payment-requests/${t}`,e)}delete(t){return this.http.delete(`${T.apiUrl}/payment-requests/${t}`)}submit(t){return this.http.patch(`${T.apiUrl}/payment-requests/${t}/submit`,{})}static \u0275fac=function(e){return new(e||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})};var pn={vendor:"\u5EE0\u5546\u8ACB\u6B3E",travel:"\u54E1\u5DE5\u5DEE\u65C5",advance:"\u54E1\u5DE5\u9810\u652F"},cn={vendor:"bg-info-subtle text-info",travel:"bg-primary-subtle text-primary",advance:"bg-warning-subtle text-warning-emphasis"},ni={draft:"\u8349\u7A3F",pending:"\u5F85\u5BE9\u6838",approved:"\u5DF2\u6838\u51C6",rejected:"\u5DF2\u62D2\u7D55",returned:"\u9000\u56DE\u4FEE\u6539"},ri={draft:"bg-blue-subtle text-blue-emphasis",pending:"bg-warning-subtle text-warning-emphasis",approved:"bg-success-subtle text-success",rejected:"bg-danger-subtle text-danger",returned:"bg-secondary-subtle text-secondary"};var vn=n=>[n,"edit"],bo=(n,t)=>t.id;function xo(n,t){if(n&1){let e=D();i(0,"a",24),u(),i(1,"svg",7),d(2,"use",25),r()(),S(),i(3,"button",26),b("click",function(){E(e);let s=m().$implicit,v=m();return y(v.delete(s))}),u(),i(4,"svg",7),d(5,"use",27),r()()}if(n&2){let e=m().$implicit;h("routerLink",W(1,vn,e.id))}}function ho(n,t){if(n&1&&(i(0,"a",23),u(),i(1,"svg",7),d(2,"use",28),r()()),n&2){let e=m().$implicit;h("routerLink",W(1,vn,e.id))}}function So(n,t){if(n&1&&(i(0,"tr")(1,"td")(2,"span"),a(3),r()(),i(4,"td",17),a(5),r(),i(6,"td")(7,"span",18),a(8),r()(),i(9,"td",19),a(10),I(11,"number"),r(),i(12,"td")(13,"span"),a(14),r()(),i(15,"td",20),a(16),I(17,"date"),r(),i(18,"td",21)(19,"div",22),p(20,xo,6,3)(21,ho,3,3,"a",23),r()()()),n&2){let e=t.$implicit,o=m();l(2),J("badge "+o.typeClass[e.type]),l(),f(o.typeLabel[e.type]),l(2),f(e.projectCode),l(3),C("",e.invoices.length," \u5F35"),l(2),f(O(11,11,e.totalAmount,"1.0-0")),l(3),J("badge "+o.statusClass[e.approvalStatus]),l(),f(o.statusLabel[e.approvalStatus]),l(2),f(O(17,14,e.createdAt,"yyyy-MM-dd")),l(4),c(e.approvalStatus==="draft"?20:21)}}function Co(n,t){n&1&&(i(0,"tr")(1,"td",29),a(2,"\u5C1A\u7121\u8ACB\u6B3E\u7533\u8ACB\u3002"),r()())}function Eo(n,t){n&1&&(i(0,"li",37)(1,"span",39),a(2,"\u2026"),r()())}function yo(n,t){if(n&1){let e=D();i(0,"li",35)(1,"button",36),b("click",function(){E(e);let s=m().$implicit,v=m(2);return y(v.goTo(s))}),a(2),r()()}if(n&2){let e=m().$implicit,o=m(2);$("active",e===o.page()),l(2),f(e)}}function Ao(n,t){if(n&1&&p(0,Eo,3,0,"li",37)(1,yo,3,3,"li",38),n&2){let e=t.$implicit;c(e===-1?0:1)}}function Fo(n,t){if(n&1){let e=D();i(0,"div",16)(1,"span",30),a(2),r(),i(3,"div",31)(4,"button",32),b("click",function(){E(e);let s=m();return y(s.prev())}),a(5,"\u2039"),r(),i(6,"span",33),a(7),r(),i(8,"button",32),b("click",function(){E(e);let s=m();return y(s.next())}),a(9,"\u203A"),r()(),i(10,"ul",34)(11,"li",35)(12,"button",36),b("click",function(){E(e);let s=m();return y(s.prev())}),a(13,"\u2039"),r()(),L(14,Ao,2,1,null,null,_e),i(16,"li",35)(17,"button",36),b("click",function(){E(e);let s=m();return y(s.next())}),a(18,"\u203A"),r()()()()}if(n&2){let e=m();l(2),ke("\u5171 ",e.totalCount()," \u7B46\uFF0C\u7B2C ",e.page()," / ",e.totalPages()," \u9801"),l(2),$("disabled",e.page()===1),l(3),Y("",e.page()," / ",e.totalPages()),l(),$("disabled",e.page()===e.totalPages()),l(3),$("disabled",e.page()===1),l(3),P(e.pageNumbers()),l(2),$("disabled",e.page()===e.totalPages())}}var ai=class n{service=g(ut);PAGE_SIZE=20;page=j(1);refresh=j(0);result=we(Me(N(()=>({page:this.page(),refresh:this.refresh()}))).pipe(se(({page:t})=>this.service.getPaged(t,this.PAGE_SIZE))),{initialValue:{items:[],totalCount:0,page:1,pageSize:20,totalPages:1}});pagedRequests=N(()=>this.result().items);totalCount=N(()=>this.result().totalCount);totalPages=N(()=>this.result().totalPages);pageNumbers=N(()=>To(this.page(),this.totalPages()));goTo(t){this.page.set(t)}prev(){this.page()>1&&this.page.update(t=>t-1)}next(){this.page()<this.totalPages()&&this.page.update(t=>t+1)}typeLabel=pn;typeClass=cn;statusLabel=ni;statusClass=ri;delete(t){confirm("\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u8ACB\u6B3E\u7533\u8ACB\u55CE\uFF1F")&&this.service.delete(t.id).subscribe(()=>this.refresh.update(e=>e+1))}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-payment-list"]],decls:36,vars:2,consts:[[1,"container-fluid","py-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-2","mb-6"],[1,"flex","items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprites.svg#dollar-sign"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","inline-flex","items-center","gap-1"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"text-right"],[1,"hidden","lg:table-cell"],[1,"flex","flex-col","gap-2","sm:flex-row","sm:items-center","sm:justify-between","px-4","py-3","border-t"],[1,"fw-500","font-monospace"],[1,"badge","bg-secondary-subtle","text-secondary"],[1,"text-right","fw-500"],[1,"text-muted","small","hidden","lg:table-cell"],[1,"text-right",2,"white-space","nowrap"],[1,"flex","justify-end","gap-1"],["title","\u6AA2\u8996",1,"btn","btn-sm","btn-ghost-secondary","inline-flex","items-center",3,"routerLink"],["title","\u7DE8\u8F2F",1,"btn","btn-sm","btn-ghost-primary","inline-flex","items-center",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],["title","\u522A\u9664",1,"btn","btn-sm","btn-ghost-danger","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#trash"],["href","/assets/icons/sprite.svg#eye"],["colspan","7",1,"text-center","text-muted","py-4"],[1,"text-muted","small","text-center","sm:text-left"],[1,"flex","sm:hidden","items-center","gap-1"],[1,"page-link","rounded",3,"click"],[1,"px-2","text-sm"],[1,"hidden","sm:flex","pagination","mb-0"],[1,"page-item"],[1,"page-link",3,"click"],[1,"page-item","disabled"],[1,"page-item",3,"active"],[1,"page-link"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),u(),i(3,"svg",3),d(4,"use",4),r(),S(),i(5,"h4",5),a(6,"\u8ACB\u6B3E\u7533\u8ACB"),r()(),i(7,"a",6),u(),i(8,"svg",7),d(9,"use",8),r(),a(10," \u65B0\u589E\u7533\u8ACB "),r()(),S(),i(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u985E\u578B"),r(),i(19,"th"),a(20,"\u5C08\u6848\u7DE8\u865F"),r(),i(21,"th"),a(22,"\u767C\u7968\u6578"),r(),i(23,"th",14),a(24,"\u7E3D\u91D1\u984D"),r(),i(25,"th"),a(26,"\u7C3D\u6838\u72C0\u614B"),r(),i(27,"th",15),a(28,"\u5EFA\u7ACB\u6642\u9593"),r(),i(29,"th",14),a(30,"\u64CD\u4F5C"),r()()(),i(31,"tbody"),L(32,So,22,17,"tr",null,bo,!1,Co,3,0,"tr"),r()()(),p(35,Fo,19,13,"div",16),r()()()),e&2&&(l(32),P(o.pagedRequests()),l(3),c(o.totalPages()>1?35:-1))},dependencies:[q,Pe,be],encapsulation:2})};function To(n,t){if(t<=9)return Array.from({length:t},(s,v)=>v+1);let e=[],o=0;for(let s=1;s<=t;s++)(s===1||s===t||s>=n-2&&s<=n+2)&&(o&&s-o>1&&e.push(-1),e.push(s),o=s);return e}var kt=mr(nr());function rl(n,t){if(n&1){let e=D();pe(0,"button",19),st("click",function(){E(e);let s=m();return y(s.zoomOut())}),u(),pe(1,"svg",9),$e(2,"use",20),Te()(),S(),pe(3,"span",21),a(4),Te(),pe(5,"button",22),st("click",function(){E(e);let s=m();return y(s.zoomIn())}),u(),pe(6,"svg",9),$e(7,"use",23),Te()(),S(),$e(8,"div",11)}if(n&2){let e=m();l(4),C(" ",e.zoomPercent(),"% ")}}function al(n,t){if(n&1&&(pe(0,"div",16),$e(1,"img",24),Te()),n&2){let e=m();l(),Ji("transform","scale("+e.zoomLevel()+")"),Ct("src",e.file().url,ot)("alt",e.file().name)}}function ol(n,t){if(n&1&&$e(0,"iframe",17),n&2){let e=m();Ct("src",e.file().safeUrl,zi)}}function ll(n,t){if(n&1&&(pe(0,"div",18)(1,"div",25),u(),pe(2,"svg",26),$e(3,"use",27),Te(),S(),pe(4,"p",28),a(5,"\u6B64\u6A94\u6848\u985E\u578B\u7121\u6CD5\u9810\u89BD"),Te(),pe(6,"a",29),u(),pe(7,"svg",5),$e(8,"use",10),Te(),a(9," \u4E0B\u8F09\u6A94\u6848 "),Te()()()),n&2){let e=m();l(6),Ct("href",e.file().url,ot)("download",e.file().name)}}var pt=class n{file=tn.required();closed=en();zoomLevel=j(1);zoomPercent=N(()=>Math.round(this.zoomLevel()*100));isImage=N(()=>/\.(jpe?g|png|gif|webp|bmp)$/i.test(this.file().name));isPdf=N(()=>/\.pdf$/i.test(this.file().name));typeIcon=N(()=>this.isImage()?"image":this.isPdf()?"file-text":"file");typeLabel=N(()=>this.isImage()?"\u5716\u7247":this.isPdf()?"PDF":"\u6A94\u6848");typeBadgeClass=N(()=>this.isImage()?"file-preview-badge-image":this.isPdf()?"file-preview-badge-pdf":"file-preview-badge-file");zoomIn(){this.zoomLevel.update(t=>Math.min(t+.25,3))}zoomOut(){this.zoomLevel.update(t=>Math.max(t-.25,.25))}onEscape(){this.closed.emit()}onPlus(){this.isImage()&&this.zoomIn()}onMinus(){this.isImage()&&this.zoomOut()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-file-preview-modal"]],hostBindings:function(e,o){e&1&&b("keydown.escape",function(){return o.onEscape()},qt)("keydown.+",function(){return o.onPlus()},qt)("keydown.-",function(){return o.onMinus()},qt)},inputs:{file:[1,"file"]},outputs:{closed:"closed"},decls:23,vars:9,consts:[[1,"file-preview-backdrop",3,"click"],[1,"file-preview-container",3,"click"],[1,"file-preview-toolbar"],[1,"flex","items-center","gap-3","min-w-0"],[1,"file-preview-type-badge"],[2,"width","14px","height","14px","stroke","currentColor","fill","none","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"file-preview-filename"],[1,"flex","items-center","gap-1"],["title","\u4E0B\u8F09\u6A94\u6848",1,"file-preview-btn",3,"href","download"],[2,"width","16px","height","16px","stroke","currentColor","fill","none","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["href","/assets/icons/sprite.svg#download"],[1,"file-preview-divider"],["title","\u95DC\u9589 (Esc)",1,"file-preview-btn","file-preview-btn-close",3,"click"],[2,"width","18px","height","18px","stroke","currentColor","fill","none","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["href","/assets/icons/sprite.svg#x"],[1,"file-preview-viewer"],[1,"file-preview-image-wrap"],[1,"file-preview-pdf",3,"src"],[1,"file-preview-fallback"],["title","\u7E2E\u5C0F (-)",1,"file-preview-btn",3,"click"],["href","/assets/icons/sprite.svg#zoom-out"],[1,"file-preview-zoom-label"],["title","\u653E\u5927 (+)",1,"file-preview-btn",3,"click"],["href","/assets/icons/sprite.svg#zoom-in"],["draggable","false",1,"file-preview-image",3,"src","alt"],[1,"file-preview-fallback-card"],[2,"width","48px","height","48px","stroke","currentColor","fill","none","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round","opacity","0.4"],["href","/assets/icons/sprite.svg#file"],[1,"file-preview-fallback-text"],[1,"btn","btn-sm","btn-primary","inline-flex","items-center","gap-2",3,"href","download"]],template:function(e,o){e&1&&(pe(0,"div",0),st("click",function(){return o.closed.emit()}),pe(1,"div",1),st("click",function(v){return v.stopPropagation()}),pe(2,"div",2)(3,"div",3)(4,"span",4),u(),pe(5,"svg",5),$e(6,"use"),Te(),a(7),Te(),S(),pe(8,"span",6),a(9),Te()(),pe(10,"div",7),p(11,rl,9,1),pe(12,"a",8),u(),pe(13,"svg",9),$e(14,"use",10),Te()(),S(),$e(15,"div",11),pe(16,"button",12),st("click",function(){return o.closed.emit()}),u(),pe(17,"svg",13),$e(18,"use",14),Te()()()(),S(),pe(19,"div",15),p(20,al,2,4,"div",16)(21,ol,1,1,"iframe",17)(22,ll,10,2,"div",18),Te()()()),e&2&&(l(4),J(o.typeBadgeClass()),l(2),lt("href","/assets/icons/sprite.svg#"+o.typeIcon()),l(),C(" ",o.typeLabel()," "),l(2),f(o.file().name),l(2),c(o.isImage()?11:-1),l(),Ct("href",o.file().url,ot)("download",o.file().name),l(8),c(o.isImage()?20:o.isPdf()?21:22))},encapsulation:2})};function sl(n,t){let e;return(e=t.get("id"))==null?null:e.value}var ml=(n,t)=>t.id;function dl(n,t){if(n&1&&(i(0,"div",6),u(),i(1,"svg",41),d(2,"use",42),r(),a(3),r()),n&2){let e=m();l(3),C(" ",e.errorMsg()," ")}}function ul(n,t){n&1&&(i(0,"div",7)(1,"div",43),u(),i(2,"svg",41),d(3,"use",44),r(),a(4," \u6B64\u7533\u8ACB\u5BE9\u6838\u4E2D\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function pl(n,t){n&1&&(i(0,"div",7)(1,"div",45),u(),i(2,"svg",41),d(3,"use",42),r(),a(4," \u6B64\u7533\u8ACB\u5DF2\u88AB\u9000\u56DE\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function cl(n,t){n&1&&(i(0,"div",7)(1,"div",46),u(),i(2,"svg",41),d(3,"use",47),r(),a(4," \u6B64\u7533\u8ACB\u5DF2\u6838\u51C6\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function vl(n,t){n&1&&(i(0,"div",7)(1,"div",48),u(),i(2,"svg",41),d(3,"use",49),r(),a(4," \u6B64\u7533\u8ACB\u5DF2\u88AB\u62D2\u7D55\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function fl(n,t){if(n&1&&(i(0,"p",27),a(1),r()),n&2){let e=m();l(),f(e.projectCode||"\u2014")}}function gl(n,t){if(n&1&&(i(0,"option",51),a(1),r()),n&2){let e=t.$implicit;h("ngValue",e.id),l(),Y("",e.code,"",e.departmentName?"\uFF08"+e.departmentName+"\uFF09":"")}}function _l(n,t){n&1&&(i(0,"div",52),a(1,"\u8ACB\u9078\u64C7\u5C08\u6848\u3002"),r())}function bl(n,t){if(n&1&&(i(0,"select",50)(1,"option",51),a(2),r(),L(3,gl,2,3,"option",51,ml),r(),p(5,_l,2,0,"div",52)),n&2){let e,o=m();l(),h("ngValue",null),l(),f(o.loadingProjects?"\u8F09\u5165\u4E2D\u2026":"\u2014 \u8ACB\u9078\u64C7\u5C08\u6848 \u2014"),l(),P(o.projects),l(2),c((e=o.form.get("projectId"))!=null&&e.invalid&&((e=o.form.get("projectId"))!=null&&e.touched)?5:-1)}}function xl(n,t){if(n&1&&(i(0,"div",5)(1,"label",17),a(2,"\u7C3D\u6838\u72C0\u614B"),r(),i(3,"div")(4,"span",53),a(5),r()()()),n&2){let e=m();l(4),J(e.statusClass[e.approvalStatus]),l(),C(" ",e.statusLabel[e.approvalStatus]," ")}}function hl(n,t){n&1&&(i(0,"div",60),a(1,"\u8ACB\u81F3\u5C11\u4E0A\u50B3\u4E00\u5F35\u767C\u7968\u3002"),r())}function Sl(n,t){if(n&1){let e=D();i(0,"label",54),u(),i(1,"svg",55),d(2,"use",56),r(),S(),i(3,"span",57),a(4,"\u9EDE\u64CA\u4E0A\u50B3\u767C\u7968\u5716\u6A94"),r(),i(5,"span",58),a(6,"\u652F\u63F4 JPG\u3001PNG\u3001PDF\uFF0C\u53EF\u591A\u9078"),r(),i(7,"input",59),b("change",function(s){E(e);let v=m();return y(v.onFilesSelected(s))}),r()(),p(8,hl,2,0,"div",60)}if(n&2){let e=m();l(8),c(e.showInvoiceError?8:-1)}}function Cl(n,t){n&1&&d(0,"th",35)}function El(n,t){if(n&1){let e=D();i(0,"button",72),b("click",function(){let s;E(e);let v=m().$implicit,F=m();return y(F.openPreview((s=v.get("fileName"))==null?null:s.value,((s=v.get("previewUrl"))==null?null:s.value)||((s=v.get("fileUrl"))==null?null:s.value)))}),u(),i(1,"svg",73),d(2,"use",29),r(),a(3),r()}if(n&2){let e,o=m().$implicit;l(3),C(" ",(e=o.get("fileName"))==null?null:e.value," ")}}function yl(n,t){if(n&1&&(i(0,"span",63),u(),i(1,"svg",73),d(2,"use",29),r(),a(3),r()),n&2){let e,o=m().$implicit;l(3),C(" ",(e=o.get("fileName"))==null?null:e.value," ")}}function Al(n,t){if(n&1&&(i(0,"span",65),a(1),r()),n&2){let e,o=m().$implicit;l(),f(((e=o.get("invoiceNo"))==null?null:e.value)||"\u2014")}}function Fl(n,t){n&1&&(i(0,"div",66),d(1,"span",74),a(2," \u8B58\u5225\u4E2D\u2026 "),r())}function Tl(n,t){n&1&&d(0,"input",67)}function wl(n,t){if(n&1&&(i(0,"span",68),a(1),I(2,"number"),r()),n&2){let e,o=m().$implicit;l(),f(O(2,1,(e=o.get("amount"))==null?null:e.value,"1.0-0"))}}function Dl(n,t){n&1&&(i(0,"div",69),a(1,"\u2014"),r())}function kl(n,t){n&1&&d(0,"input",70)}function Ll(n,t){if(n&1){let e=D();i(0,"td",71)(1,"button",75),b("click",function(){E(e);let s=m().$index,v=m();return y(v.removeInvoice(s))}),u(),i(2,"svg",41),d(3,"use",76),r()()()}if(n&2){m();let e=Ki(0);l(),h("disabled",e)}}function Pl(n,t){if(n&1&&(Yi(0),i(1,"tr",37)(2,"td",61),p(3,El,4,1,"button",62)(4,yl,4,1,"span",63),r(),i(5,"td",64),p(6,Al,2,1,"span",65)(7,Fl,3,0,"div",66)(8,Tl,1,0,"input",67),r(),i(9,"td",64),p(10,wl,3,4,"span",68)(11,Dl,2,0,"div",69)(12,kl,1,0,"input",70),r(),p(13,Ll,4,1,"td",71),r()),n&2){let e,o,s=t.$implicit,v=t.$index,F=m(),R=Wi(F.ocrLoadingIds.has((e=s.get("id"))==null?null:e.value));l(),h("formGroupName",v),l(2),c((o=s.get("previewUrl"))!=null&&o.value||(o=s.get("fileUrl"))!=null&&o.value?3:4),l(3),c(F.isReadOnly?6:R?7:8),l(4),c(F.isReadOnly?10:R?11:12),l(3),c(F.isReadOnly?-1:13)}}function Il(n,t){if(n&1&&(i(0,"tr")(1,"td",77),a(2,"\u5C1A\u672A\u65B0\u589E\u767C\u7968"),r()()),n&2){let e=m();l(),lt("colspan",e.isReadOnly?3:4)}}function Rl(n,t){n&1&&d(0,"td")}function Bl(n,t){if(n&1&&(i(0,"tfoot")(1,"tr",32)(2,"td",78),a(3,"\u5408\u8A08"),r(),i(4,"td",79),a(5),I(6,"number"),r(),p(7,Rl,1,0,"td"),r()()),n&2){let e=m();l(5),f(O(6,2,e.totalAmount,"1.0-0")),l(2),c(e.isReadOnly?-1:7)}}function Ml(n,t){n&1&&d(0,"span",81)}function jl(n,t){if(n&1){let e=D();i(0,"div",38)(1,"button",80),p(2,Ml,1,0,"span",81),a(3),r(),i(4,"button",82),b("click",function(){E(e);let s=m();return y(s.submitForApproval())}),a(5," \u9001\u51FA\u7533\u8ACB "),r(),i(6,"a",83),a(7,"\u53D6\u6D88"),r()()}if(n&2){let e=m();l(),h("disabled",e.form.invalid||e.isAnyOcrPending),l(),c(e.isAnyOcrPending?2:-1),l(),C(" ",e.isEdit?"\u5132\u5B58":"\u5132\u5B58\u8349\u7A3F"," "),l(),h("disabled",e.form.invalid||e.isAnyOcrPending)}}function Vl(n,t){n&1&&(i(0,"div",39)(1,"a",83),a(2,"\u8FD4\u56DE\u5217\u8868"),r()())}function Nl(n,t){if(n&1){let e=D();i(0,"app-file-preview-modal",84),b("closed",function(){E(e);let s=m();return y(s.closePreview())}),r()}if(n&2){let e=m();h("file",e.previewFile)}}var Lt=class n{fb=g(ie);service=g(ut);projects$=g(Ue);route=g(me);router=g(de);cdr=g(Ze);sanitizer=g(Gt);projects=[];isEdit=!1;isReturned=!1;isReadOnly=!1;requestId=0;showInvoiceError=!1;errorMsg=j("");approvalStatus="draft";isDraft=!0;projectCode="";fileMap=new Map;ocrLoadingIds=new Set;get isAnyOcrPending(){return this.ocrLoadingIds.size>0}previewFile=null;openPreview(t,e){this.previewFile={name:t,url:e,safeUrl:this.sanitizer.bypassSecurityTrustResourceUrl(e)}}closePreview(){this.previewFile=null}statusLabel=ni;statusClass=ri;form=this.fb.group({type:["vendor",w.required],projectId:[null,w.required],invoices:this.fb.array([])});get invoiceArray(){return this.form.get("invoices")}get invoiceControls(){return this.invoiceArray.controls}get totalAmount(){return this.invoiceArray.controls.reduce((t,e)=>t+(+e.get("amount")?.value||0),0)}loadingProjects=!0;ngOnInit(){this.projects$.getAll().subscribe({next:e=>{this.projects=e.filter(o=>o.status==="active"),this.loadingProjects=!1,this.cdr.markForCheck()},error:()=>{this.loadingProjects=!1,this.errorMsg.set("\u8F09\u5165\u5C08\u6848\u8CC7\u6599\u5931\u6557\u3002")}});let t=this.route.snapshot.paramMap.get("id");t&&(this.isEdit=!0,this.requestId=+t,this.service.getById(this.requestId).subscribe(e=>{e&&(this.approvalStatus=e.approvalStatus,this.isDraft=e.approvalStatus==="draft",this.isReturned=e.approvalStatus==="returned",this.isReadOnly=e.approvalStatus!=="draft",this.projectCode=e.projectCode??"",this.isReadOnly&&this.form.disable(),this.form.patchValue({type:e.type,projectId:e.projectId}),e.invoices.forEach(o=>this.invoiceArray.push(this._invoiceGroup(String(o.id),o.fileName,o.invoiceNo,o.amount,o.fileUrl??"",o.fileUrl??""))),this.cdr.markForCheck())}))}async onFilesSelected(t){let e=t.target;if(!e.files?.length)return;let o=Array.from(e.files);e.value="",this.showInvoiceError=!1;let s=o.map(R=>{let B=`${Date.now()}-${Math.random().toString(36).slice(2)}`,z=URL.createObjectURL(R);return this.ocrLoadingIds.add(B),this.fileMap.set(B,R),this.invoiceArray.push(this._invoiceGroup(B,R.name,"",0,z)),{id:B,file:R}}),[v,F]=await Promise.all([(0,kt.createWorker)(["eng","chi_tra"]),(0,kt.createWorker)(["eng","chi_tra"])]);await F.setParameters({tessedit_pageseg_mode:kt.PSM.SPARSE_TEXT});try{for(let{id:R,file:B}of s)try{let[{data:{text:z}},{data:{text:Oe}}]=await Promise.all([v.recognize(B),F.recognize(B)]);console.log("[OCR AUTO]",z),console.log("[OCR SPARSE]",Oe);let re=this._extractInvoiceData(z),ge=this._extractInvoiceData(Oe),qe=re.invoiceNo||ge.invoiceNo,He=re.amount||ge.amount,Se=this.invoiceArray.controls.findIndex(ae=>ae.get("id")?.value===R);Se>=0&&this.invoiceArray.controls[Se].patchValue({invoiceNo:qe,amount:He})}catch{}finally{this.ocrLoadingIds.delete(R),this.cdr.markForCheck()}}finally{await Promise.all([v.terminate(),F.terminate()])}}removeInvoice(t){let e=this.invoiceArray.at(t),o=e.get("id")?.value,s=e.get("previewUrl")?.value;s?.startsWith("blob:")&&URL.revokeObjectURL(s),this.fileMap.delete(o),this.invoiceArray.removeAt(t)}save(){if(this.form.invalid)return;if(this.invoiceArray.length===0){this.showInvoiceError=!0;return}this.showInvoiceError=!1;let t=this._buildFormData(),e=this.isEdit?this.service.updateWithFiles(this.requestId,t):this.service.createWithFiles(t);this.errorMsg.set(""),e.subscribe({next:o=>{this.isEdit||(this.requestId=o.id),this.router.navigate(["/admin/payment-requests"])},error:o=>{this.errorMsg.set(o.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}submitForApproval(){if(this.form.invalid)return;if(this.invoiceArray.length===0){this.showInvoiceError=!0;return}this.showInvoiceError=!1;let t=this._buildFormData(),e=this.isEdit?this.service.updateWithFiles(this.requestId,t):this.service.createWithFiles(t);this.errorMsg.set(""),e.subscribe({next:o=>{this.service.submit(o.id).subscribe({next:()=>this.router.navigate(["/admin/payment-requests"]),error:s=>{this.errorMsg.set(s.error?.message||"\u9001\u51FA\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})},error:o=>{this.errorMsg.set(o.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}_buildFormData(){let t=new FormData;t.append("type",this.form.get("type").value),t.append("projectId",String(this.form.get("projectId").value));let e=[],o=0;for(let s of this.invoiceArray.controls){let v=s.get("id")?.value,F=this.fileMap.get(v),R={fileName:s.get("fileName")?.value,invoiceNo:s.get("invoiceNo")?.value,amount:+(s.get("amount")?.value||0),fileUrl:s.get("fileUrl")?.value||null,fileIndex:F?o:-1};F&&(t.append("files",F,F.name),o++),e.push(R)}return t.append("invoices",JSON.stringify(e)),t}_invoiceGroup(t,e,o,s,v="",F=""){return this.fb.group({id:[t],fileName:[e],invoiceNo:[o,w.required],amount:[s,[w.required,w.min(0)]],previewUrl:[v],fileUrl:[F]})}_extractInvoiceData(t){let e=t.match(/[A-Z]{2}[-\s]?\d{8}/),o="";e&&(o=e[0].replace(/[-\s]/g,""));let s=[/(?:|||||)[^0-9]{0,20}([\d,]+)/,/(?:\s*|\s*|\s*\s*|\s*\s*\s*|\s*\s*\s*|\s*)[^0-9]{0,20}([\d,]+)/,/[^0-9]{0,10}([\d,]+)/,/\s*[^0-9]{0,10}([\d,]+)/,/(?:Amount|Total)[^0-9]{0,10}([\d,]+)/i,/NT\$\s*([\d,]+)/,/\$\s*([\d,]+)/],v=0;for(let F of s){let R=t.match(F);if(R){v=parseInt(R[1].replace(/,/g,""),10);break}}return{invoiceNo:o,amount:v}}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-payment-form"]],decls:73,vars:12,consts:[[1,"container-fluid","py-3"],[1,"flex","items-center","gap-2","mb-6"],["routerLink","/admin/payment-requests",1,"btn","btn-sm","btn-outline-secondary"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],[1,"card","border-0","shadow-sm","mb-6"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-lg-10","col-xl-8"],[1,"card","border-0","shadow-sm"],[1,"card-header","bg-transparent","border-bottom","flex","items-center","gap-2","fw-600"],[1,"sa-icon","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#dollar-sign"],[1,"card-body"],[1,"mb-4"],[1,"form-label","fw-500"],[1,"text-danger"],[1,"flex","flex-wrap","gap-4","mt-1"],[1,"form-check"],["type","radio","formControlName","type","value","vendor","id","typeVendor",1,"form-check-input"],["for","typeVendor",1,"form-check-label"],["type","radio","formControlName","type","value","travel","id","typeTravel",1,"form-check-input"],["for","typeTravel",1,"form-check-label"],["type","radio","formControlName","type","value","advance","id","typeAdvance",1,"form-check-input"],["for","typeAdvance",1,"form-check-label"],[1,"form-control-plaintext","fw-500","font-monospace","mb-0"],[1,"card","border-0","shadow-sm","mt-6"],["href","/assets/icons/sprite.svg#file-text"],[1,"table-responsive"],[1,"table","table-sm","mb-0"],[1,"table-light"],[2,"min-width","160px"],[2,"min-width","120px"],[2,"width","48px"],["formArrayName","invoices"],[3,"formGroupName"],[1,"mt-6","flex","gap-2"],[1,"mt-6"],[3,"file"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#alert-triangle"],[1,"card-header","bg-[rgba(13,110,253,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-primary","py-3"],["href","/assets/icons/sprite.svg#clock"],[1,"card-header","bg-[rgba(255,193,7,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-warning","py-3"],[1,"card-header","bg-[rgba(37,162,68,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-success","py-3"],["href","/assets/icons/sprite.svg#check-circle"],[1,"card-header","bg-[rgba(220,53,69,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-danger","py-3"],["href","/assets/icons/sprite.svg#x-circle"],["formControlName","projectId",1,"form-select"],[3,"ngValue"],[1,"text-danger","small","mt-1"],[1,"badge","rounded-pill","px-3","py-2"],[1,"flex","flex-col","items-center","justify-center","rounded-3","py-4","px-4","mb-4","text-center",2,"cursor","pointer","border","2px dashed var(--bs-border-color)"],[1,"sa-icon","sa-icon-2x","text-muted","mb-2",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#upload"],[1,"fw-500"],[1,"text-muted","small","mt-1"],["type","file","multiple","","accept","image/*,application/pdf",1,"hidden",3,"change"],[1,"alert","alert-warning","py-2","small","mb-4"],[1,"align-middle","small",2,"max-width","200px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap"],["type","button",1,"btn","btn-link","p-0","text-muted","small","inline-flex","items-center","gap-1",2,"text-decoration","none","max-width","100%","overflow","hidden","text-overflow","ellipsis"],[1,"text-muted","inline-flex","items-center","gap-1"],[1,"align-middle"],[1,"font-monospace","small"],[1,"flex","items-center","gap-2","text-muted","small","py-1"],["formControlName","invoiceNo","placeholder","AB12345678",1,"form-control","form-control-sm","font-monospace"],[1,"small"],[1,"py-1"],["type","number","formControlName","amount","min","0","placeholder","0",1,"form-control","form-control-sm"],[1,"text-right","align-middle"],["type","button",1,"btn","btn-link","p-0","text-muted","small","inline-flex","items-center","gap-1",2,"text-decoration","none","max-width","100%","overflow","hidden","text-overflow","ellipsis",3,"click"],[1,"sa-icon","shrink-0",2,"width","14px","height","14px","stroke","currentColor"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["type","button",1,"btn","btn-sm","btn-ghost-danger","inline-flex","items-center",3,"click","disabled"],["href","/assets/icons/sprite.svg#x"],[1,"text-center","text-muted","py-4","small"],["colspan","2",1,"text-right","fw-500","small"],[1,"fw-600"],["type","submit",1,"btn","btn-outline-secondary",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-1"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["routerLink","/admin/payment-requests",1,"btn","btn-outline-secondary"],[3,"closed","file"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"a",2),u(),i(3,"svg",3),d(4,"use",4),r()(),S(),i(5,"h4",5),a(6),r()(),p(7,dl,4,1,"div",6),p(8,ul,5,0,"div",7)(9,pl,5,0,"div",7)(10,cl,5,0,"div",7)(11,vl,5,0,"div",7),i(12,"form",8),b("ngSubmit",function(){return o.save()}),i(13,"div",9)(14,"div",10)(15,"div",11)(16,"div",12),u(),i(17,"svg",13),d(18,"use",14),r(),a(19," \u57FA\u672C\u8CC7\u8A0A "),r(),S(),i(20,"div",15)(21,"div",16)(22,"label",17),a(23,"\u8ACB\u6B3E\u985E\u578B "),i(24,"span",18),a(25,"*"),r()(),i(26,"div",19)(27,"div",20),d(28,"input",21),i(29,"label",22),a(30,"\u5EE0\u5546\u8ACB\u6B3E"),r()(),i(31,"div",20),d(32,"input",23),i(33,"label",24),a(34,"\u54E1\u5DE5\u5DEE\u65C5"),r()(),i(35,"div",20),d(36,"input",25),i(37,"label",26),a(38,"\u54E1\u5DE5\u9810\u652F"),r()()()(),i(39,"div",16)(40,"label",17),a(41,"\u5C08\u6848 "),i(42,"span",18),a(43,"*"),r()(),p(44,fl,2,1,"p",27)(45,bl,6,3),r(),p(46,xl,6,3,"div",5),r()(),i(47,"div",28)(48,"div",12),u(),i(49,"svg",13),d(50,"use",29),r(),a(51," \u767C\u7968 "),r(),S(),i(52,"div",15),p(53,Sl,9,1),i(54,"div",30)(55,"table",31)(56,"thead",32)(57,"tr")(58,"th"),a(59,"\u6A94\u6848\u540D\u7A31"),r(),i(60,"th",33),a(61,"\u767C\u7968\u865F\u78BC"),r(),i(62,"th",34),a(63,"\u91D1\u984D"),r(),p(64,Cl,1,0,"th",35),r()(),i(65,"tbody",36),L(66,Pl,14,6,"tr",37,sl,!1,Il,3,1,"tr"),r(),p(69,Bl,8,5,"tfoot"),r()()()(),p(70,jl,8,4,"div",38)(71,Vl,3,0,"div",39),r()()()(),p(72,Nl,1,1,"app-file-preview-modal",40)),e&2&&(l(6),f(o.isEdit?o.isReadOnly?"\u6AA2\u8996\u8ACB\u6B3E\u7533\u8ACB":"\u7DE8\u8F2F\u8ACB\u6B3E\u8349\u7A3F":"\u65B0\u589E\u8ACB\u6B3E\u7533\u8ACB"),l(),c(o.errorMsg()?7:-1),l(),c(o.isReadOnly&&o.approvalStatus==="pending"?8:o.isReadOnly&&o.approvalStatus==="returned"?9:o.isReadOnly&&o.approvalStatus==="approved"?10:o.isReadOnly&&o.approvalStatus==="rejected"?11:-1),l(4),h("formGroup",o.form),l(32),c(o.isReadOnly?44:45),l(2),c(o.isEdit?46:-1),l(7),c(o.isReadOnly?-1:53),l(11),c(o.isReadOnly?-1:64),l(2),P(o.invoiceControls),l(3),c(o.invoiceControls.length>0?69:-1),l(),c(o.isReadOnly?71:70),l(2),c(o.previewFile?72:-1))},dependencies:[ne,X,Re,Be,K,xe,Ie,Qe,Z,Q,he,te,ee,an,on,q,pt,Pe],encapsulation:2})};var mi={pending:"\u5F85\u5BE9\u6838",approved:"\u5DF2\u6838\u51C6",rejected:"\u5DF2\u62D2\u7D55",returned:"\u9000\u56DE\u4FEE\u6539"},di={pending:"bg-warning-subtle text-warning-emphasis",approved:"bg-success-subtle text-success",rejected:"bg-danger-subtle text-danger",returned:"bg-secondary-subtle text-secondary"},ui={vendor:"\u5EE0\u5546\u8ACB\u6B3E",travel:"\u54E1\u5DE5\u5DEE\u65C5",advance:"\u54E1\u5DE5\u9810\u652F"},pi={annual:"\u5E74\u5047",personal:"\u4E8B\u5047",sick:"\u75C5\u5047",compensatory:"\u88DC\u4F11"};var Ol=(n,t)=>[n,t,"review"],ql=(n,t)=>t.applicationType+t.id;function $l(n,t){if(n&1&&(i(0,"tr")(1,"td")(2,"span"),a(3),r()(),i(4,"td",14),a(5),r(),i(6,"td",15),a(7),r(),i(8,"td")(9,"span"),a(10),r()(),i(11,"td",16),a(12),I(13,"date"),r(),i(14,"td",17)(15,"a",18),u(),i(16,"svg",19),d(17,"use"),r()()()()),n&2){let e=t.$implicit,o=m();l(2),J("badge "+o.appTypeClass[e.applicationType]),l(),C(" ",o.appTypeLabel[e.applicationType]," "),l(2),f(e.submittedBy),l(2),f(o.getSummary(e)),l(2),J("badge "+o.statusClass[e.status]),l(),f(o.statusLabel[e.status]),l(2),f(O(13,13,e.submittedAt,"yyyy-MM-dd")),l(3),J("btn btn-sm inline-flex items-center "+(e.status==="pending"?"btn-ghost-primary":"btn-ghost-secondary")),h("routerLink",Qi(16,Ol,e.applicationType,e.id)),l(2),lt("href",e.status==="pending"?"/assets/icons/sprite.svg#edit":"/assets/icons/sprite.svg#eye")}}function Gl(n,t){n&1&&(i(0,"tr")(1,"td",20),a(2,"\u5C1A\u7121\u7C3D\u6838\u4F5C\u696D\u3002"),r()())}function Ul(n,t){n&1&&(i(0,"li",28)(1,"span",30),a(2,"\u2026"),r()())}function Hl(n,t){if(n&1){let e=D();i(0,"li",26)(1,"button",27),b("click",function(){E(e);let s=m().$implicit,v=m(2);return y(v.goTo(s))}),a(2),r()()}if(n&2){let e=m().$implicit,o=m(2);$("active",e===o.page()),l(2),f(e)}}function zl(n,t){if(n&1&&p(0,Ul,3,0,"li",28)(1,Hl,3,3,"li",29),n&2){let e=t.$implicit;c(e===-1?0:1)}}function Jl(n,t){if(n&1){let e=D();i(0,"div",13)(1,"span",21),a(2),r(),i(3,"div",22)(4,"button",23),b("click",function(){E(e);let s=m();return y(s.prev())}),a(5,"\u2039"),r(),i(6,"span",24),a(7),r(),i(8,"button",23),b("click",function(){E(e);let s=m();return y(s.next())}),a(9,"\u203A"),r()(),i(10,"ul",25)(11,"li",26)(12,"button",27),b("click",function(){E(e);let s=m();return y(s.prev())}),a(13,"\u2039"),r()(),L(14,zl,2,1,null,null,_e),i(16,"li",26)(17,"button",27),b("click",function(){E(e);let s=m();return y(s.next())}),a(18,"\u203A"),r()()()()}if(n&2){let e=m();l(2),ke("\u5171 ",e.totalCount()," \u7B46\uFF0C\u7B2C ",e.page()," / ",e.totalPages()," \u9801"),l(2),$("disabled",e.page()===1),l(3),Y("",e.page()," / ",e.totalPages()),l(),$("disabled",e.page()===e.totalPages()),l(3),$("disabled",e.page()===1),l(3),P(e.pageNumbers()),l(2),$("disabled",e.page()===e.totalPages())}}var ci=class n{service=g(Ut);PAGE_SIZE=20;page=j(1);result=we(Me(this.page).pipe(se(t=>this.service.getPaged(t,this.PAGE_SIZE))),{initialValue:{items:[],totalCount:0,page:1,pageSize:20,totalPages:1}});pagedTasks=N(()=>this.result().items);totalCount=N(()=>this.result().totalCount);totalPages=N(()=>this.result().totalPages);pageNumbers=N(()=>Yl(this.page(),this.totalPages()));goTo(t){this.page.set(t)}prev(){this.page()>1&&this.page.update(t=>t-1)}next(){this.page()<this.totalPages()&&this.page.update(t=>t+1)}statusLabel=mi;statusClass=di;appTypeLabel=it;appTypeClass=nt;payTypeLabel=ui;leaveTypeLabel=pi;getSummary(t){return t.paymentDetail?`${this.payTypeLabel[t.paymentDetail.paymentType]}\u30FB${t.paymentDetail.projectCode}\uFF08${t.paymentDetail.totalAmount.toLocaleString()} \u5143\uFF09`:t.leaveDetail?`${this.leaveTypeLabel[t.leaveDetail.leaveType]}\u30FB${t.leaveDetail.days} \u5929`:t.travelDetail?`${t.travelDetail.destination}\uFF08${t.travelDetail.estimatedCost.toLocaleString()} \u5143\uFF09`:t.overtimeDetail?`${new Date(t.overtimeDetail.overtimeDate).toLocaleDateString("zh-TW")}\u30FB${t.overtimeDetail.estimatedHours} \u5C0F\u6642\u30FB${t.overtimeDetail.reason}`:"\u2014"}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-approval-task-list"]],decls:29,vars:2,consts:[[1,"container-fluid","py-3"],[1,"flex","items-center","gap-2","mb-6"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#check-square"],[1,"mb-0"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"hidden","md:table-cell"],[1,"hidden","lg:table-cell"],[1,"text-right"],[1,"flex","flex-col","gap-2","sm:flex-row","sm:items-center","sm:justify-between","px-4","py-3","border-t"],[1,"fw-500"],[1,"text-muted","small","hidden","md:table-cell"],[1,"text-muted","small","hidden","lg:table-cell"],[1,"text-right",2,"white-space","nowrap"],[3,"routerLink"],[1,"sa-icon",2,"stroke","currentColor"],["colspan","6",1,"text-center","text-muted","py-4"],[1,"text-muted","small","text-center","sm:text-left"],[1,"flex","sm:hidden","items-center","gap-1"],[1,"page-link","rounded",3,"click"],[1,"px-2","text-sm"],[1,"hidden","sm:flex","pagination","mb-0"],[1,"page-item"],[1,"page-link",3,"click"],[1,"page-item","disabled"],[1,"page-item",3,"active"],[1,"page-link"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1),u(),i(2,"svg",2),d(3,"use",3),r(),S(),i(4,"h4",4),a(5,"\u7C3D\u6838\u4F5C\u696D"),r()(),i(6,"div",5)(7,"div",6)(8,"div",7)(9,"table",8)(10,"thead",9)(11,"tr")(12,"th"),a(13,"\u985E\u578B"),r(),i(14,"th"),a(15,"\u7533\u8ACB\u4EBA"),r(),i(16,"th",10),a(17,"\u6458\u8981"),r(),i(18,"th"),a(19,"\u72C0\u614B"),r(),i(20,"th",11),a(21,"\u7533\u8ACB\u6642\u9593"),r(),i(22,"th",12),a(23,"\u64CD\u4F5C"),r()()(),i(24,"tbody"),L(25,$l,18,19,"tr",null,ql,!1,Gl,3,0,"tr"),r()()(),p(28,Jl,19,13,"div",13),r()()()),e&2&&(l(25),P(o.pagedTasks()),l(3),c(o.totalPages()>1?28:-1))},dependencies:[q,be],encapsulation:2})};function Yl(n,t){if(t<=9)return Array.from({length:t},(s,v)=>v+1);let e=[],o=0;for(let s=1;s<=t;s++)(s===1||s===t||s>=n-2&&s<=n+2)&&(o&&s-o>1&&e.push(-1),e.push(s),o=s);return e}var Wl=(n,t)=>t.id,Kl=(n,t)=>t.stepOrder;function Zl(n,t){if(n&1&&(i(0,"div",10),u(),i(1,"svg",14),d(2,"use",15),r(),a(3),r()),n&2){let e=m(2);l(3),C(" ",e.errorMsg()," ")}}function Ql(n,t){if(n&1){let e=D();i(0,"button",41),b("click",function(){E(e);let s=m().$implicit,v=m(4);return y(v.openPreview(s.fileName,s.previewUrl))}),u(),i(1,"svg",42),d(2,"use",28),r(),a(3),r()}if(n&2){let e=m().$implicit;l(3),C(" ",e.fileName," ")}}function Xl(n,t){if(n&1&&(i(0,"span",38),u(),i(1,"svg",42),d(2,"use",28),r(),a(3),r()),n&2){let e=m().$implicit;l(3),C(" ",e.fileName," ")}}function es(n,t){if(n&1&&(i(0,"tr")(1,"td",36),p(2,Ql,4,1,"button",37)(3,Xl,4,1,"span",38),r(),i(4,"td",39),a(5),r(),i(6,"td",40),a(7),I(8,"number"),r()()),n&2){let e=t.$implicit;l(2),c(e.previewUrl?2:3),l(3),f(e.invoiceNo),l(2),f(O(8,3,e.amount,"1.0-0"))}}function ts(n,t){if(n&1&&(i(0,"div",16)(1,"div",17),u(),i(2,"svg",18),d(3,"use",19),r(),a(4," \u8ACB\u6B3E\u7533\u8ACB\u8CC7\u8A0A "),r(),S(),i(5,"div",20)(6,"div",21)(7,"div",22)(8,"div",23),a(9,"\u8ACB\u6B3E\u985E\u578B"),r(),i(10,"span",24),a(11),r()(),i(12,"div",22)(13,"div",23),a(14,"\u5C08\u6848\u7DE8\u865F"),r(),i(15,"span",25),a(16),r()(),i(17,"div",22)(18,"div",23),a(19,"\u7533\u8ACB\u4EBA"),r(),i(20,"span",24),a(21),r()(),i(22,"div",22)(23,"div",23),a(24,"\u7533\u8ACB\u6642\u9593"),r(),i(25,"span",26),a(26),I(27,"date"),r()(),i(28,"div",22)(29,"div",23),a(30,"\u7E3D\u91D1\u984D"),r(),i(31,"span",27),a(32),I(33,"number"),r()()()()(),i(34,"div",13)(35,"div",17),u(),i(36,"svg",18),d(37,"use",28),r(),a(38," \u767C\u7968\u660E\u7D30 "),r(),S(),i(39,"div",29)(40,"div",30)(41,"table",31)(42,"thead",32)(43,"tr")(44,"th"),a(45,"\u6A94\u6848\u540D\u7A31"),r(),i(46,"th"),a(47,"\u767C\u7968\u865F\u78BC"),r(),i(48,"th",33),a(49,"\u91D1\u984D"),r()()(),i(50,"tbody"),L(51,es,9,6,"tr",null,Wl),r(),i(53,"tfoot")(54,"tr",32)(55,"td",34),a(56,"\u5408\u8A08"),r(),i(57,"td",35),a(58),I(59,"number"),r()()()()()()()),n&2){let e=t,o=m(2),s=m();l(11),f(s.payTypeLabel[e.paymentType]),l(5),f(e.projectCode),l(5),f(o.submittedBy),l(5),f(O(27,6,o.submittedAt,"yyyy-MM-dd")),l(6),f(O(33,9,e.totalAmount,"1.0-0")),l(19),P(e.invoices),l(7),f(O(59,12,e.totalAmount,"1.0-0"))}}function is(n,t){if(n&1&&p(0,ts,60,15),n&2){let e,o=m();c((e=o.paymentDetail)?0:-1,e)}}function ns(n,t){if(n&1&&(i(0,"div",16)(1,"div",17),u(),i(2,"svg",18),d(3,"use",43),r(),a(4," \u8ACB\u5047\u7533\u8ACB\u8CC7\u8A0A "),r(),S(),i(5,"div",20)(6,"div",44)(7,"div",22)(8,"div",23),a(9,"\u5047\u5225"),r(),i(10,"span",24),a(11),r()(),i(12,"div",22)(13,"div",23),a(14,"\u7533\u8ACB\u4EBA"),r(),i(15,"span",24),a(16),r()(),i(17,"div",22)(18,"div",23),a(19,"\u5929\u6578"),r(),i(20,"span",27),a(21),r()(),i(22,"div",22)(23,"div",23),a(24,"\u958B\u59CB\u65E5\u671F"),r(),i(25,"span",26),a(26),I(27,"date"),r()(),i(28,"div",22)(29,"div",23),a(30,"\u7D50\u675F\u65E5\u671F"),r(),i(31,"span",26),a(32),I(33,"date"),r()(),i(34,"div",45)(35,"div",23),a(36,"\u8ACB\u5047\u539F\u56E0"),r(),i(37,"div",46),a(38),r()()()()()),n&2){let e=t,o=m(2),s=m();l(11),f(s.leaveTypeLabel[e.leaveType]),l(5),f(o.submittedBy),l(5),C("",e.days," \u5929"),l(5),f(O(27,6,e.startDate,"yyyy-MM-dd")),l(6),f(O(33,9,e.endDate,"yyyy-MM-dd")),l(6),f(e.reason)}}function rs(n,t){if(n&1&&p(0,ns,39,12,"div",16),n&2){let e,o=m();c((e=o.leaveDetail)?0:-1,e)}}function as(n,t){if(n&1&&(i(0,"div",22)(1,"div",23),a(2,"\u95DC\u806F\u5C08\u6848"),r(),i(3,"span",48),a(4),r()()),n&2){let e=m();l(4),f(e.projectCode)}}function os(n,t){if(n&1&&(i(0,"div",16)(1,"div",17),u(),i(2,"svg",18),d(3,"use",47),r(),a(4," \u51FA\u5DEE\u7533\u8ACB\u8CC7\u8A0A "),r(),S(),i(5,"div",20)(6,"div",44)(7,"div",22)(8,"div",23),a(9,"\u51FA\u5DEE\u5730\u9EDE"),r(),i(10,"span",24),a(11),r()(),i(12,"div",22)(13,"div",23),a(14,"\u7533\u8ACB\u4EBA"),r(),i(15,"span",24),a(16),r()(),i(17,"div",22)(18,"div",23),a(19,"\u9810\u4F30\u8CBB\u7528"),r(),i(20,"span",27),a(21),I(22,"number"),r()(),i(23,"div",22)(24,"div",23),a(25,"\u51FA\u767C\u65E5\u671F"),r(),i(26,"span",26),a(27),I(28,"date"),r()(),i(29,"div",22)(30,"div",23),a(31,"\u8FD4\u56DE\u65E5\u671F"),r(),i(32,"span",26),a(33),I(34,"date"),r()(),p(35,as,5,1,"div",22),i(36,"div",45)(37,"div",23),a(38,"\u51FA\u5DEE\u76EE\u7684"),r(),i(39,"div",46),a(40),r()()()()()),n&2){let e=t,o=m(2);l(11),f(e.destination),l(5),f(o.submittedBy),l(5),C("",O(22,7,e.estimatedCost,"1.0-0")," \u5143"),l(6),f(O(28,10,e.startDate,"yyyy-MM-dd")),l(6),f(O(34,13,e.endDate,"yyyy-MM-dd")),l(2),c(e.projectCode?35:-1),l(5),f(e.purpose)}}function ls(n,t){if(n&1&&p(0,os,41,16,"div",16),n&2){let e,o=m();c((e=o.travelDetail)?0:-1,e)}}function ss(n,t){if(n&1&&(i(0,"span",52),a(1),r()),n&2){let e=t.$implicit;l(),f(e)}}function ms(n,t){if(n&1&&(i(0,"div",50)(1,"div",23),a(2,"\u95DC\u806F\u5C08\u6848"),r(),i(3,"div",51),L(4,ss,2,1,"span",52,_e),r()()),n&2){let e=m();l(4),P(e.projectCodes)}}function ds(n,t){if(n&1&&(i(0,"div",16)(1,"div",17),u(),i(2,"svg",18),d(3,"use",49),r(),a(4," \u52A0\u73ED\u7533\u8ACB\u8CC7\u8A0A "),r(),S(),i(5,"div",20)(6,"div",44)(7,"div",22)(8,"div",23),a(9,"\u52A0\u73ED\u65E5\u671F"),r(),i(10,"span",24),a(11),I(12,"date"),r()(),i(13,"div",22)(14,"div",23),a(15,"\u7533\u8ACB\u4EBA"),r(),i(16,"span",24),a(17),r()(),i(18,"div",22)(19,"div",23),a(20,"\u9810\u8A08\u52A0\u73ED\u6642\u6578"),r(),i(21,"span",27),a(22),r()(),p(23,ms,6,0,"div",50),i(24,"div",45)(25,"div",23),a(26,"\u52A0\u73ED\u539F\u56E0"),r(),i(27,"div",46),a(28),r()()()()()),n&2){let e=t,o=m(2);l(11),f(O(12,5,e.overtimeDate,"yyyy-MM-dd")),l(6),f(o.submittedBy),l(5),C("",e.estimatedHours," \u5C0F\u6642"),l(),c(e.projectCodes&&e.projectCodes.length>0?23:-1),l(5),f(e.reason)}}function us(n,t){if(n&1&&p(0,ds,29,8,"div",16),n&2){let e,o=m();c((e=o.overtimeDetail)?0:-1,e)}}function ps(n,t){n&1&&(i(0,"span",62),a(1,"\u2713"),r())}function cs(n,t){n&1&&(i(0,"span",63),a(1,"\u2717"),r())}function vs(n,t){n&1&&p(0,ps,2,0,"span",62)(1,cs,2,0,"span",63),n&2&&c(t.action==="approved"?0:1)}function fs(n,t){if(n&1&&(i(0,"span",57),a(1),r()),n&2){let e=m().$implicit;l(),f(e.stepOrder)}}function gs(n,t){if(n&1&&(i(0,"span",58),a(1),r()),n&2){let e=m().$implicit;l(),f(e.stepOrder)}}function _s(n,t){if(n&1&&(i(0,"span",60),a(1),r()),n&2){let e=m().$implicit;l(),C("\uFF08",e.departmentName,"\uFF09")}}function bs(n,t){if(n&1&&(i(0,"div",26),a(1),r()),n&2){let e=m().$implicit;l(),f(e.note)}}function xs(n,t){n&1&&(i(0,"span",65),a(1,"\u5DF2\u6838\u51C6"),r())}function hs(n,t){n&1&&(i(0,"span",66),a(1,"\u9000\u56DE\u4FEE\u6539"),r())}function Ss(n,t){n&1&&(i(0,"span",67),a(1,"\u5DF2\u62D2\u7D55"),r())}function Cs(n,t){if(n&1&&(i(0,"div",68),a(1),r()),n&2){let e=m();l(),C("\u300C",e.reviewNote,"\u300D")}}function Es(n,t){if(n&1&&(i(0,"div",64),a(1),I(2,"date"),p(3,xs,2,0,"span",65)(4,hs,2,0,"span",66)(5,Ss,2,0,"span",67),r(),p(6,Cs,2,1,"div",68)),n&2){let e=t;l(),Y(" ",e.reviewedBy," \xB7 ",O(2,4,e.reviewedAt,"yyyy-MM-dd")," \xB7 "),l(2),c(e.action==="approved"?3:e.action==="returned"?4:5),l(3),c(e.reviewNote?6:-1)}}function ys(n,t){n&1&&(i(0,"div",61),a(1,"\u5BE9\u6838\u4E2D\u2026"),r())}function As(n,t){if(n&1&&(i(0,"li",56),p(1,vs,2,1)(2,fs,2,1,"span",57)(3,gs,2,1,"span",58),i(4,"div",59)(5,"div",24),a(6),p(7,_s,2,1,"span",60),r(),p(8,bs,2,1,"div",26),p(9,Es,7,7)(10,ys,2,0,"div",61),r()()),n&2){let e,o,s=t.$implicit,v=t.$index,F=t.$count,R=m(2),B=m();$("mb-6",v!==F-1),l(),c((e=B.getRecord(R.approvalRecords,s.stepOrder))?1:R.currentStepOrder===s.stepOrder&&R.status==="pending"?2:3,e),l(5),C(" ",s.jobTitleName||"\u2014"," "),l(),c(s.departmentName?7:-1),l(),c(s.note?8:-1),l(),c((o=B.getRecord(R.approvalRecords,s.stepOrder))?9:R.currentStepOrder===s.stepOrder&&R.status==="pending"?10:-1,o)}}function Fs(n,t){if(n&1&&(i(0,"div",13)(1,"div",17),u(),i(2,"svg",18),d(3,"use",53),r(),a(4," \u7C3D\u6838\u6D41\u7A0B "),r(),S(),i(5,"div",20)(6,"ol",54),L(7,As,11,7,"li",55,Kl),r()()()),n&2){let e=m();l(7),P(e.flow.steps)}}function Ts(n,t){n&1&&(i(0,"span",67),a(1,"*"),r())}function ws(n,t){n&1&&(i(0,"div",81),a(1,"\u9000\u56DE\u4FEE\u6539\u6216\u62D2\u7D55\u6642\u8ACB\u586B\u5BEB\u539F\u56E0\u3002"),r())}function Ds(n,t){if(n&1){let e=D();i(0,"div",13)(1,"div",17),u(),i(2,"svg",18),d(3,"use",8),r(),a(4," \u5BE9\u6838 "),r(),S(),i(5,"div",20)(6,"form",69),b("ngSubmit",function(){E(e);let s=m(2);return y(s.submit())}),i(7,"div",70)(8,"label",71),a(9,"\u5BE9\u6838\u7D50\u679C "),i(10,"span",67),a(11,"*"),r()(),i(12,"div",72)(13,"div",73),d(14,"input",74),i(15,"label",75),a(16,"\u6838\u51C6"),r()(),i(17,"div",73),d(18,"input",76),i(19,"label",77),a(20,"\u9000\u56DE\u4FEE\u6539"),r()(),i(21,"div",73),d(22,"input",78),i(23,"label",79),a(24,"\u62D2\u7D55\uFF08\u7D42\u6B62\uFF09"),r()()()(),i(25,"div",70)(26,"label",71),a(27," \u5BE9\u6838\u610F\u898B "),p(28,Ts,2,0,"span",67),r(),d(29,"textarea",80),p(30,ws,2,0,"div",81),r(),i(31,"div",82)(32,"button",83),a(33,"\u63D0\u4EA4\u5BE9\u6838"),r(),i(34,"a",84),a(35,"\u53D6\u6D88"),r()()()()()}if(n&2){let e,o=m(2);l(6),h("formGroup",o.form),l(22),c(((e=o.form.get("action"))==null?null:e.value)==="rejected"||((e=o.form.get("action"))==null?null:e.value)==="returned"?28:-1),l(2),c(o.showNoteError?30:-1)}}function ks(n,t){if(n&1&&(i(0,"div",89),a(1,"\u9000\u56DE\u539F\u56E0\uFF1A"),r(),i(2,"div",90),a(3),r()),n&2){let e=m(2);l(3),f(e.reviewNote)}}function Ls(n,t){if(n&1&&(i(0,"div",13)(1,"div",85),u(),i(2,"svg",14),d(3,"use",86),r(),a(4," \u9000\u56DE\u4FEE\u6539 "),r(),S(),i(5,"div",20)(6,"p",87),a(7,"\u6B64\u7533\u8ACB\u5DF2\u9000\u56DE\uFF0C\u5F85\u7533\u8ACB\u4EBA\u4FEE\u6539\u5F8C\u91CD\u65B0\u9001\u51FA\u3002"),r(),p(8,ks,4,1),i(9,"div",88)(10,"a",84),a(11,"\u8FD4\u56DE\u5217\u8868"),r()()()()),n&2){let e=m();l(8),c(e.reviewNote?8:-1)}}function Ps(n,t){if(n&1&&(i(0,"div",89),a(1,"\u6838\u51C6\u6642\u9593\uFF1A"),r(),i(2,"div",93),a(3),I(4,"date"),r()),n&2){let e=m(2);l(3),f(O(4,1,e.reviewedAt,"yyyy-MM-dd HH:mm"))}}function Is(n,t){if(n&1&&(i(0,"div",89),a(1,"\u5BE9\u6838\u610F\u898B\uFF1A"),r(),i(2,"div",90),a(3),r()),n&2){let e=m(2);l(3),f(e.reviewNote)}}function Rs(n,t){if(n&1&&(i(0,"div",13)(1,"div",91),u(),i(2,"svg",14),d(3,"use",92),r(),a(4," \u5DF2\u6838\u51C6 "),r(),S(),i(5,"div",20)(6,"p",87),a(7,"\u6B64\u7533\u8ACB\u5DF2\u901A\u904E\u6240\u6709\u7C3D\u6838\u6D41\u7A0B\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002"),r(),p(8,Ps,5,4),p(9,Is,4,1),i(10,"div",88)(11,"a",84),a(12,"\u8FD4\u56DE\u5217\u8868"),r()()()()),n&2){let e=m();l(8),c(e.reviewedAt?8:-1),l(),c(e.reviewNote?9:-1)}}function Bs(n,t){if(n&1&&(i(0,"div",89),a(1,"\u62D2\u7D55\u6642\u9593\uFF1A"),r(),i(2,"div",93),a(3),I(4,"date"),r()),n&2){let e=m(2);l(3),f(O(4,1,e.reviewedAt,"yyyy-MM-dd HH:mm"))}}function Ms(n,t){if(n&1&&(i(0,"div",89),a(1,"\u62D2\u7D55\u539F\u56E0\uFF1A"),r(),i(2,"div",90),a(3),r()),n&2){let e=m(2);l(3),f(e.reviewNote)}}function js(n,t){if(n&1&&(i(0,"div",13)(1,"div",94),u(),i(2,"svg",14),d(3,"use",95),r(),a(4," \u5DF2\u62D2\u7D55 "),r(),S(),i(5,"div",20)(6,"p",87),a(7,"\u6B64\u7533\u8ACB\u5DF2\u88AB\u62D2\u7D55\uFF0C\u7C3D\u6838\u6D41\u7A0B\u7D42\u6B62\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002"),r(),p(8,Bs,5,4),p(9,Ms,4,1),i(10,"div",88)(11,"a",84),a(12,"\u8FD4\u56DE\u5217\u8868"),r()()()()),n&2){let e=m();l(8),c(e.reviewedAt?8:-1),l(),c(e.reviewNote?9:-1)}}function Vs(n,t){if(n&1&&(i(0,"div",3)(1,"a",4),u(),i(2,"svg",5),d(3,"use",6),r()(),i(4,"svg",7),d(5,"use",8),r(),S(),i(6,"h4",9),a(7,"\u7C3D\u6838\u5BE9\u6838"),r(),i(8,"span"),a(9),r(),i(10,"span"),a(11),r()(),p(12,Zl,4,1,"div",10),i(13,"div",11)(14,"div",12),p(15,is,1,1)(16,rs,1,1)(17,ls,1,1)(18,us,1,1),p(19,Fs,9,0,"div",13),p(20,Ds,36,3,"div",13)(21,Ls,12,1,"div",13)(22,Rs,13,2,"div",13)(23,js,13,2,"div",13),r()()),n&2){let e,o=t,s=m();l(8),J("badge "+s.appTypeClass[o.applicationType]),l(),f(s.appTypeLabel[o.applicationType]),l(),J("badge "+s.statusClass[o.status]),l(),f(s.statusLabel[o.status]),l(),c(s.errorMsg()?12:-1),l(3),c((e=o.applicationType)==="payment_request"?15:e==="leave"?16:e==="travel"?17:e==="overtime"?18:-1),l(4),c(o.flow?19:-1),l(),c(o.status==="pending"?20:o.status==="returned"?21:o.status==="approved"?22:23)}}function Ns(n,t){n&1&&(i(0,"p",1),a(1,"\u627E\u4E0D\u5230\u6B64\u7C3D\u6838\u4F5C\u696D\u3002"),r())}function Os(n,t){if(n&1){let e=D();i(0,"app-file-preview-modal",96),b("closed",function(){E(e);let s=m();return y(s.closePreview())}),r()}if(n&2){let e=m();h("file",e.previewFile)}}var vi=class n{service=g(Ut);route=g(me);router=g(de);fb=g(ie);sanitizer=g(Gt);task$;taskId=0;applicationType="";taskStatus=j("pending");errorMsg=j("");showNoteError=!1;previewFile=null;openPreview(t,e){this.previewFile={name:t,url:e,safeUrl:this.sanitizer.bypassSecurityTrustResourceUrl(e)}}closePreview(){this.previewFile=null}statusLabel=mi;statusClass=di;appTypeLabel=it;appTypeClass=nt;payTypeLabel=ui;leaveTypeLabel=pi;form=this.fb.group({action:["approved",w.required],reviewNote:[""]});ngOnInit(){this.applicationType=this.route.snapshot.paramMap.get("applicationType")??"",this.taskId=+this.route.snapshot.paramMap.get("id"),this.task$=this.service.getById(this.taskId,this.applicationType).pipe(Nt(t=>{t&&this.taskStatus.set(t.status)}),$i(t=>(this.errorMsg.set(t.error?.message||"\u8F09\u5165\u7C3D\u6838\u4F5C\u696D\u5931\u6557\u3002"),Oi)))}getRecord(t,e){return t.find(o=>o.stepOrder===e)}submit(){if(this.taskStatus()!=="pending")return;let t=this.form.value.action,e=this.form.value.reviewNote?.trim()??"";if((t==="rejected"||t==="returned")&&!e){this.showNoteError=!0;return}this.showNoteError=!1,this.errorMsg.set(""),this.service.review(this.taskId,this.applicationType,t,e).subscribe({next:()=>this.router.navigate(["/admin/approval-tasks"]),error:o=>{this.errorMsg.set(o.error?.message||"\u5BE9\u6838\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-approval-task-review"]],decls:5,vars:4,consts:[[1,"container-fluid","py-3"],[1,"text-muted"],[3,"file"],[1,"flex","items-center","gap-2","mb-6"],["routerLink","/admin/approval-tasks",1,"btn","btn-sm","btn-outline-secondary"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#check-square"],[1,"mb-0"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],[1,"row","g-4"],[1,"col-12","col-lg-10","col-xl-8"],[1,"card","border-0","shadow-sm","mt-6"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#alert-triangle"],[1,"card","border-0","shadow-sm"],[1,"card-header","bg-transparent","border-bottom","flex","items-center","gap-2","fw-600"],[1,"sa-icon","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#dollar-sign"],[1,"card-body"],[1,"row","g-3","mb-0"],[1,"col-6","col-md-4"],[1,"text-muted","small","mb-1"],[1,"fw-500"],[1,"fw-500","font-monospace"],[1,"text-muted","small"],[1,"fw-600","fs-5"],["href","/assets/icons/sprite.svg#file-text"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-sm","mb-0"],[1,"table-light"],[1,"text-right"],["colspan","2",1,"text-right","fw-500","small"],[1,"text-right","fw-600"],[1,"small",2,"max-width","200px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap"],["type","button",1,"btn","btn-link","p-0","text-muted","small","inline-flex","items-center","gap-1",2,"text-decoration","none","max-width","100%","overflow","hidden","text-overflow","ellipsis"],[1,"text-muted","inline-flex","items-center","gap-1"],[1,"font-monospace","small"],[1,"text-right","fw-500"],["type","button",1,"btn","btn-link","p-0","text-muted","small","inline-flex","items-center","gap-1",2,"text-decoration","none","max-width","100%","overflow","hidden","text-overflow","ellipsis",3,"click"],[1,"sa-icon","shrink-0",2,"width","14px","height","14px","stroke","currentColor"],["href","/assets/icons/sprite.svg#calendar"],[1,"row","g-3"],[1,"col-12"],[1,"border","rounded","p-4","bg-[--bg-base]","small"],["href","/assets/icons/sprite.svg#map-pin"],[1,"font-monospace","fw-500"],["href","/assets/icons/sprite.svg#clock"],[1,"col-12","col-md-8"],[1,"flex","flex-wrap","gap-1"],[1,"badge","bg-[--bg-base]","text-[--text-muted]","font-monospace"],["href","/assets/icons/sprite.svg#git-merge"],[1,"list-none","p-0","mb-0"],[1,"flex","items-start","gap-3",3,"mb-6"],[1,"flex","items-start","gap-3"],[1,"badge","bg-primary","rounded-circle","flex","items-center","justify-center","shrink-0",2,"width","28px","height","28px","min-width","28px","font-size",".75rem"],[1,"badge","bg-[--bg-base]","text-[--text-muted]","rounded-circle","flex","items-center","justify-center","shrink-0",2,"width","28px","height","28px","min-width","28px","font-size",".75rem"],[1,"grow"],[1,"text-muted","font-normal"],[1,"text-primary","small","mt-1"],[1,"badge","bg-success","rounded-circle","flex","items-center","justify-center","shrink-0",2,"width","28px","height","28px","min-width","28px","font-size",".85rem"],[1,"badge","bg-danger","rounded-circle","flex","items-center","justify-center","shrink-0",2,"width","28px","height","28px","min-width","28px","font-size",".85rem"],[1,"text-muted","small","mt-1"],[1,"text-success"],[1,"text-[--yellow]"],[1,"text-danger"],[1,"text-muted","small","italic","mt-1"],[3,"ngSubmit","formGroup"],[1,"mb-4"],[1,"form-label","fw-500"],[1,"flex","flex-wrap","gap-4","mt-1"],[1,"form-check"],["type","radio","formControlName","action","value","approved","id","actionApprove",1,"form-check-input"],["for","actionApprove",1,"form-check-label","fw-500","text-success"],["type","radio","formControlName","action","value","returned","id","actionReturn",1,"form-check-input"],["for","actionReturn",1,"form-check-label","fw-500","text-[--yellow]"],["type","radio","formControlName","action","value","rejected","id","actionReject",1,"form-check-input"],["for","actionReject",1,"form-check-label","fw-500","text-danger"],["formControlName","reviewNote","rows","3","placeholder","\u586B\u5BEB\u5BE9\u6838\u610F\u898B\uFF08\u9000\u56DE\u4FEE\u6539\u6216\u62D2\u7D55\u6642\u5FC5\u586B\uFF09...",1,"form-control"],[1,"text-danger","small","mt-1"],[1,"flex","gap-2"],["type","submit",1,"btn","btn-primary"],["routerLink","/admin/approval-tasks",1,"btn","btn-outline-secondary"],[1,"card-header","bg-[rgba(184,137,42,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-[--yellow]"],["href","/assets/icons/sprite.svg#rotate-ccw"],[1,"text-muted","small","mb-2"],[1,"mt-2"],[1,"text-muted","small","mb-1","fw-500"],[1,"border","rounded","p-4","bg-[--bg-base]","small","mb-4"],[1,"card-header","bg-[rgba(37,162,68,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-success"],["href","/assets/icons/sprite.svg#check-circle"],[1,"small","mb-4"],[1,"card-header","bg-[rgba(220,53,69,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-danger"],["href","/assets/icons/sprite.svg#x-circle"],[3,"closed","file"]],template:function(e,o){if(e&1&&(i(0,"div",0),p(1,Vs,24,10),I(2,"async"),$t(3,Ns,2,0,"p",1),r(),p(4,Os,1,1,"app-file-preview-modal",2)),e&2){let s;l(),c((s=ye(2,2,o.task$))?1:3,s),l(3),c(o.previewFile?4:-1)}},dependencies:[q,ne,X,K,Qe,Z,Q,te,ee,pt,Le,be,Pe],encapsulation:2})};var ct=class n{http=g(fe);getAll(){return this.http.get(`${T.apiUrl}/leave-requests`)}getPaged(t,e){return this.http.get(`${T.apiUrl}/leave-requests`,{params:{page:t,pageSize:e}})}getById(t){return this.http.get(`${T.apiUrl}/leave-requests/${t}`)}create(t){return this.http.post(`${T.apiUrl}/leave-requests`,t)}update(t,e){return this.http.patch(`${T.apiUrl}/leave-requests/${t}`,e)}delete(t){return this.http.delete(`${T.apiUrl}/leave-requests/${t}`)}submit(t){return this.http.patch(`${T.apiUrl}/leave-requests/${t}/submit`,{})}static \u0275fac=function(e){return new(e||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})};var rr={annual:"\u5E74\u5047",personal:"\u4E8B\u5047",sick:"\u75C5\u5047",compensatory:"\u88DC\u4F11"},ar={annual:"bg-primary-subtle text-primary",personal:"bg-info-subtle text-info",sick:"bg-warning-subtle text-warning-emphasis",compensatory:"bg-secondary-subtle text-secondary"},fi={draft:"\u8349\u7A3F",pending:"\u5F85\u5BE9\u6838",approved:"\u5DF2\u6838\u51C6",rejected:"\u5DF2\u62D2\u7D55",returned:"\u9000\u56DE\u4FEE\u6539"},gi={draft:"bg-blue-subtle text-blue-emphasis",pending:"bg-warning-subtle text-warning-emphasis",approved:"bg-success-subtle text-success",rejected:"bg-danger-subtle text-danger",returned:"bg-secondary-subtle text-secondary"};var or=n=>[n,"edit"],qs=(n,t)=>t.id;function $s(n,t){if(n&1){let e=D();i(0,"a",25),u(),i(1,"svg",7),d(2,"use",26),r()(),S(),i(3,"button",27),b("click",function(){E(e);let s=m().$implicit,v=m();return y(v.delete(s))}),u(),i(4,"svg",7),d(5,"use",28),r()()}if(n&2){let e=m().$implicit;h("routerLink",W(1,or,e.id))}}function Gs(n,t){if(n&1&&(i(0,"a",24),u(),i(1,"svg",7),d(2,"use",29),r()()),n&2){let e=m().$implicit;h("routerLink",W(1,or,e.id))}}function Us(n,t){if(n&1&&(i(0,"tr")(1,"td")(2,"span"),a(3),r()(),i(4,"td",18),a(5),I(6,"date"),r(),i(7,"td",18),a(8),I(9,"date"),r(),i(10,"td",19),a(11),I(12,"number"),r(),i(13,"td",20),a(14),r(),i(15,"td")(16,"span"),a(17),r()(),i(18,"td",21),a(19),I(20,"date"),r(),i(21,"td",22)(22,"div",23),p(23,$s,6,3)(24,Gs,3,3,"a",24),r()()()),n&2){let e=t.$implicit,o=m();l(2),J("badge "+o.typeClass[e.leaveType]),l(),f(o.typeLabel[e.leaveType]),l(2),f(O(6,12,e.startDate,"yyyy-MM-dd")),l(3),f(O(9,15,e.endDate,"yyyy-MM-dd")),l(3),C("",O(12,18,e.days,"1.0-1")," \u5929"),l(3),f(e.reason),l(2),J("badge "+o.statusClass[e.approvalStatus]),l(),f(o.statusLabel[e.approvalStatus]),l(2),f(O(20,21,e.createdAt,"yyyy-MM-dd")),l(4),c(e.approvalStatus==="draft"?23:24)}}function Hs(n,t){n&1&&(i(0,"tr")(1,"td",30),a(2,"\u5C1A\u7121\u8ACB\u5047\u7533\u8ACB\u3002"),r()())}function zs(n,t){n&1&&(i(0,"li",38)(1,"span",40),a(2,"\u2026"),r()())}function Js(n,t){if(n&1){let e=D();i(0,"li",36)(1,"button",37),b("click",function(){E(e);let s=m().$implicit,v=m(2);return y(v.goTo(s))}),a(2),r()()}if(n&2){let e=m().$implicit,o=m(2);$("active",e===o.page()),l(2),f(e)}}function Ys(n,t){if(n&1&&p(0,zs,3,0,"li",38)(1,Js,3,3,"li",39),n&2){let e=t.$implicit;c(e===-1?0:1)}}function Ws(n,t){if(n&1){let e=D();i(0,"div",17)(1,"span",31),a(2),r(),i(3,"div",32)(4,"button",33),b("click",function(){E(e);let s=m();return y(s.prev())}),a(5,"\u2039"),r(),i(6,"span",34),a(7),r(),i(8,"button",33),b("click",function(){E(e);let s=m();return y(s.next())}),a(9,"\u203A"),r()(),i(10,"ul",35)(11,"li",36)(12,"button",37),b("click",function(){E(e);let s=m();return y(s.prev())}),a(13,"\u2039"),r()(),L(14,Ys,2,1,null,null,_e),i(16,"li",36)(17,"button",37),b("click",function(){E(e);let s=m();return y(s.next())}),a(18,"\u203A"),r()()()()}if(n&2){let e=m();l(2),ke("\u5171 ",e.totalCount()," \u7B46\uFF0C\u7B2C ",e.page()," / ",e.totalPages()," \u9801"),l(2),$("disabled",e.page()===1),l(3),Y("",e.page()," / ",e.totalPages()),l(),$("disabled",e.page()===e.totalPages()),l(3),$("disabled",e.page()===1),l(3),P(e.pageNumbers()),l(2),$("disabled",e.page()===e.totalPages())}}var _i=class n{service=g(ct);PAGE_SIZE=20;page=j(1);refresh=j(0);result=we(Me(N(()=>({page:this.page(),refresh:this.refresh()}))).pipe(se(({page:t})=>this.service.getPaged(t,this.PAGE_SIZE))),{initialValue:{items:[],totalCount:0,page:1,pageSize:20,totalPages:1}});pagedRequests=N(()=>this.result().items);totalCount=N(()=>this.result().totalCount);totalPages=N(()=>this.result().totalPages);pageNumbers=N(()=>Ks(this.page(),this.totalPages()));goTo(t){this.page.set(t)}prev(){this.page()>1&&this.page.update(t=>t-1)}next(){this.page()<this.totalPages()&&this.page.update(t=>t+1)}typeLabel=rr;typeClass=ar;statusLabel=fi;statusClass=gi;delete(t){confirm("\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u8ACB\u5047\u7533\u8ACB\u55CE\uFF1F")&&this.service.delete(t.id).subscribe(()=>this.refresh.update(e=>e+1))}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-leave-request-list"]],decls:38,vars:2,consts:[[1,"container-fluid","py-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-2","mb-6"],[1,"flex","items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#calendar"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","inline-flex","items-center","gap-1"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"text-right"],[1,"hidden","md:table-cell"],[1,"hidden","lg:table-cell"],[1,"flex","flex-col","gap-2","sm:flex-row","sm:items-center","sm:justify-between","px-4","py-3","border-t"],[1,"text-muted","small"],[1,"text-right","fw-500"],[1,"text-muted","small","hidden","md:table-cell"],[1,"text-muted","small","hidden","lg:table-cell"],[1,"text-right",2,"white-space","nowrap"],[1,"flex","justify-end","gap-1"],["title","\u6AA2\u8996",1,"btn","btn-sm","btn-ghost-secondary","inline-flex","items-center",3,"routerLink"],["title","\u7DE8\u8F2F",1,"btn","btn-sm","btn-ghost-primary","inline-flex","items-center",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],["title","\u522A\u9664",1,"btn","btn-sm","btn-ghost-danger","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#trash"],["href","/assets/icons/sprite.svg#eye"],["colspan","8",1,"text-center","text-muted","py-4"],[1,"text-muted","small","text-center","sm:text-left"],[1,"flex","sm:hidden","items-center","gap-1"],[1,"page-link","rounded",3,"click"],[1,"px-2","text-sm"],[1,"hidden","sm:flex","pagination","mb-0"],[1,"page-item"],[1,"page-link",3,"click"],[1,"page-item","disabled"],[1,"page-item",3,"active"],[1,"page-link"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),u(),i(3,"svg",3),d(4,"use",4),r(),S(),i(5,"h4",5),a(6,"\u8ACB\u5047\u7533\u8ACB"),r()(),i(7,"a",6),u(),i(8,"svg",7),d(9,"use",8),r(),a(10," \u65B0\u589E\u7533\u8ACB "),r()(),S(),i(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u5047\u5225"),r(),i(19,"th"),a(20,"\u958B\u59CB\u65E5\u671F"),r(),i(21,"th"),a(22,"\u7D50\u675F\u65E5\u671F"),r(),i(23,"th",14),a(24,"\u5929\u6578"),r(),i(25,"th",15),a(26,"\u539F\u56E0"),r(),i(27,"th"),a(28,"\u72C0\u614B"),r(),i(29,"th",16),a(30,"\u7533\u8ACB\u6642\u9593"),r(),i(31,"th",14),a(32,"\u64CD\u4F5C"),r()()(),i(33,"tbody"),L(34,Us,25,24,"tr",null,qs,!1,Hs,3,0,"tr"),r()()(),p(37,Ws,19,13,"div",17),r()()()),e&2&&(l(34),P(o.pagedRequests()),l(3),c(o.totalPages()>1?37:-1))},dependencies:[q,be,Pe],encapsulation:2})};function Ks(n,t){if(t<=9)return Array.from({length:t},(s,v)=>v+1);let e=[],o=0;for(let s=1;s<=t;s++)(s===1||s===t||s>=n-2&&s<=n+2)&&(o&&s-o>1&&e.push(-1),e.push(s),o=s);return e}function Zs(n,t){if(n&1&&(i(0,"div",6),u(),i(1,"svg",39),d(2,"use",40),r(),a(3),r()),n&2){let e=m();l(3),C(" ",e.errorMsg()," ")}}function Qs(n,t){n&1&&(i(0,"div",7)(1,"div",41),u(),i(2,"svg",39),d(3,"use",42),r(),a(4," \u6B64\u7533\u8ACB\u5BE9\u6838\u4E2D\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function Xs(n,t){n&1&&(i(0,"div",7)(1,"div",43),u(),i(2,"svg",39),d(3,"use",40),r(),a(4," \u6B64\u7533\u8ACB\u5DF2\u88AB\u9000\u56DE\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function e0(n,t){n&1&&(i(0,"div",7)(1,"div",44),u(),i(2,"svg",39),d(3,"use",45),r(),a(4," \u6B64\u7533\u8ACB\u5DF2\u6838\u51C6\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function t0(n,t){n&1&&(i(0,"div",7)(1,"div",46),u(),i(2,"svg",39),d(3,"use",47),r(),a(4," \u6B64\u7533\u8ACB\u5DF2\u88AB\u62D2\u7D55\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function i0(n,t){if(n&1&&(i(0,"div",29),u(),i(1,"svg",48),d(2,"use",42),r(),S(),i(3,"span",49),a(4,"\u76EE\u524D\u53EF\u88DC\u4F11\u6642\u6578\uFF1A"),i(5,"strong"),a(6),r()()()),n&2){let e=m();l(6),C("",e.overtimeHours," \u5C0F\u6642")}}function n0(n,t){n&1&&(i(0,"div",33),a(1,"\u8ACB\u9078\u64C7\u958B\u59CB\u65E5\u671F\u3002"),r())}function r0(n,t){n&1&&(i(0,"div",33),a(1,"\u8ACB\u9078\u64C7\u7D50\u675F\u65E5\u671F\u3002"),r())}function a0(n,t){n&1&&(i(0,"div",33),a(1,"\u8ACB\u8F38\u5165\u6709\u6548\u5929\u6578\uFF08\u6700\u5C11 0.5\uFF09\u3002"),r())}function o0(n,t){n&1&&(i(0,"div",33),a(1,"\u8ACB\u586B\u5BEB\u8ACB\u5047\u539F\u56E0\u3002"),r())}function l0(n,t){if(n&1){let e=D();i(0,"div",37)(1,"button",50),a(2),r(),i(3,"button",51),b("click",function(){E(e);let s=m();return y(s.submitForApproval())}),a(4," \u9001\u51FA\u7533\u8ACB "),r(),i(5,"a",52),a(6,"\u53D6\u6D88"),r()()}if(n&2){let e=m();l(),h("disabled",e.form.invalid),l(),C(" ",e.isEdit?"\u5132\u5B58":"\u5132\u5B58\u8349\u7A3F"," "),l(),h("disabled",e.form.invalid)}}function s0(n,t){n&1&&(i(0,"div",38)(1,"a",52),a(2,"\u8FD4\u56DE\u5217\u8868"),r()())}var Pt=class n{fb=g(ie);service=g(ct);route=g(me);router=g(de);isEdit=!1;requestId=0;isReadOnly=!1;isReturned=!1;isDraft=!0;approvalStatus="draft";errorMsg=j("");overtimeHours=16;statusLabel=fi;statusClass=gi;form=this.fb.group({leaveType:["annual",w.required],startDate:["",w.required],endDate:["",w.required],days:[1,[w.required,w.min(.5)]],reason:["",w.required]});ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t&&(this.isEdit=!0,this.requestId=+t,this.service.getById(this.requestId).subscribe(e=>{e&&(this.approvalStatus=e.approvalStatus,this.isDraft=e.approvalStatus==="draft",this.isReturned=e.approvalStatus==="returned",this.isReadOnly=e.approvalStatus!=="draft",this.form.patchValue({leaveType:e.leaveType,startDate:e.startDate instanceof Date?e.startDate.toISOString().split("T")[0]:String(e.startDate),endDate:e.endDate instanceof Date?e.endDate.toISOString().split("T")[0]:String(e.endDate),days:e.days,reason:e.reason}),this.isReadOnly&&this.form.disable())}))}save(){if(this.form.invalid||this.isReadOnly)return;let t=this._buildPayload(),e=this.isEdit?this.service.update(this.requestId,t):this.service.create(t);this.errorMsg.set(""),e.subscribe({next:o=>{this.isEdit||(this.requestId=o.id),this.router.navigate(["/admin/leave-requests"])},error:o=>{this.errorMsg.set(o.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}submitForApproval(){if(this.form.invalid||this.isReadOnly)return;let t=this._buildPayload(),e=this.isEdit?this.service.update(this.requestId,t):this.service.create(t);this.errorMsg.set(""),e.subscribe({next:o=>{this.service.submit(o.id).subscribe({next:()=>this.router.navigate(["/admin/leave-requests"]),error:s=>{this.errorMsg.set(s.error?.message||"\u9001\u51FA\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})},error:o=>{this.errorMsg.set(o.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}_buildPayload(){let t=this.form.value;return{leaveType:t.leaveType,startDate:new Date(t.startDate),endDate:new Date(t.endDate),days:+t.days,reason:t.reason}}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-leave-request-form"]],decls:75,vars:10,consts:[[1,"container-fluid","py-3"],[1,"flex","items-center","gap-2","mb-6"],["routerLink","/admin/leave-requests",1,"btn","btn-sm","btn-outline-secondary"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],[1,"card","border-0","shadow-sm","mb-6"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-lg-10","col-xl-8"],[1,"card","border-0","shadow-sm"],[1,"card-header","bg-transparent","border-bottom","flex","items-center","gap-2","fw-600"],[1,"sa-icon","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#calendar"],[1,"card-body"],[1,"mb-4"],[1,"form-label","fw-500"],[1,"text-danger"],[1,"flex","flex-wrap","gap-4","mt-1"],[1,"form-check"],["type","radio","formControlName","leaveType","value","annual","id","typeAnnual",1,"form-check-input"],["for","typeAnnual",1,"form-check-label"],["type","radio","formControlName","leaveType","value","personal","id","typePersonal",1,"form-check-input"],["for","typePersonal",1,"form-check-label"],["type","radio","formControlName","leaveType","value","sick","id","typeSick",1,"form-check-input"],["for","typeSick",1,"form-check-label"],["type","radio","formControlName","leaveType","value","compensatory","id","typeComp",1,"form-check-input"],["for","typeComp",1,"form-check-label"],[1,"alert","alert-info","flex","items-center","gap-2","py-2","mt-2","mb-0"],[1,"row","g-3","mb-4"],[1,"col-12","col-md-4"],["type","date","formControlName","startDate",1,"form-control"],[1,"text-danger","small","mt-1"],["type","date","formControlName","endDate",1,"form-control"],["type","number","formControlName","days","min","0.5","step","0.5","placeholder","1",1,"form-control"],["formControlName","reason","rows","3","placeholder","\u8ACB\u586B\u5BEB\u8ACB\u5047\u539F\u56E0...",1,"form-control"],[1,"mt-6","flex","gap-2"],[1,"mt-6"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#alert-triangle"],[1,"card-header","bg-[rgba(13,110,253,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-primary","py-3"],["href","/assets/icons/sprite.svg#clock"],[1,"card-header","bg-[rgba(255,193,7,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-warning","py-3"],[1,"card-header","bg-[rgba(37,162,68,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-success","py-3"],["href","/assets/icons/sprite.svg#check-circle"],[1,"card-header","bg-[rgba(220,53,69,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-danger","py-3"],["href","/assets/icons/sprite.svg#x-circle"],[1,"sa-icon","shrink-0",2,"stroke","currentColor"],[1,"small"],["type","submit",1,"btn","btn-outline-secondary",3,"disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["routerLink","/admin/leave-requests",1,"btn","btn-outline-secondary"]],template:function(e,o){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"a",2),u(),i(3,"svg",3),d(4,"use",4),r()(),S(),i(5,"h4",5),a(6),r()(),p(7,Zs,4,1,"div",6),p(8,Qs,5,0,"div",7)(9,Xs,5,0,"div",7)(10,e0,5,0,"div",7)(11,t0,5,0,"div",7),i(12,"form",8),b("ngSubmit",function(){return o.save()}),i(13,"div",9)(14,"div",10)(15,"div",11)(16,"div",12),u(),i(17,"svg",13),d(18,"use",14),r(),a(19," \u8ACB\u5047\u8CC7\u8A0A "),r(),S(),i(20,"div",15)(21,"div",16)(22,"label",17),a(23,"\u5047\u5225 "),i(24,"span",18),a(25,"*"),r()(),i(26,"div",19)(27,"div",20),d(28,"input",21),i(29,"label",22),a(30,"\u5E74\u5047"),r()(),i(31,"div",20),d(32,"input",23),i(33,"label",24),a(34,"\u4E8B\u5047"),r()(),i(35,"div",20),d(36,"input",25),i(37,"label",26),a(38,"\u75C5\u5047"),r()(),i(39,"div",20),d(40,"input",27),i(41,"label",28),a(42,"\u88DC\u4F11"),r()()(),p(43,i0,7,1,"div",29),r(),i(44,"div",30)(45,"div",31)(46,"label",17),a(47,"\u958B\u59CB\u65E5\u671F "),i(48,"span",18),a(49,"*"),r()(),d(50,"input",32),p(51,n0,2,0,"div",33),r(),i(52,"div",31)(53,"label",17),a(54,"\u7D50\u675F\u65E5\u671F "),i(55,"span",18),a(56,"*"),r()(),d(57,"input",34),p(58,r0,2,0,"div",33),r(),i(59,"div",31)(60,"label",17),a(61,"\u5929\u6578 "),i(62,"span",18),a(63,"*"),r()(),d(64,"input",35),p(65,a0,2,0,"div",33),r()(),i(66,"div",16)(67,"label",17),a(68,"\u8ACB\u5047\u539F\u56E0 "),i(69,"span",18),a(70,"*"),r()(),d(71,"textarea",36),p(72,o0,2,0,"div",33),r()()(),p(73,l0,7,3,"div",37)(74,s0,3,0,"div",38),r()()()()),e&2){let s,v,F,R,B;l(6),f(o.isEdit?o.isReadOnly?"\u6AA2\u8996\u8ACB\u5047\u7533\u8ACB":"\u7DE8\u8F2F\u8ACB\u5047\u8349\u7A3F":"\u65B0\u589E\u8ACB\u5047\u7533\u8ACB"),l(),c(o.errorMsg()?7:-1),l(),c(o.isReadOnly&&o.approvalStatus==="pending"?8:o.isReadOnly&&o.approvalStatus==="returned"?9:o.isReadOnly&&o.approvalStatus==="approved"?10:o.isReadOnly&&o.approvalStatus==="rejected"?11:-1),l(4),h("formGroup",o.form),l(31),c(((s=o.form.get("leaveType"))==null?null:s.value)==="compensatory"?43:-1),l(8),c((v=o.form.get("startDate"))!=null&&v.invalid&&((v=o.form.get("startDate"))!=null&&v.touched)?51:-1),l(7),c((F=o.form.get("endDate"))!=null&&F.invalid&&((F=o.form.get("endDate"))!=null&&F.touched)?58:-1),l(7),c((R=o.form.get("days"))!=null&&R.invalid&&((R=o.form.get("days"))!=null&&R.touched)?65:-1),l(7),c((B=o.form.get("reason"))!=null&&B.invalid&&((B=o.form.get("reason"))!=null&&B.touched)?72:-1),l(),c(o.isReadOnly?74:73)}},dependencies:[ne,X,K,xe,Qe,Z,Q,he,te,ee,q],encapsulation:2})};var vt=class n{http=g(fe);getAll(){return this.http.get(`${T.apiUrl}/travel-requests`)}getPaged(t,e){return this.http.get(`${T.apiUrl}/travel-requests`,{params:{page:t,pageSize:e}})}getById(t){return this.http.get(`${T.apiUrl}/travel-requests/${t}`)}create(t){return this.http.post(`${T.apiUrl}/travel-requests`,t)}update(t,e){return this.http.patch(`${T.apiUrl}/travel-requests/${t}`,e)}delete(t){return this.http.delete(`${T.apiUrl}/travel-requests/${t}`)}submit(t){return this.http.patch(`${T.apiUrl}/travel-requests/${t}/submit`,{})}static \u0275fac=function(e){return new(e||n)};static \u0275prov=ve({token:n,factory:n.\u0275fac,providedIn:"root"})};var bi={draft:"\u8349\u7A3F",pending:"\u5F85\u5BE9\u6838",approved:"\u5DF2\u6838\u51C6",rejected:"\u5DF2\u62D2\u7D55",returned:"\u9000\u56DE\u4FEE\u6539"},xi={draft:"bg-blue-subtle text-blue-emphasis",pending:"bg-warning-subtle text-warning-emphasis",approved:"bg-success-subtle text-success",rejected:"bg-danger-subtle text-danger",returned:"bg-secondary-subtle text-secondary"};var lr=n=>[n,"edit"],m0=(n,t)=>t.id;function d0(n,t){if(n&1){let e=D();i(0,"a",26),u(),i(1,"svg",7),d(2,"use",27),r()(),S(),i(3,"button",28),b("click",function(){E(e);let s=m().$implicit,v=m();return y(v.delete(s))}),u(),i(4,"svg",7),d(5,"use",29),r()()}if(n&2){let e=m().$implicit;h("routerLink",W(1,lr,e.id))}}function u0(n,t){if(n&1&&(i(0,"a",25),u(),i(1,"svg",7),d(2,"use",30),r()()),n&2){let e=m().$implicit;h("routerLink",W(1,lr,e.id))}}function p0(n,t){if(n&1&&(i(0,"tr")(1,"td",18),a(2),r(),i(3,"td",19),a(4),I(5,"date"),r(),i(6,"td",19),a(7),I(8,"date"),r(),i(9,"td",20),a(10),I(11,"number"),r(),i(12,"td",21),a(13),r(),i(14,"td",22),a(15),r(),i(16,"td")(17,"span"),a(18),r()(),i(19,"td",23)(20,"div",24),p(21,d0,6,3)(22,u0,3,3,"a",25),r()()()),n&2){let e=t.$implicit,o=m();l(2),f(e.destination),l(2),f(O(5,10,e.startDate,"yyyy-MM-dd")),l(3),f(O(8,13,e.endDate,"yyyy-MM-dd")),l(3),f(O(11,16,e.estimatedCost,"1.0-0")),l(3),f(e.purpose),l(2),f(e.projectCode||"\u2014"),l(2),J("badge "+o.statusClass[e.approvalStatus]),l(),f(o.statusLabel[e.approvalStatus]),l(3),c(e.approvalStatus==="draft"?21:22)}}function c0(n,t){n&1&&(i(0,"tr")(1,"td",31),a(2,"\u5C1A\u7121\u51FA\u5DEE\u7533\u8ACB\u3002"),r()())}function v0(n,t){n&1&&(i(0,"li",39)(1,"span",41),a(2,"\u2026"),r()())}function f0(n,t){if(n&1){let e=D();i(0,"li",37)(1,"button",38),b("click",function(){E(e);let s=m().$implicit,v=m(2);return y(v.goTo(s))}),a(2),r()()}if(n&2){let e=m().$implicit,o=m(2);$("active",e===o.page()),l(2),f(e)}}function g0(n,t){if(n&1&&p(0,v0,3,0,"li",39)(1,f0,3,3,"li",40),n&2){let e=t.$implicit;c(e===-1?0:1)}}function _0(n,t){if(n&1){let e=D();i(0,"div",17)(1,"span",32),a(2),r(),i(3,"div",33)(4,"button",34),b("click",function(){E(e);let s=m();return y(s.prev())}),a(5,"\u2039"),r(),i(6,"span",35),a(7),r(),i(8,"button",34),b("click",function(){E(e);let s=m();return y(s.next())}),a(9,"\u203A"),r()(),i(10,"ul",36)(11,"li",37)(12,"button",38),b("click",function(){E(e);let s=m();return y(s.prev())}),a(13,"\u2039"),r()(),L(14,g0,2,1,null,null,_e),i(16,"li",37)(17,"button",38),b("click",function(){E(e);let s=m();return y(s.next())}),a(18,"\u203A"),r()()()()}if(n&2){let e=m();l(2),ke("\u5171 ",e.totalCount()," \u7B46\uFF0C\u7B2C ",e.page()," / ",e.totalPages()," \u9801"),l(2),$("disabled",e.page()===1),l(3),Y("",e.page()," / ",e.totalPages()),l(),$("disabled",e.page()===e.totalPages()),l(3),$("disabled",e.page()===1),l(3),P(e.pageNumbers()),l(2),$("disabled",e.page()===e.totalPages())}}var hi=class n{service=g(vt);PAGE_SIZE=20;page=j(1);refresh=j(0);result=we(Me(N(()=>({page:this.page(),refresh:this.refresh()}))).pipe(se(({page:t})=>this.service.getPaged(t,this.PAGE_SIZE))),{initialValue:{items:[],totalCount:0,page:1,pageSize:20,totalPages:1}});pagedRequests=N(()=>this.result().items);totalCount=N(()=>this.result().totalCount);totalPages=N(()=>this.result().totalPages);pageNumbers=N(()=>b0(this.page(),this.totalPages()));goTo(t){this.page.set(t)}prev(){this.page()>1&&this.page.update(t=>t-1)}next(){this.page()<this.totalPages()&&this.page.update(t=>t+1)}statusLabel=bi;statusClass=xi;delete(t){confirm("\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u51FA\u5DEE\u7533\u8ACB\u55CE\uFF1F")&&this.service.delete(t.id).subscribe(()=>this.refresh.update(e=>e+1))}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-travel-request-list"]],decls:38,vars:2,consts:[[1,"container-fluid","py-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-2","mb-6"],[1,"flex","items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#map-pin"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","inline-flex","items-center","gap-1"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"text-right"],[1,"hidden","md:table-cell"],[1,"hidden","lg:table-cell"],[1,"flex","flex-col","gap-2","sm:flex-row","sm:items-center","sm:justify-between","px-4","py-3","border-t"],[1,"fw-500"],[1,"text-muted","small"],[1,"text-right","fw-500"],[1,"text-muted","small","hidden","md:table-cell"],[1,"font-monospace","small","hidden","lg:table-cell"],[1,"text-right",2,"white-space","nowrap"],[1,"flex","justify-end","gap-1"],["title","\u6AA2\u8996",1,"btn","btn-sm","btn-ghost-secondary","inline-flex","items-center",3,"routerLink"],["title","\u7DE8\u8F2F",1,"btn","btn-sm","btn-ghost-primary","inline-flex","items-center",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],["title","\u522A\u9664",1,"btn","btn-sm","btn-ghost-danger","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#trash"],["href","/assets/icons/sprite.svg#eye"],["colspan","8",1,"text-center","text-muted","py-4"],[1,"text-muted","small","text-center","sm:text-left"],[1,"flex","sm:hidden","items-center","gap-1"],[1,"page-link","rounded",3,"click"],[1,"px-2","text-sm"],[1,"hidden","sm:flex","pagination","mb-0"],[1,"page-item"],[1,"page-link",3,"click"],[1,"page-item","disabled"],[1,"page-item",3,"active"],[1,"page-link"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),u(),i(3,"svg",3),d(4,"use",4),r(),S(),i(5,"h4",5),a(6,"\u51FA\u5DEE\u7533\u8ACB"),r()(),i(7,"a",6),u(),i(8,"svg",7),d(9,"use",8),r(),a(10," \u65B0\u589E\u7533\u8ACB "),r()(),S(),i(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u51FA\u5DEE\u5730\u9EDE"),r(),i(19,"th"),a(20,"\u958B\u59CB\u65E5\u671F"),r(),i(21,"th"),a(22,"\u7D50\u675F\u65E5\u671F"),r(),i(23,"th",14),a(24,"\u9810\u4F30\u8CBB\u7528"),r(),i(25,"th",15),a(26,"\u76EE\u7684"),r(),i(27,"th",16),a(28,"\u5C08\u6848"),r(),i(29,"th"),a(30,"\u72C0\u614B"),r(),i(31,"th",14),a(32,"\u64CD\u4F5C"),r()()(),i(33,"tbody"),L(34,p0,23,19,"tr",null,m0,!1,c0,3,0,"tr"),r()()(),p(37,_0,19,13,"div",17),r()()()),e&2&&(l(34),P(o.pagedRequests()),l(3),c(o.totalPages()>1?37:-1))},dependencies:[q,be,Pe],encapsulation:2})};function b0(n,t){if(t<=9)return Array.from({length:t},(s,v)=>v+1);let e=[],o=0;for(let s=1;s<=t;s++)(s===1||s===t||s>=n-2&&s<=n+2)&&(o&&s-o>1&&e.push(-1),e.push(s),o=s);return e}var x0=(n,t)=>t.id;function h0(n,t){if(n&1&&(i(0,"div",6),u(),i(1,"svg",32),d(2,"use",33),r(),a(3),r()),n&2){let e=m();l(3),C(" ",e.errorMsg()," ")}}function S0(n,t){n&1&&(i(0,"div",7)(1,"div",34),u(),i(2,"svg",32),d(3,"use",35),r(),a(4," \u6B64\u7533\u8ACB\u5BE9\u6838\u4E2D\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function C0(n,t){n&1&&(i(0,"div",7)(1,"div",36),u(),i(2,"svg",32),d(3,"use",33),r(),a(4," \u6B64\u7533\u8ACB\u5DF2\u88AB\u9000\u56DE\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function E0(n,t){n&1&&(i(0,"div",7)(1,"div",37),u(),i(2,"svg",32),d(3,"use",38),r(),a(4," \u6B64\u7533\u8ACB\u5DF2\u6838\u51C6\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function y0(n,t){n&1&&(i(0,"div",7)(1,"div",39),u(),i(2,"svg",32),d(3,"use",40),r(),a(4," \u6B64\u7533\u8ACB\u5DF2\u88AB\u62D2\u7D55\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function A0(n,t){n&1&&(i(0,"div",21),a(1,"\u8ACB\u586B\u5BEB\u51FA\u5DEE\u5730\u9EDE\u3002"),r())}function F0(n,t){n&1&&(i(0,"div",21),a(1,"\u8ACB\u8F38\u5165\u9810\u4F30\u8CBB\u7528\u3002"),r())}function T0(n,t){n&1&&(i(0,"div",21),a(1,"\u8ACB\u9078\u64C7\u51FA\u767C\u65E5\u671F\u3002"),r())}function w0(n,t){n&1&&(i(0,"div",21),a(1,"\u8ACB\u9078\u64C7\u8FD4\u56DE\u65E5\u671F\u3002"),r())}function D0(n,t){if(n&1&&(i(0,"option",27),a(1),r()),n&2){let e=t.$implicit;h("ngValue",e.id),l(),Y("",e.code,"",e.departmentName?"\uFF08"+e.departmentName+"\uFF09":"")}}function k0(n,t){n&1&&(i(0,"div",21),a(1,"\u8ACB\u586B\u5BEB\u51FA\u5DEE\u76EE\u7684\u3002"),r())}function L0(n,t){if(n&1){let e=D();i(0,"div",30)(1,"button",41),a(2),r(),i(3,"button",42),b("click",function(){E(e);let s=m();return y(s.submitForApproval())}),a(4," \u9001\u51FA\u7533\u8ACB "),r(),i(5,"a",43),a(6,"\u53D6\u6D88"),r()()}if(n&2){let e=m();l(),h("disabled",e.form.invalid),l(),C(" ",e.isEdit?"\u5132\u5B58":"\u5132\u5B58\u8349\u7A3F"," "),l(),h("disabled",e.form.invalid)}}function P0(n,t){n&1&&(i(0,"div",31)(1,"a",43),a(2,"\u8FD4\u56DE\u5217\u8868"),r()())}var It=class n{fb=g(ie);service=g(vt);projects$=g(Ue);route=g(me);router=g(de);cdr=g(Ze);isEdit=!1;requestId=0;isReadOnly=!1;isReturned=!1;isDraft=!0;approvalStatus="draft";errorMsg=j("");projects=[];statusLabel=bi;statusClass=xi;form=this.fb.group({destination:["",w.required],startDate:["",w.required],endDate:["",w.required],estimatedCost:[0,[w.required,w.min(0)]],purpose:["",w.required],projectId:[null]});loadingProjects=!0;ngOnInit(){this.projects$.getAll().subscribe({next:e=>{this.projects=e.filter(o=>o.status==="active"),this.loadingProjects=!1,this.cdr.markForCheck()},error:()=>{this.loadingProjects=!1,this.errorMsg.set("\u8F09\u5165\u5C08\u6848\u8CC7\u6599\u5931\u6557\u3002")}});let t=this.route.snapshot.paramMap.get("id");t&&(this.isEdit=!0,this.requestId=+t,this.service.getById(this.requestId).subscribe(e=>{e&&(this.approvalStatus=e.approvalStatus,this.isDraft=e.approvalStatus==="draft",this.isReturned=e.approvalStatus==="returned",this.isReadOnly=e.approvalStatus!=="draft",this.form.patchValue({destination:e.destination,startDate:e.startDate instanceof Date?e.startDate.toISOString().split("T")[0]:String(e.startDate),endDate:e.endDate instanceof Date?e.endDate.toISOString().split("T")[0]:String(e.endDate),estimatedCost:e.estimatedCost,purpose:e.purpose,projectId:e.projectId??null}),this.isReadOnly&&this.form.disable(),this.cdr.markForCheck())}))}save(){if(this.form.invalid||this.isReadOnly)return;let t=this._buildPayload(),e=this.isEdit?this.service.update(this.requestId,t):this.service.create(t);this.errorMsg.set(""),e.subscribe({next:o=>{this.isEdit||(this.requestId=o.id),this.router.navigate(["/admin/travel-requests"])},error:o=>{this.errorMsg.set(o.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}submitForApproval(){if(this.form.invalid||this.isReadOnly)return;let t=this._buildPayload(),e=this.isEdit?this.service.update(this.requestId,t):this.service.create(t);this.errorMsg.set(""),e.subscribe({next:o=>{this.service.submit(o.id).subscribe({next:()=>this.router.navigate(["/admin/travel-requests"]),error:s=>{this.errorMsg.set(s.error?.message||"\u9001\u51FA\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})},error:o=>{this.errorMsg.set(o.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}_buildPayload(){let t=this.form.value,e=this.projects.find(o=>o.id===t.projectId);return{destination:t.destination,startDate:new Date(t.startDate),endDate:new Date(t.endDate),estimatedCost:+t.estimatedCost,purpose:t.purpose,projectId:t.projectId??void 0,projectCode:e?.code}}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-travel-request-form"]],decls:68,vars:12,consts:[[1,"container-fluid","py-3"],[1,"flex","items-center","gap-2","mb-6"],["routerLink","/admin/travel-requests",1,"btn","btn-sm","btn-outline-secondary"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],[1,"card","border-0","shadow-sm","mb-6"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-lg-10","col-xl-8"],[1,"card","border-0","shadow-sm"],[1,"card-header","bg-transparent","border-bottom","flex","items-center","gap-2","fw-600"],[1,"sa-icon","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#map-pin"],[1,"card-body"],[1,"row","g-3","mb-4"],[1,"col-12","col-md-6"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","destination","placeholder","\u4F8B\u5982\uFF1A\u53F0\u5357\u3001\u53F0\u4E2D",1,"form-control"],[1,"text-danger","small","mt-1"],["type","number","formControlName","estimatedCost","min","0","placeholder","0",1,"form-control"],[1,"col-12","col-md-4"],["type","date","formControlName","startDate",1,"form-control"],["type","date","formControlName","endDate",1,"form-control"],["formControlName","projectId",1,"form-select"],[3,"ngValue"],[1,"mb-4"],["formControlName","purpose","rows","3","placeholder","\u8ACB\u586B\u5BEB\u51FA\u5DEE\u76EE\u7684...",1,"form-control"],[1,"mt-6","flex","gap-2"],[1,"mt-6"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#alert-triangle"],[1,"card-header","bg-[rgba(13,110,253,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-primary","py-3"],["href","/assets/icons/sprite.svg#clock"],[1,"card-header","bg-[rgba(255,193,7,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-warning","py-3"],[1,"card-header","bg-[rgba(37,162,68,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-success","py-3"],["href","/assets/icons/sprite.svg#check-circle"],[1,"card-header","bg-[rgba(220,53,69,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-danger","py-3"],["href","/assets/icons/sprite.svg#x-circle"],["type","submit",1,"btn","btn-outline-secondary",3,"disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["routerLink","/admin/travel-requests",1,"btn","btn-outline-secondary"]],template:function(e,o){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"a",2),u(),i(3,"svg",3),d(4,"use",4),r()(),S(),i(5,"h4",5),a(6),r()(),p(7,h0,4,1,"div",6),p(8,S0,5,0,"div",7)(9,C0,5,0,"div",7)(10,E0,5,0,"div",7)(11,y0,5,0,"div",7),i(12,"form",8),b("ngSubmit",function(){return o.save()}),i(13,"div",9)(14,"div",10)(15,"div",11)(16,"div",12),u(),i(17,"svg",13),d(18,"use",14),r(),a(19," \u51FA\u5DEE\u8CC7\u8A0A "),r(),S(),i(20,"div",15)(21,"div",16)(22,"div",17)(23,"label",18),a(24,"\u51FA\u5DEE\u5730\u9EDE "),i(25,"span",19),a(26,"*"),r()(),d(27,"input",20),p(28,A0,2,0,"div",21),r(),i(29,"div",17)(30,"label",18),a(31,"\u9810\u4F30\u8CBB\u7528\uFF08\u5143\uFF09"),i(32,"span",19),a(33,"*"),r()(),d(34,"input",22),p(35,F0,2,0,"div",21),r()(),i(36,"div",16)(37,"div",23)(38,"label",18),a(39,"\u51FA\u767C\u65E5\u671F "),i(40,"span",19),a(41,"*"),r()(),d(42,"input",24),p(43,T0,2,0,"div",21),r(),i(44,"div",23)(45,"label",18),a(46,"\u8FD4\u56DE\u65E5\u671F "),i(47,"span",19),a(48,"*"),r()(),d(49,"input",25),p(50,w0,2,0,"div",21),r(),i(51,"div",23)(52,"label",18),a(53,"\u95DC\u806F\u5C08\u6848\uFF08\u9078\u586B\uFF09"),r(),i(54,"select",26)(55,"option",27),a(56),r(),L(57,D0,2,3,"option",27,x0),r()()(),i(59,"div",28)(60,"label",18),a(61,"\u51FA\u5DEE\u76EE\u7684 "),i(62,"span",19),a(63,"*"),r()(),d(64,"textarea",29),p(65,k0,2,0,"div",21),r()()(),p(66,L0,7,3,"div",30)(67,P0,3,0,"div",31),r()()()()),e&2){let s,v,F,R,B;l(6),f(o.isEdit?o.isReadOnly?"\u6AA2\u8996\u51FA\u5DEE\u7533\u8ACB":"\u7DE8\u8F2F\u51FA\u5DEE\u8349\u7A3F":"\u65B0\u589E\u51FA\u5DEE\u7533\u8ACB"),l(),c(o.errorMsg()?7:-1),l(),c(o.isReadOnly&&o.approvalStatus==="pending"?8:o.isReadOnly&&o.approvalStatus==="returned"?9:o.isReadOnly&&o.approvalStatus==="approved"?10:o.isReadOnly&&o.approvalStatus==="rejected"?11:-1),l(4),h("formGroup",o.form),l(16),c((s=o.form.get("destination"))!=null&&s.invalid&&((s=o.form.get("destination"))!=null&&s.touched)?28:-1),l(7),c((v=o.form.get("estimatedCost"))!=null&&v.invalid&&((v=o.form.get("estimatedCost"))!=null&&v.touched)?35:-1),l(8),c((F=o.form.get("startDate"))!=null&&F.invalid&&((F=o.form.get("startDate"))!=null&&F.touched)?43:-1),l(7),c((R=o.form.get("endDate"))!=null&&R.invalid&&((R=o.form.get("endDate"))!=null&&R.touched)?50:-1),l(5),h("ngValue",null),l(),f(o.loadingProjects?"\u8F09\u5165\u4E2D\u2026":"\u2014 \u4E0D\u95DC\u806F\u5C08\u6848 \u2014"),l(),P(o.projects),l(8),c((B=o.form.get("purpose"))!=null&&B.invalid&&((B=o.form.get("purpose"))!=null&&B.touched)?65:-1),l(),c(o.isReadOnly?67:66)}},dependencies:[ne,X,Re,Be,K,xe,Ie,Z,Q,he,te,ee,q],encapsulation:2})};var Si={draft:"\u8349\u7A3F",pending:"\u5F85\u5BE9\u6838",approved:"\u5DF2\u6838\u51C6",rejected:"\u5DF2\u62D2\u7D55",returned:"\u9000\u56DE\u4FEE\u6539"},Ci={draft:"bg-blue-subtle text-blue-emphasis",pending:"bg-warning-subtle text-warning-emphasis",approved:"bg-success-subtle text-success",rejected:"bg-danger-subtle text-danger",returned:"bg-secondary-subtle text-secondary"};var sr=n=>[n,"edit"],I0=(n,t)=>t.id;function R0(n,t){if(n&1){let e=D();i(0,"a",26),u(),i(1,"svg",7),d(2,"use",27),r()(),S(),i(3,"button",28),b("click",function(){E(e);let s=m().$implicit,v=m();return y(v.delete(s))}),u(),i(4,"svg",7),d(5,"use",29),r()()}if(n&2){let e=m().$implicit;h("routerLink",W(1,sr,e.id))}}function B0(n,t){if(n&1&&(i(0,"a",25),u(),i(1,"svg",7),d(2,"use",30),r()()),n&2){let e=m().$implicit;h("routerLink",W(1,sr,e.id))}}function M0(n,t){if(n&1&&(i(0,"tr")(1,"td",18),a(2),I(3,"date"),r(),i(4,"td",19),a(5),r(),i(6,"td",20),a(7),I(8,"number"),r(),i(9,"td",21),a(10),r(),i(11,"td")(12,"span"),a(13),r()(),i(14,"td",22),a(15),I(16,"date"),r(),i(17,"td",23)(18,"div",24),p(19,R0,6,3)(20,B0,3,3,"a",25),r()()()),n&2){let e=t.$implicit,o=m();l(2),f(O(3,9,e.overtimeDate,"yyyy-MM-dd")),l(3),f((e.projectCodes==null?null:e.projectCodes.join(", "))||"\u2014"),l(2),C("",O(8,12,e.estimatedHours,"1.1-1")," h"),l(3),f(e.reason),l(2),J("badge "+o.statusClass[e.approvalStatus]),l(),f(o.statusLabel[e.approvalStatus]),l(2),f(O(16,15,e.createdAt,"yyyy-MM-dd HH:mm")),l(4),c(e.approvalStatus==="draft"?19:20)}}function j0(n,t){n&1&&(i(0,"tr")(1,"td",31),a(2,"\u5C1A\u7121\u52A0\u73ED\u7533\u8ACB\u3002"),r()())}function V0(n,t){n&1&&(i(0,"li",39)(1,"span",41),a(2,"\u2026"),r()())}function N0(n,t){if(n&1){let e=D();i(0,"li",37)(1,"button",38),b("click",function(){E(e);let s=m().$implicit,v=m(2);return y(v.goTo(s))}),a(2),r()()}if(n&2){let e=m().$implicit,o=m(2);$("active",e===o.page()),l(2),f(e)}}function O0(n,t){if(n&1&&p(0,V0,3,0,"li",39)(1,N0,3,3,"li",40),n&2){let e=t.$implicit;c(e===-1?0:1)}}function q0(n,t){if(n&1){let e=D();i(0,"div",17)(1,"span",32),a(2),r(),i(3,"div",33)(4,"button",34),b("click",function(){E(e);let s=m();return y(s.prev())}),a(5,"\u2039"),r(),i(6,"span",35),a(7),r(),i(8,"button",34),b("click",function(){E(e);let s=m();return y(s.next())}),a(9,"\u203A"),r()(),i(10,"ul",36)(11,"li",37)(12,"button",38),b("click",function(){E(e);let s=m();return y(s.prev())}),a(13,"\u2039"),r()(),L(14,O0,2,1,null,null,_e),i(16,"li",37)(17,"button",38),b("click",function(){E(e);let s=m();return y(s.next())}),a(18,"\u203A"),r()()()()}if(n&2){let e=m();l(2),ke("\u5171 ",e.totalCount()," \u7B46\uFF0C\u7B2C ",e.page()," / ",e.totalPages()," \u9801"),l(2),$("disabled",e.page()===1),l(3),Y("",e.page()," / ",e.totalPages()),l(),$("disabled",e.page()===e.totalPages()),l(3),$("disabled",e.page()===1),l(3),P(e.pageNumbers()),l(2),$("disabled",e.page()===e.totalPages())}}var Ei=class n{service=g(Ht);PAGE_SIZE=20;page=j(1);refresh=j(0);result=we(Me(N(()=>({page:this.page(),refresh:this.refresh()}))).pipe(se(({page:t})=>this.service.getPaged(t,this.PAGE_SIZE))),{initialValue:{items:[],totalCount:0,page:1,pageSize:20,totalPages:1}});pagedRequests=N(()=>this.result().items);totalCount=N(()=>this.result().totalCount);totalPages=N(()=>this.result().totalPages);pageNumbers=N(()=>$0(this.page(),this.totalPages()));goTo(t){this.page.set(t)}prev(){this.page()>1&&this.page.update(t=>t-1)}next(){this.page()<this.totalPages()&&this.page.update(t=>t+1)}statusLabel=Si;statusClass=Ci;delete(t){confirm("\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u52A0\u73ED\u7533\u8ACB\u55CE\uFF1F")&&this.service.delete(t.id).subscribe(()=>this.refresh.update(e=>e+1))}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-overtime-request-list"]],decls:36,vars:2,consts:[[1,"container-fluid","py-3"],[1,"flex","flex-wrap","items-center","justify-between","gap-2","mb-6"],[1,"flex","items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#zap"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","inline-flex","items-center","gap-1"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"text-right"],[1,"hidden","md:table-cell"],[1,"hidden","lg:table-cell"],[1,"flex","flex-col","gap-2","sm:flex-row","sm:items-center","sm:justify-between","px-4","py-3","border-t"],[1,"fw-500"],[1,"font-monospace","small"],[1,"text-right","fw-500"],[1,"text-muted","small","hidden","md:table-cell"],[1,"text-muted","small","hidden","lg:table-cell"],[1,"text-right",2,"white-space","nowrap"],[1,"flex","justify-end","gap-1"],["title","\u6AA2\u8996",1,"btn","btn-sm","btn-ghost-secondary","inline-flex","items-center",3,"routerLink"],["title","\u7DE8\u8F2F",1,"btn","btn-sm","btn-ghost-primary","inline-flex","items-center",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],["title","\u522A\u9664",1,"btn","btn-sm","btn-ghost-danger","inline-flex","items-center",3,"click"],["href","/assets/icons/sprite.svg#trash"],["href","/assets/icons/sprite.svg#eye"],["colspan","7",1,"text-center","text-muted","py-4"],[1,"text-muted","small","text-center","sm:text-left"],[1,"flex","sm:hidden","items-center","gap-1"],[1,"page-link","rounded",3,"click"],[1,"px-2","text-sm"],[1,"hidden","sm:flex","pagination","mb-0"],[1,"page-item"],[1,"page-link",3,"click"],[1,"page-item","disabled"],[1,"page-item",3,"active"],[1,"page-link"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2),u(),i(3,"svg",3),d(4,"use",4),r(),S(),i(5,"h4",5),a(6,"\u52A0\u73ED\u7533\u8ACB"),r()(),i(7,"a",6),u(),i(8,"svg",7),d(9,"use",8),r(),a(10," \u65B0\u589E\u7533\u8ACB "),r()(),S(),i(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u52A0\u73ED\u65E5\u671F"),r(),i(19,"th"),a(20,"\u5C08\u6848"),r(),i(21,"th",14),a(22,"\u9810\u4F30\u6642\u6578"),r(),i(23,"th",15),a(24,"\u539F\u56E0"),r(),i(25,"th"),a(26,"\u72C0\u614B"),r(),i(27,"th",16),a(28,"\u7533\u8ACB\u6642\u9593"),r(),i(29,"th",14),a(30,"\u64CD\u4F5C"),r()()(),i(31,"tbody"),L(32,M0,21,18,"tr",null,I0,!1,j0,3,0,"tr"),r()()(),p(35,q0,19,13,"div",17),r()()()),e&2&&(l(32),P(o.pagedRequests()),l(3),c(o.totalPages()>1?35:-1))},dependencies:[q,be,Pe],encapsulation:2})};function $0(n,t){if(t<=9)return Array.from({length:t},(s,v)=>v+1);let e=[],o=0;for(let s=1;s<=t;s++)(s===1||s===t||s>=n-2&&s<=n+2)&&(o&&s-o>1&&e.push(-1),e.push(s),o=s);return e}var G0=(n,t)=>t.id;function U0(n,t){if(n&1&&(i(0,"div",6),u(),i(1,"svg",30),d(2,"use",31),r(),a(3),r()),n&2){let e=m();l(3),C(" ",e.errorMsg()," ")}}function H0(n,t){n&1&&(i(0,"div",7)(1,"div",32),u(),i(2,"svg",30),d(3,"use",33),r(),a(4," \u6B64\u7533\u8ACB\u5BE9\u6838\u4E2D\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function z0(n,t){n&1&&(i(0,"div",7)(1,"div",34),u(),i(2,"svg",30),d(3,"use",31),r(),a(4," \u6B64\u7533\u8ACB\u5DF2\u88AB\u9000\u56DE\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function J0(n,t){n&1&&(i(0,"div",7)(1,"div",35),u(),i(2,"svg",30),d(3,"use",36),r(),a(4," \u6B64\u7533\u8ACB\u5DF2\u6838\u51C6\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function Y0(n,t){n&1&&(i(0,"div",7)(1,"div",37),u(),i(2,"svg",30),d(3,"use",38),r(),a(4," \u6B64\u7533\u8ACB\u5DF2\u88AB\u62D2\u7D55\uFF0C\u4E0D\u53EF\u518D\u4FEE\u6539\u3002 "),r()())}function W0(n,t){n&1&&(i(0,"div",21),a(1,"\u8ACB\u9078\u64C7\u52A0\u73ED\u65E5\u671F\u3002"),r())}function K0(n,t){n&1&&(i(0,"div",21),a(1,"\u8ACB\u8F38\u5165\u9810\u4F30\u6642\u6578\uFF08\u81F3\u5C11 0.5\uFF09\u3002"),r())}function Z0(n,t){if(n&1&&(i(0,"p",24),a(1),r()),n&2){let e=m();l(),f(e.displayProjectCodes.join(", ")||"\u2014")}}function Q0(n,t){n&1&&(i(0,"p",25),a(1,"\u8F09\u5165\u4E2D\u2026"),r())}function X0(n,t){if(n&1){let e=D();i(0,"label",40)(1,"input",41),b("change",function(){let s=E(e).$implicit,v=m(2);return y(v.toggleProject(s.id))}),r(),i(2,"span",42),a(3),r()()}if(n&2){let e=t.$implicit,o=m(2);$("border-primary",o.selectedProjectIds.has(e.id))("bg-primary-subtle",o.selectedProjectIds.has(e.id)),l(),h("checked",o.selectedProjectIds.has(e.id)),l(2),Y("",e.code,"",e.departmentName?"\uFF08"+e.departmentName+"\uFF09":"")}}function em(n,t){if(n&1&&(i(0,"div",26),L(1,X0,4,7,"label",39,G0),r()),n&2){let e=m();l(),P(e.projects)}}function tm(n,t){n&1&&(i(0,"div",21),a(1,"\u8ACB\u586B\u5BEB\u52A0\u73ED\u539F\u56E0\u3002"),r())}function im(n,t){if(n&1){let e=D();i(0,"div",28)(1,"button",43),a(2),r(),i(3,"button",44),b("click",function(){E(e);let s=m();return y(s.submitForApproval())}),a(4," \u9001\u51FA\u7533\u8ACB "),r(),i(5,"a",45),a(6,"\u53D6\u6D88"),r()()}if(n&2){let e=m();l(),h("disabled",e.form.invalid),l(),C(" ",e.isEdit?"\u5132\u5B58":"\u5132\u5B58\u8349\u7A3F"," "),l(),h("disabled",e.form.invalid)}}function nm(n,t){n&1&&(i(0,"div",29)(1,"a",45),a(2,"\u8FD4\u56DE\u5217\u8868"),r()())}var Rt=class n{fb=g(ie);service=g(Ht);projects$=g(Ue);route=g(me);router=g(de);cdr=g(Ze);isEdit=!1;requestId=0;isReadOnly=!1;isReturned=!1;isDraft=!0;approvalStatus="draft";errorMsg=j("");projects=[];selectedProjectIds=new Set;displayProjectCodes=[];statusLabel=Si;statusClass=Ci;form=this.fb.group({overtimeDate:["",w.required],estimatedHours:[1,[w.required,w.min(.5)]],reason:["",w.required]});loadingProjects=!0;ngOnInit(){this.projects$.getAll().subscribe({next:e=>{this.projects=e.filter(o=>o.status==="active"),this.loadingProjects=!1,this.cdr.markForCheck()},error:()=>{this.loadingProjects=!1,this.errorMsg.set("\u8F09\u5165\u5C08\u6848\u8CC7\u6599\u5931\u6557\u3002")}});let t=this.route.snapshot.paramMap.get("id");t&&(this.isEdit=!0,this.requestId=+t,this.service.getById(this.requestId).subscribe(e=>{e&&(this.approvalStatus=e.approvalStatus,this.isDraft=e.approvalStatus==="draft",this.isReturned=e.approvalStatus==="returned",this.isReadOnly=e.approvalStatus!=="draft",this.form.patchValue({overtimeDate:e.overtimeDate instanceof Date?e.overtimeDate.toISOString().split("T")[0]:String(e.overtimeDate),estimatedHours:e.estimatedHours,reason:e.reason}),e.projectIds&&e.projectIds.forEach(o=>this.selectedProjectIds.add(o)),e.projectCodes&&(this.displayProjectCodes=e.projectCodes),this.isReadOnly&&this.form.disable(),this.cdr.markForCheck())}))}toggleProject(t){this.isReadOnly||(this.selectedProjectIds.has(t)?this.selectedProjectIds.delete(t):this.selectedProjectIds.add(t))}save(){if(this.form.invalid||this.isReadOnly)return;let t=this._buildPayload(),e=this.isEdit?this.service.update(this.requestId,t):this.service.create(t);this.errorMsg.set(""),e.subscribe({next:o=>{this.isEdit||(this.requestId=o.id),this.router.navigate(["/admin/overtime-requests"])},error:o=>{this.errorMsg.set(o.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}submitForApproval(){if(this.form.invalid||this.isReadOnly)return;let t=this._buildPayload(),e=this.isEdit?this.service.update(this.requestId,t):this.service.create(t);this.errorMsg.set(""),e.subscribe({next:o=>{this.service.submit(o.id).subscribe({next:()=>this.router.navigate(["/admin/overtime-requests"]),error:s=>{this.errorMsg.set(s.error?.message||"\u9001\u51FA\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})},error:o=>{this.errorMsg.set(o.error?.message||"\u5132\u5B58\u5931\u6557\uFF0C\u8ACB\u7A0D\u5F8C\u518D\u8A66\u3002")}})}_buildPayload(){let t=this.form.value,e=Array.from(this.selectedProjectIds),o=e.map(s=>this.projects.find(v=>v.id===s)?.code).filter(Boolean);return{overtimeDate:new Date(t.overtimeDate),projectIds:e.length>0?e:void 0,projectCodes:o.length>0?o:void 0,estimatedHours:+t.estimatedHours,reason:t.reason}}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=V({type:n,selectors:[["app-overtime-request-form"]],decls:51,vars:9,consts:[[1,"container-fluid","py-3"],[1,"flex","items-center","gap-2","mb-6"],["routerLink","/admin/overtime-requests",1,"btn","btn-sm","btn-outline-secondary"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],["role","alert",1,"alert","alert-danger","flex","items-center","gap-2","mb-6","py-2"],[1,"card","border-0","shadow-sm","mb-6"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-lg-10","col-xl-8"],[1,"card","border-0","shadow-sm"],[1,"card-header","bg-transparent","border-bottom","flex","items-center","gap-2","fw-600"],[1,"sa-icon","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#zap"],[1,"card-body"],[1,"row","g-3","mb-4"],[1,"col-12","col-md-6"],[1,"form-label","fw-500"],[1,"text-danger"],["type","date","formControlName","overtimeDate",1,"form-control"],[1,"text-danger","small","mt-1"],["type","number","formControlName","estimatedHours","min","0.5","step","0.5","placeholder","1",1,"form-control"],[1,"mb-4"],[1,"form-control-plaintext","fw-500","font-monospace","mb-0"],[1,"text-muted","small","mb-0"],[1,"flex","flex-wrap","gap-2"],["formControlName","reason","rows","3","placeholder","\u8ACB\u586B\u5BEB\u52A0\u73ED\u539F\u56E0...",1,"form-control"],[1,"mt-6","flex","gap-2"],[1,"mt-6"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#alert-triangle"],[1,"card-header","bg-[rgba(13,110,253,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-primary","py-3"],["href","/assets/icons/sprite.svg#clock"],[1,"card-header","bg-[rgba(255,193,7,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-warning","py-3"],[1,"card-header","bg-[rgba(37,162,68,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-success","py-3"],["href","/assets/icons/sprite.svg#check-circle"],[1,"card-header","bg-[rgba(220,53,69,0.08)]","border-bottom","flex","items-center","gap-2","fw-600","text-danger","py-3"],["href","/assets/icons/sprite.svg#x-circle"],[1,"inline-flex","items-center","gap-2","px-3","py-2","rounded-lg","border","cursor-pointer",3,"border-primary","bg-primary-subtle"],[1,"inline-flex","items-center","gap-2","px-3","py-2","rounded-lg","border","cursor-pointer"],["type","checkbox",1,"form-check-input","m-0",3,"change","checked"],[1,"small","fw-500"],["type","submit",1,"btn","btn-outline-secondary",3,"disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["routerLink","/admin/overtime-requests",1,"btn","btn-outline-secondary"]],template:function(e,o){if(e&1&&(i(0,"div",0)(1,"div",1)(2,"a",2),u(),i(3,"svg",3),d(4,"use",4),r()(),S(),i(5,"h4",5),a(6),r()(),p(7,U0,4,1,"div",6),p(8,H0,5,0,"div",7)(9,z0,5,0,"div",7)(10,J0,5,0,"div",7)(11,Y0,5,0,"div",7),i(12,"form",8),b("ngSubmit",function(){return o.save()}),i(13,"div",9)(14,"div",10)(15,"div",11)(16,"div",12),u(),i(17,"svg",13),d(18,"use",14),r(),a(19," \u52A0\u73ED\u8CC7\u8A0A "),r(),S(),i(20,"div",15)(21,"div",16)(22,"div",17)(23,"label",18),a(24,"\u52A0\u73ED\u65E5\u671F "),i(25,"span",19),a(26,"*"),r()(),d(27,"input",20),p(28,W0,2,0,"div",21),r(),i(29,"div",17)(30,"label",18),a(31,"\u9810\u4F30\u6642\u6578\uFF08\u5C0F\u6642\uFF09"),i(32,"span",19),a(33,"*"),r()(),d(34,"input",22),p(35,K0,2,0,"div",21),r()(),i(36,"div",23)(37,"label",18),a(38,"\u95DC\u806F\u5C08\u6848\uFF08\u53EF\u591A\u9078\uFF09"),r(),p(39,Z0,2,1,"p",24)(40,Q0,2,0,"p",25)(41,em,3,0,"div",26),r(),i(42,"div",23)(43,"label",18),a(44,"\u52A0\u73ED\u539F\u56E0 "),i(45,"span",19),a(46,"*"),r()(),d(47,"textarea",27),p(48,tm,2,0,"div",21),r()()(),p(49,im,7,3,"div",28)(50,nm,3,0,"div",29),r()()()()),e&2){let s,v,F;l(6),f(o.isEdit?o.isReadOnly?"\u6AA2\u8996\u52A0\u73ED\u7533\u8ACB":"\u7DE8\u8F2F\u52A0\u73ED\u8349\u7A3F":"\u65B0\u589E\u52A0\u73ED\u7533\u8ACB"),l(),c(o.errorMsg()?7:-1),l(),c(o.isReadOnly&&o.approvalStatus==="pending"?8:o.isReadOnly&&o.approvalStatus==="returned"?9:o.isReadOnly&&o.approvalStatus==="approved"?10:o.isReadOnly&&o.approvalStatus==="rejected"?11:-1),l(4),h("formGroup",o.form),l(16),c((s=o.form.get("overtimeDate"))!=null&&s.invalid&&((s=o.form.get("overtimeDate"))!=null&&s.touched)?28:-1),l(7),c((v=o.form.get("estimatedHours"))!=null&&v.invalid&&((v=o.form.get("estimatedHours"))!=null&&v.touched)?35:-1),l(4),c(o.isReadOnly?39:o.loadingProjects?40:41),l(9),c((F=o.form.get("reason"))!=null&&F.invalid&&((F=o.form.get("reason"))!=null&&F.touched)?48:-1),l(),c(o.isReadOnly?50:49)}},dependencies:[ne,X,K,xe,Z,Q,he,te,ee,q],encapsulation:2})};var mf=[{path:"",redirectTo:"users",pathMatch:"full"},{path:"users",component:zt,canActivate:[U],data:{title:"\u54E1\u5DE5\u7BA1\u7406",permission:"users:read"}},{path:"users/new",component:Et,canActivate:[U],data:{title:"\u65B0\u589E\u54E1\u5DE5",permission:"users:write"}},{path:"users/:id/edit",component:Et,canActivate:[U],data:{title:"\u7DE8\u8F2F\u54E1\u5DE5",permission:"users:write"}},{path:"departments",component:Qt,canActivate:[U],data:{title:"\u90E8\u9580\u7BA1\u7406",permission:"departments:read"}},{path:"departments/new",component:Ft,canActivate:[U],data:{title:"\u65B0\u589E\u90E8\u9580",permission:"departments:write"}},{path:"departments/:id/edit",component:Ft,canActivate:[U],data:{title:"\u7DE8\u8F2F\u90E8\u9580",permission:"departments:write"}},{path:"job-titles",component:Xt,canActivate:[U],data:{title:"\u8077\u7A31\u7BA1\u7406",permission:"job-titles:read"}},{path:"job-titles/new",component:Tt,canActivate:[U],data:{title:"\u65B0\u589E\u8077\u7A31",permission:"job-titles:write"}},{path:"job-titles/:id/edit",component:Tt,canActivate:[U],data:{title:"\u7DE8\u8F2F\u8077\u7A31",permission:"job-titles:write"}},{path:"approvals",component:ei,canActivate:[U],data:{title:"\u7C3D\u6838\u7BA1\u7406",permission:"approvals:read"}},{path:"approvals/:id/flow",component:ti,canActivate:[U],data:{title:"\u7C3D\u6838\u6D41\u7A0B",permission:"approvals:read"}},{path:"roles",component:Yt,canActivate:[U],data:{title:"\u89D2\u8272\u7BA1\u7406",permission:"superadmin"}},{path:"roles/new",component:yt,canActivate:[U],data:{title:"\u65B0\u589E\u89D2\u8272",permission:"superadmin"}},{path:"roles/:id/edit",component:yt,canActivate:[U],data:{title:"\u7DE8\u8F2F\u89D2\u8272",permission:"superadmin"}},{path:"permissions",component:Wt,canActivate:[U],data:{title:"\u6B0A\u9650\u7BA1\u7406",permission:"superadmin"}},{path:"permissions/new",component:At,canActivate:[U],data:{title:"\u65B0\u589E\u6B0A\u9650",permission:"superadmin"}},{path:"permissions/:id/edit",component:At,canActivate:[U],data:{title:"\u7DE8\u8F2F\u6B0A\u9650",permission:"superadmin"}},{path:"projects",component:ii,canActivate:[U],data:{title:"\u5C08\u6848\u7BA1\u7406",permission:"projects:read"}},{path:"projects/new",component:wt,canActivate:[U],data:{title:"\u65B0\u589E\u5C08\u6848",permission:"projects:write"}},{path:"projects/:id/edit",component:wt,canActivate:[U],data:{title:"\u7DE8\u8F2F\u5C08\u6848",permission:"projects:write"}},{path:"payment-requests",component:ai,canActivate:[U],data:{title:"\u8ACB\u6B3E\u7533\u8ACB",permission:"payment-requests:read"}},{path:"payment-requests/new",component:Lt,canActivate:[U],data:{title:"\u65B0\u589E\u8ACB\u6B3E\u7533\u8ACB",permission:"payment-requests:write"}},{path:"payment-requests/:id/edit",component:Lt,canActivate:[U],data:{title:"\u7DE8\u8F2F\u8ACB\u6B3E\u7533\u8ACB",permission:"payment-requests:read"}},{path:"leave-requests",component:_i,canActivate:[U],data:{title:"\u8ACB\u5047\u7533\u8ACB",permission:"leave-requests:read"}},{path:"leave-requests/new",component:Pt,canActivate:[U],data:{title:"\u65B0\u589E\u8ACB\u5047\u7533\u8ACB",permission:"leave-requests:write"}},{path:"leave-requests/:id/edit",component:Pt,canActivate:[U],data:{title:"\u7DE8\u8F2F\u8ACB\u5047\u7533\u8ACB",permission:"leave-requests:read"}},{path:"travel-requests",component:hi,canActivate:[U],data:{title:"\u51FA\u5DEE\u7533\u8ACB",permission:"travel-requests:read"}},{path:"travel-requests/new",component:It,canActivate:[U],data:{title:"\u65B0\u589E\u51FA\u5DEE\u7533\u8ACB",permission:"travel-requests:write"}},{path:"travel-requests/:id/edit",component:It,canActivate:[U],data:{title:"\u7DE8\u8F2F\u51FA\u5DEE\u7533\u8ACB",permission:"travel-requests:read"}},{path:"overtime-requests",component:Ei,canActivate:[U],data:{title:"\u52A0\u73ED\u7533\u8ACB",permission:"overtime-requests:read"}},{path:"overtime-requests/new",component:Rt,canActivate:[U],data:{title:"\u65B0\u589E\u52A0\u73ED\u7533\u8ACB",permission:"overtime-requests:write"}},{path:"overtime-requests/:id/edit",component:Rt,canActivate:[U],data:{title:"\u7DE8\u8F2F\u52A0\u73ED\u7533\u8ACB",permission:"overtime-requests:read"}},{path:"approval-tasks",component:ci,canActivate:[U],data:{title:"\u7C3D\u6838\u4F5C\u696D",permission:"approval-tasks:read"}},{path:"approval-tasks/:applicationType/:id/review",component:vi,canActivate:[U],data:{title:"\u5BE9\u6838",permission:"approval-tasks:write"}},{path:"settings",component:Zt,canActivate:[U],data:{title:"\u7CFB\u7D71\u8A2D\u5B9A",permission:"settings:read"}}];export{mf as ADMIN_ROUTES};
