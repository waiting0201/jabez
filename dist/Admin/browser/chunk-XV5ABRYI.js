import{A as z,B as K,C as fe,D as $e,E as Ei,F as Ci,G as W,H as Q,I as Ee,J as Ce,K as ye,L as yi,M as be,O as Z,P as X,R as Ft,S as Ue,c as ae,e as ve,f as De,g as Si,k as me,o as wt,q as de,s as ce,t as V,w as hi,x as J,y as F,z as Y}from"./chunk-6PBKMPWI.js";import{$b as Te,F as ai,Hb as q,Lb as A,Ma as Oe,Na as Ct,Nb as u,Pa as l,T as se,Wb as At,Xb as oe,Y as p,Yb as a,Zb as c,_b as E,a as C,b as M,ba as j,bb as P,c as fi,ca as N,d as Et,da as f,e as le,ea as h,g as En,ic as re,jc as gi,l as ne,lc as D,mb as bi,mc as ie,nc as $,o as L,ob as g,oc as xi,pb as yt,qb as x,sb as Ke,tb as k,ub as B,vb as _,wb as t,xb as i,yb as m,yc as _i}from"./chunk-UGNWHHZP.js";var Ti=le((l0,si)=>{"use strict";var li=(function(r){"use strict";var n=Object.prototype,e=n.hasOwnProperty,o=Object.defineProperty||function(S,d,b){S[d]=b.value},s,v=typeof Symbol=="function"?Symbol:{},y=v.iterator||"@@iterator",T=v.asyncIterator||"@@asyncIterator",R=v.toStringTag||"@@toStringTag";function U(S,d,b){return Object.defineProperty(S,d,{value:b,enumerable:!0,configurable:!0,writable:!0}),S[d]}try{U({},"")}catch{U=function(d,b,I){return d[b]=I}}function we(S,d,b,I){var w=d&&d.prototype instanceof Ae?d:Ae,O=Object.create(w.prototype),te=new at(I||[]);return o(O,"_invoke",{value:nt(S,b,te)}),O}r.wrap=we;function H(S,d,b){try{return{type:"normal",arg:S.call(d,b)}}catch(I){return{type:"throw",arg:I}}}var pe="suspendedStart",Fe="suspendedYield",ke="executing",ge="completed",ee={};function Ae(){}function Se(){}function Ne(){}var tt={};U(tt,y,function(){return this});var it=Object.getPrototypeOf,ze=it&&it(it(ot([])));ze&&ze!==n&&e.call(ze,y)&&(tt=ze);var Ve=Ne.prototype=Ae.prototype=Object.create(tt);Se.prototype=Ne,o(Ve,"constructor",{value:Ne,configurable:!0}),o(Ne,"constructor",{value:Se,configurable:!0}),Se.displayName=U(Ne,R,"GeneratorFunction");function _t(S){["next","throw","return"].forEach(function(d){U(S,d,function(b){return this._invoke(d,b)})})}r.isGeneratorFunction=function(S){var d=typeof S=="function"&&S.constructor;return d?d===Se||(d.displayName||d.name)==="GeneratorFunction":!1},r.mark=function(S){return Object.setPrototypeOf?Object.setPrototypeOf(S,Ne):(S.__proto__=Ne,U(S,R,"GeneratorFunction")),S.prototype=Object.create(Ve),S},r.awrap=function(S){return{__await:S}};function qe(S,d){function b(O,te,he,xe){var _e=H(S[O],S,te);if(_e.type==="throw")xe(_e.arg);else{var ri=_e.arg,lt=ri.value;return lt&&typeof lt=="object"&&e.call(lt,"__await")?d.resolve(lt.__await).then(function(Ge){b("next",Ge,he,xe)},function(Ge){b("throw",Ge,he,xe)}):d.resolve(lt).then(function(Ge){ri.value=Ge,he(ri)},function(Ge){return b("throw",Ge,he,xe)})}}var I;function w(O,te){function he(){return new d(function(xe,_e){b(O,te,xe,_e)})}return I=I?I.then(he,he):he()}o(this,"_invoke",{value:w})}_t(qe.prototype),U(qe.prototype,T,function(){return this}),r.AsyncIterator=qe,r.async=function(S,d,b,I,w){w===void 0&&(w=Promise);var O=new qe(we(S,d,b,I),w);return r.isGeneratorFunction(d)?O:O.next().then(function(te){return te.done?te.value:O.next()})};function nt(S,d,b){var I=pe;return function(O,te){if(I===ke)throw new Error("Generator is already running");if(I===ge){if(O==="throw")throw te;return ht()}for(b.method=O,b.arg=te;;){var he=b.delegate;if(he){var xe=St(he,b);if(xe){if(xe===ee)continue;return xe}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(I===pe)throw I=ge,b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);I=ke;var _e=H(S,d,b);if(_e.type==="normal"){if(I=b.done?ge:Fe,_e.arg===ee)continue;return{value:_e.arg,done:b.done}}else _e.type==="throw"&&(I=ge,b.method="throw",b.arg=_e.arg)}}}function St(S,d){var b=d.method,I=S.iterator[b];if(I===s)return d.delegate=null,b==="throw"&&S.iterator.return&&(d.method="return",d.arg=s,St(S,d),d.method==="throw")||b!=="return"&&(d.method="throw",d.arg=new TypeError("The iterator does not provide a '"+b+"' method")),ee;var w=H(I,S.iterator,d.arg);if(w.type==="throw")return d.method="throw",d.arg=w.arg,d.delegate=null,ee;var O=w.arg;if(!O)return d.method="throw",d.arg=new TypeError("iterator result is not an object"),d.delegate=null,ee;if(O.done)d[S.resultName]=O.value,d.next=S.nextLoc,d.method!=="return"&&(d.method="next",d.arg=s);else return O;return d.delegate=null,ee}_t(Ve),U(Ve,R,"Generator"),U(Ve,y,function(){return this}),U(Ve,"toString",function(){return"[object Generator]"});function ni(S){var d={tryLoc:S[0]};1 in S&&(d.catchLoc=S[1]),2 in S&&(d.finallyLoc=S[2],d.afterLoc=S[3]),this.tryEntries.push(d)}function rt(S){var d=S.completion||{};d.type="normal",delete d.arg,S.completion=d}function at(S){this.tryEntries=[{tryLoc:"root"}],S.forEach(ni,this),this.reset(!0)}r.keys=function(S){var d=Object(S),b=[];for(var I in d)b.push(I);return b.reverse(),function w(){for(;b.length;){var O=b.pop();if(O in d)return w.value=O,w.done=!1,w}return w.done=!0,w}};function ot(S){if(S){var d=S[y];if(d)return d.call(S);if(typeof S.next=="function")return S;if(!isNaN(S.length)){var b=-1,I=function w(){for(;++b<S.length;)if(e.call(S,b))return w.value=S[b],w.done=!1,w;return w.value=s,w.done=!0,w};return I.next=I}}return{next:ht}}r.values=ot;function ht(){return{value:s,done:!0}}return at.prototype={constructor:at,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(rt),!S)for(var d in this)d.charAt(0)==="t"&&e.call(this,d)&&!isNaN(+d.slice(1))&&(this[d]=s)},stop:function(){this.done=!0;var S=this.tryEntries[0],d=S.completion;if(d.type==="throw")throw d.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var d=this;function b(xe,_e){return O.type="throw",O.arg=S,d.next=xe,_e&&(d.method="next",d.arg=s),!!_e}for(var I=this.tryEntries.length-1;I>=0;--I){var w=this.tryEntries[I],O=w.completion;if(w.tryLoc==="root")return b("end");if(w.tryLoc<=this.prev){var te=e.call(w,"catchLoc"),he=e.call(w,"finallyLoc");if(te&&he){if(this.prev<w.catchLoc)return b(w.catchLoc,!0);if(this.prev<w.finallyLoc)return b(w.finallyLoc)}else if(te){if(this.prev<w.catchLoc)return b(w.catchLoc,!0)}else if(he){if(this.prev<w.finallyLoc)return b(w.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(S,d){for(var b=this.tryEntries.length-1;b>=0;--b){var I=this.tryEntries[b];if(I.tryLoc<=this.prev&&e.call(I,"finallyLoc")&&this.prev<I.finallyLoc){var w=I;break}}w&&(S==="break"||S==="continue")&&w.tryLoc<=d&&d<=w.finallyLoc&&(w=null);var O=w?w.completion:{};return O.type=S,O.arg=d,w?(this.method="next",this.next=w.finallyLoc,ee):this.complete(O)},complete:function(S,d){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&d&&(this.next=d),ee},finish:function(S){for(var d=this.tryEntries.length-1;d>=0;--d){var b=this.tryEntries[d];if(b.finallyLoc===S)return this.complete(b.completion,b.afterLoc),rt(b),ee}},catch:function(S){for(var d=this.tryEntries.length-1;d>=0;--d){var b=this.tryEntries[d];if(b.tryLoc===S){var I=b.completion;if(I.type==="throw"){var w=I.arg;rt(b)}return w}}throw new Error("illegal catch attempt")},delegateYield:function(S,d,b){return this.delegate={iterator:ot(S),resultName:d,nextLoc:b},this.method==="next"&&(this.arg=s),ee}},r})(typeof si=="object"?si.exports:{});try{regeneratorRuntime=li}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=li:Function("r","regeneratorRuntime = r")(li)}});var qt=le((s0,Di)=>{"use strict";Di.exports=(r,n)=>`${r}-${n}-${Math.random().toString(16).slice(3,8)}`});var mi=le((m0,Li)=>{"use strict";var _a=qt(),Ii=0;Li.exports=({id:r,action:n,payload:e={}})=>{let o=r;return typeof o>"u"&&(o=_a("Job",Ii),Ii+=1),{id:o,action:n,payload:e}}});var Gt=le(vt=>{"use strict";var di=!1;vt.logging=di;vt.setLogging=r=>{di=r};vt.log=(...r)=>di?console.log.apply(vt,r):null});var Pi=le((Bi,Ri)=>{"use strict";var Sa=mi(),{log:Ut}=Gt(),ha=qt(),ki=0;Ri.exports=()=>{let r=ha("Scheduler",ki),n={},e={},o=[];ki+=1;let s=()=>o.length,v=()=>Object.keys(n).length,y=()=>{if(o.length!==0){let H=Object.keys(n);for(let pe=0;pe<H.length;pe+=1)if(typeof e[H[pe]]>"u"){o[0](n[H[pe]]);break}}},T=(H,pe)=>new Promise((Fe,ke)=>{let ge=Sa({action:H,payload:pe});o.push(async ee=>{o.shift(),e[ee.id]=ge;try{Fe(await ee[H].apply(Bi,[...pe,ge.id]))}catch(Ae){ke(Ae)}finally{delete e[ee.id],y()}}),Ut(`[${r}]: Add ${ge.id} to JobQueue`),Ut(`[${r}]: JobQueue length=${o.length}`),y()});return{addWorker:H=>(n[H.id]=H,Ut(`[${r}]: Add ${H.id}`),Ut(`[${r}]: Number of workers=${v()}`),y(),H.id),addJob:async(H,...pe)=>{if(v()===0)throw Error(`[${r}]: You need to have at least one worker before adding jobs`);return T(H,pe)},terminate:async()=>{Object.keys(n).forEach(async H=>{await n[H].terminate()}),o=[]},getQueueLen:s,getNumWorkers:v}}});var Ni=le((u0,ji)=>{"use strict";ji.exports=r=>{let n={};return typeof WorkerGlobalScope<"u"?n.type="webworker":typeof document=="object"?n.type="browser":typeof process=="object"&&typeof fi=="function"&&(n.type="node"),typeof r>"u"?n:n[r]}});var Oi=le((c0,Vi)=>{"use strict";var Ea=Ni()("type")==="browser",Ca=Ea?r=>new URL(r,window.location.href).href:r=>r;Vi.exports=r=>{let n=C({},r);return["corePath","workerPath","langPath"].forEach(e=>{r[e]&&(n[e]=Ca(n[e]))}),n}});var ui=le((f0,$i)=>{"use strict";$i.exports={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}});var Mi=le((b0,ya)=>{ya.exports={name:"tesseract.js",version:"7.0.0",description:"Pure Javascript Multilingual OCR",main:"src/index.js",type:"commonjs",types:"src/index.d.ts",unpkg:"dist/tesseract.min.js",jsdelivr:"dist/tesseract.min.js",scripts:{start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser test:node:all","test:browser":"karma start karma.conf.js","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.mjs","test:node:all":"npm run test:node -- ./tests/*.test.mjs",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},browser:{"./src/worker/node/index.js":"./src/worker/browser/index.js"},author:"",contributors:["jeromewu"],license:"Apache-2.0",devDependencies:{"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","npm-run-all":"^4.1.5",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-webpack":"^5.0.0",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},dependencies:{"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^7.0.0","wasm-feature-detect":"^1.8.0",zlibjs:"^0.3.1"},overrides:{"@rollup/pluginutils":"^5.0.2"},repository:{type:"git",url:"https://github.com/naptha/tesseract.js.git"},bugs:{url:"https://github.com/naptha/tesseract.js/issues"},homepage:"https://github.com/naptha/tesseract.js",collective:{type:"opencollective",url:"https://opencollective.com/tesseractjs"}}});var Gi=le((g0,qi)=>{"use strict";qi.exports={workerBlobURL:!0,logger:()=>{}}});var Hi=le((x0,Ui)=>{"use strict";var Aa=Mi().version,wa=Gi();Ui.exports=M(C({},wa),{workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${Aa}/dist/worker.min.js`})});var Yi=le((S0,Ji)=>{"use strict";Ji.exports=({workerPath:r,workerBlobURL:n})=>{let e;if(Blob&&URL&&n){let o=new Blob([`importScripts("${r}");`],{type:"application/javascript"});e=new Worker(URL.createObjectURL(o))}else e=new Worker(r);return e}});var Ki=le((h0,zi)=>{"use strict";zi.exports=r=>{r.terminate()}});var Qi=le((E0,Wi)=>{"use strict";Wi.exports=(r,n)=>{r.onmessage=({data:e})=>{n(e)}}});var Xi=le((C0,Zi)=>{"use strict";Zi.exports=async(r,n)=>{r.postMessage(n)}});var tn=le((y0,en)=>{"use strict";var pi=r=>new Promise((n,e)=>{let o=new FileReader;o.onload=()=>{n(o.result)},o.onerror=({target:{error:{code:s}}})=>{e(Error(`File could not be read! Code=${s}`))},o.readAsArrayBuffer(r)}),ci=async r=>{let n=r;if(typeof r>"u")return"undefined";if(typeof r=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(r)?n=atob(r.split(",")[1]).split("").map(e=>e.charCodeAt(0)):n=await(await fetch(r)).arrayBuffer();else if(typeof HTMLElement<"u"&&r instanceof HTMLElement)r.tagName==="IMG"&&(n=await ci(r.src)),r.tagName==="VIDEO"&&(n=await ci(r.poster)),r.tagName==="CANVAS"&&await new Promise(e=>{r.toBlob(async o=>{n=await pi(o),e()})});else if(typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas){let e=await r.convertToBlob();n=await pi(e)}else(r instanceof File||r instanceof Blob)&&(n=await pi(r));return new Uint8Array(n)};en.exports=ci});var rn=le((A0,nn)=>{"use strict";var Fa=Hi(),Ta=Yi(),Da=Ki(),Ia=Qi(),La=Xi(),ka=tn();nn.exports={defaultOptions:Fa,spawnWorker:Ta,terminateWorker:Da,onMessage:Ia,send:La,loadImage:ka}});var vi=le((w0,sn)=>{"use strict";var Ba=Oi(),je=mi(),{log:an}=Gt(),Ra=qt(),Ye=ui(),{defaultOptions:Pa,spawnWorker:ja,terminateWorker:Na,onMessage:Va,loadImage:on,send:Oa}=rn(),ln=0;sn.exports=async(r="eng",n=Ye.LSTM_ONLY,e={},o={})=>{let s=Ra("Worker",ln),S=Ba(C(C({},Pa),e)),{logger:v,errorHandler:y}=S,T=Et(S,["logger","errorHandler"]),R={},U=typeof r=="string"?r.split("+"):r,we=n,H=o,pe=[Ye.DEFAULT,Ye.LSTM_ONLY].includes(n)&&!T.legacyCore,Fe,ke,ge=new Promise((d,b)=>{ke=d,Fe=b}),ee=d=>{Fe(d.message)},Ae=ja(T);Ae.onerror=ee,ln+=1;let Se=({id:d,action:b,payload:I})=>new Promise((w,O)=>{an(`[${s}]: Start ${d}, action=${b}`);let te=`${b}-${d}`;R[te]={resolve:w,reject:O},Oa(Ae,{workerId:s,jobId:d,action:b,payload:I})}),Ne=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),tt=d=>Se(je({id:d,action:"load",payload:{options:{lstmOnly:pe,corePath:T.corePath,logging:T.logging}}})),it=(d,b,I)=>Se(je({id:I,action:"FS",payload:{method:"writeFile",args:[d,b]}})),ze=(d,b)=>Se(je({id:b,action:"FS",payload:{method:"readFile",args:[d,{encoding:"utf8"}]}})),Ve=(d,b)=>Se(je({id:b,action:"FS",payload:{method:"unlink",args:[d]}})),_t=(d,b,I)=>Se(je({id:I,action:"FS",payload:{method:d,args:b}})),qe=(d,b)=>Se(je({id:b,action:"loadLanguage",payload:{langs:d,options:{langPath:T.langPath,dataPath:T.dataPath,cachePath:T.cachePath,cacheMethod:T.cacheMethod,gzip:T.gzip,lstmOnly:[Ye.DEFAULT,Ye.LSTM_ONLY].includes(we)&&!T.legacyLang}}})),nt=(d,b,I,w)=>Se(je({id:w,action:"initialize",payload:{langs:d,oem:b,config:I}})),St=(d="eng",b,I,w)=>{if(pe&&[Ye.TESSERACT_ONLY,Ye.TESSERACT_LSTM_COMBINED].includes(b))throw Error("Legacy model requested but code missing.");let O=b||we;we=O;let te=I||H;H=te;let xe=(typeof d=="string"?d.split("+"):d).filter(_e=>!U.includes(_e));return U.push(...xe),xe.length>0?qe(xe,w).then(()=>nt(d,O,te,w)):nt(d,O,te,w)},ni=(d={},b)=>Se(je({id:b,action:"setParameters",payload:{params:d}})),rt=async(d,b={},I={text:!0},w)=>Se(je({id:w,action:"recognize",payload:{image:await on(d),options:b,output:I}})),at=async(d,b)=>{if(pe)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return Se(je({id:b,action:"detect",payload:{image:await on(d)}}))},ot=async()=>(Ae!==null&&(Na(Ae),Ae=null),Promise.resolve());Va(Ae,({workerId:d,jobId:b,status:I,action:w,data:O})=>{let te=`${w}-${b}`;if(I==="resolve")an(`[${d}]: Complete ${b}`),R[te].resolve({jobId:b,data:O}),delete R[te];else if(I==="reject")if(R[te].reject(O),delete R[te],w==="load"&&Fe(O),y)y(O);else throw Error(O);else I==="progress"&&v(M(C({},O),{userJobId:b}))});let ht={id:s,worker:Ae,load:Ne,writeText:it,readText:ze,removeFile:Ve,FS:_t,reinitialize:St,setParameters:ni,recognize:rt,detect:at,terminate:ot};return tt().then(()=>qe(r)).then(()=>nt(r,n,o)).then(()=>ke(ht)).catch(()=>{}),ge}});var un=le((T0,dn)=>{"use strict";var mn=vi(),$a=async(r,n,e)=>{let o=await mn(n,1,e);return o.recognize(r).finally(async()=>{await o.terminate()})},Ma=async(r,n)=>{let e=await mn("osd",0,n);return e.detect(r).finally(async()=>{await e.terminate()})};dn.exports={recognize:$a,detect:Ma}});var cn=le((D0,pn)=>{"use strict";pn.exports={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}});var fn=le((I0,vn)=>{"use strict";vn.exports={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}});var gn=le((L0,bn)=>{"use strict";Ti();var qa=Pi(),Ga=vi(),Ua=un(),Ha=cn(),Ja=ui(),Ya=fn(),{setLogging:za}=Gt();bn.exports=C({languages:Ha,OEM:Ja,PSM:Ya,createScheduler:qa,createWorker:Ga,setLogging:za},Ua)});var Cn=[{id:"1",name:"Alice Chen",email:"alice@example.com",roleIds:["admin"],status:"active",departmentId:1,departmentName:"\u7BA1\u7406\u90E8",jobTitleId:4,jobTitleName:"\u90E8\u9580\u4E3B\u7BA1",hireDate:new Date("2022-03-01"),baseSalary:8e4,createdAt:new Date("2024-01-01")},{id:"2",name:"Bob Wang",email:"bob@example.com",roleIds:["manager"],status:"active",departmentId:2,departmentName:"\u8CC7\u8A0A\u90E8",jobTitleId:2,jobTitleName:"\u8CC7\u6DF1\u5DE5\u7A0B\u5E2B",hireDate:new Date("2023-06-15"),baseSalary:6e4,agentUserId:"1",agentName:"Alice Chen",createdAt:new Date("2024-02-10")},{id:"3",name:"Carol Liu",email:"carol@example.com",roleIds:["viewer"],status:"inactive",departmentId:3,departmentName:"\u696D\u52D9\u90E8",jobTitleId:1,jobTitleName:"\u5DE5\u7A0B\u5E2B",hireDate:new Date("2023-09-01"),resignDate:new Date("2025-01-31"),baseSalary:5e4,createdAt:new Date("2024-03-05")}],We=class r{http=p(me);items$=new ne(Cn);getAll(){return this.items$.asObservable()}getById(n){return L(this.items$.getValue().find(e=>e.id===n))}create(n){let e=M(C({},n),{id:Date.now().toString(),createdAt:new Date});return this.items$.next([...this.items$.getValue(),e]),L(e)}update(n,e){let o=this.items$.getValue().map(s=>s.id===n?C(C({},s),e):s);return this.items$.next(o),L(o.find(s=>s.id===n))}delete(n){return this.items$.next(this.items$.getValue().filter(e=>e.id!==n)),L(void 0)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=se({token:r,factory:r.\u0275fac,providedIn:"root"})};var yn=[{id:"admin",name:"Administrator",description:"Full system access",permissionCodes:["admin:access","users:read","users:write","users:delete","roles:read","roles:write","roles:delete","permissions:read","permissions:write","permissions:delete","departments:read","departments:write","departments:delete","job-titles:read","job-titles:write","job-titles:delete","approvals:read","approvals:write","approvals:delete","projects:read","projects:write","projects:delete","payment-requests:read","payment-requests:write","payment-requests:delete","approval-tasks:read","approval-tasks:write"],createdAt:new Date("2024-01-01")},{id:"manager",name:"Manager",description:"Can manage users and view reports",permissionCodes:["admin:access","users:read","users:write","roles:read"],createdAt:new Date("2024-01-15")},{id:"viewer",name:"Viewer",description:"Read-only access",permissionCodes:["users:read","roles:read","permissions:read"],createdAt:new Date("2024-02-01")}],Be=class r{http=p(me);items$=new ne(yn);getAll(){return this.items$.asObservable()}getById(n){return L(this.items$.getValue().find(e=>e.id===n))}create(n){let e=M(C({},n),{id:Date.now().toString(),createdAt:new Date});return this.items$.next([...this.items$.getValue(),e]),L(e)}update(n,e){let o=this.items$.getValue().map(s=>s.id===n?C(C({},s),e):s);return this.items$.next(o),L(o.find(s=>s.id===n))}delete(n){return this.items$.next(this.items$.getValue().filter(e=>e.id!==n)),L(void 0)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=se({token:r,factory:r.\u0275fac,providedIn:"root"})};var An=r=>[r,"edit"],wn=r=>[r],Fn=(r,n)=>n.id;function Tn(r,n){if(r&1&&(t(0,"div",20),a(1),i()),r&2){let e=u().$implicit;l(),E("\u4EE3\u7406\u4EBA\uFF1A",e.agentName)}}function Dn(r,n){if(r&1&&(t(0,"div",23),a(1),D(2,"date"),i()),r&2){let e=u().$implicit;l(),E("\u96E2\u8077\uFF1A",$(2,1,e.resignDate,"yyyy-MM-dd"))}}function In(r,n){if(r&1&&(t(0,"span",24),a(1),i()),r&2){let e=n.$implicit,o=u(2);l(),c(o.getRoleNames(re(1,wn,e)))}}function Ln(r,n){if(r&1){let e=q();t(0,"tr")(1,"td")(2,"div",19),a(3),i(),g(4,Tn,2,1,"div",20),i(),t(5,"td",21),a(6),i(),t(7,"td",15),a(8),i(),t(9,"td",15),a(10),i(),t(11,"td",22),a(12),D(13,"date"),g(14,Dn,3,4,"div",23),i(),t(15,"td",16),a(16),D(17,"currency"),i(),t(18,"td"),k(19,In,2,3,"span",24,Ke),i(),t(21,"td",17)(22,"span",25),a(23),i()(),t(24,"td",26)(25,"div",27)(26,"a",28),f(),t(27,"svg",7),m(28,"use",29),i()(),h(),t(29,"button",30),A("click",function(){let s=j(e).$implicit,v=u();return N(v.delete(s))}),f(),t(30,"svg",7),m(31,"use",31),i()()()()()}if(r&2){let e=n.$implicit;l(3),c(e.name),l(),x(e.agentName?4:-1),l(2),c(e.email),l(2),E(" ",e.departmentName||"\u2014"," "),l(2),E(" ",e.jobTitleName||"\u2014"," "),l(2),E(" ",e.hireDate?$(13,14,e.hireDate,"yyyy-MM-dd"):"\u2014"," "),l(2),x(e.resignDate?14:-1),l(2),E(" ",e.baseSalary?xi(17,17,e.baseSalary,"TWD","symbol","1.0-0"):"\u2014"," "),l(3),B(e.roleIds),l(3),At("bg-success",e.status==="active")("bg-secondary",e.status==="inactive"),l(),E(" ",e.status==="active"?"\u5728\u8077":"\u96E2\u8077"," "),l(3),_("routerLink",re(22,An,e.id))}}function kn(r,n){r&1&&(t(0,"tr")(1,"td",32),a(2,"\u5C1A\u7121\u54E1\u5DE5\u8CC7\u6599\u3002"),i()())}var Tt=class r{userService=p(We);roleService=p(Be);users$=this.userService.getAll();roles=[];ngOnInit(){this.roleService.getAll().subscribe(n=>this.roles=n)}getRoleNames(n){return n.map(e=>this.roles.find(o=>o.id===e)?.name??e).join(", ")}delete(n){confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u54E1\u5DE5\u300C${n.name}\u300D\u55CE\uFF1F`)&&this.userService.delete(n.id).subscribe()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-user-list"]],decls:40,vars:3,consts:[[1,"container-fluid","py-3"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between","gap-2","mb-4"],[1,"d-flex","align-items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#user"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","d-inline-flex","align-items-center","gap-1","waves-effect","waves-light"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"d-none","d-md-table-cell"],[1,"d-none","d-lg-table-cell"],[1,"d-none","d-xl-table-cell"],[1,"d-none","d-sm-table-cell"],[1,"text-end"],[1,"fw-500"],[1,"text-muted","small"],[1,"text-muted","d-none","d-md-table-cell"],[1,"text-muted","small","d-none","d-xl-table-cell"],[1,"text-danger"],[1,"badge","bg-secondary","me-1"],[1,"badge"],[1,"text-end",2,"white-space","nowrap"],[1,"d-flex","justify-content-end","gap-1"],[1,"btn","btn-sm","btn-ghost-primary","d-inline-flex","align-items-center","waves-effect",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],[1,"btn","btn-sm","btn-ghost-danger","d-inline-flex","align-items-center","waves-effect",3,"click"],["href","/assets/icons/sprite.svg#trash"],["colspan","9",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),f(),t(3,"svg",3),m(4,"use",4),i(),h(),t(5,"h4",5),a(6,"\u54E1\u5DE5\u7BA1\u7406"),i()(),t(7,"a",6),f(),t(8,"svg",7),m(9,"use",8),i(),a(10," \u65B0\u589E\u54E1\u5DE5 "),i()(),h(),t(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u59D3\u540D"),i(),t(19,"th",14),a(20,"Email"),i(),t(21,"th",15),a(22,"\u90E8\u9580"),i(),t(23,"th",15),a(24,"\u8077\u7A31"),i(),t(25,"th",16),a(26,"\u5165\u8077\u65E5"),i(),t(27,"th",16),a(28,"\u5E95\u85AA"),i(),t(29,"th"),a(30,"\u89D2\u8272"),i(),t(31,"th",17),a(32,"\u72C0\u614B"),i(),t(33,"th",18),a(34,"\u64CD\u4F5C"),i()()(),t(35,"tbody"),k(36,Ln,32,24,"tr",null,Fn,!1,kn,3,0,"tr"),D(39,"async"),i()()()()()()),e&2&&(l(36),B(ie(39,1,o.users$)))},dependencies:[V,ae,ve,Si],encapsulation:2})};var Bn=[{id:1,name:"\u7BA1\u7406\u90E8",code:"MGT",sortOrder:1,employeeCount:1,createdAt:new Date("2024-01-01")},{id:2,name:"\u8CC7\u8A0A\u90E8",code:"IT",sortOrder:2,employeeCount:1,createdAt:new Date("2024-01-01")},{id:3,name:"\u696D\u52D9\u90E8",code:"SLS",sortOrder:3,employeeCount:1,createdAt:new Date("2024-01-01")}],Ie=class r{http=p(me);items$=new ne(Bn);getAll(){return this.items$.asObservable()}getById(n){return L(this.items$.getValue().find(e=>e.id===n))}create(n){let e=M(C({},n),{id:Date.now(),employeeCount:0,createdAt:new Date});return this.items$.next([...this.items$.getValue(),e]),L(e)}update(n,e){let o=this.items$.getValue().map(s=>s.id===n?C(C({},s),e):s);return this.items$.next(o),L(o.find(s=>s.id===n))}delete(n){return this.items$.next(this.items$.getValue().filter(e=>e.id!==n)),L(void 0)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=se({token:r,factory:r.\u0275fac,providedIn:"root"})};var Rn=[{id:1,name:"\u5DE5\u7A0B\u5E2B",level:1,employeeCount:1,createdAt:new Date("2024-01-01")},{id:2,name:"\u8CC7\u6DF1\u5DE5\u7A0B\u5E2B",level:2,employeeCount:1,createdAt:new Date("2024-01-01")},{id:3,name:"\u4E3B\u4EFB\u5DE5\u7A0B\u5E2B",level:3,employeeCount:0,createdAt:new Date("2024-01-01")},{id:4,name:"\u90E8\u9580\u4E3B\u7BA1",level:4,employeeCount:1,createdAt:new Date("2024-01-01")}],Re=class r{http=p(me);items$=new ne(Rn);getAll(){return this.items$.asObservable()}getById(n){return L(this.items$.getValue().find(e=>e.id===n))}create(n){let e=M(C({},n),{id:Date.now(),employeeCount:0,createdAt:new Date});return this.items$.next([...this.items$.getValue(),e]),L(e)}update(n,e){let o=this.items$.getValue().map(s=>s.id===n?C(C({},s),e):s);return this.items$.next(o),L(o.find(s=>s.id===n))}delete(n){return this.items$.next(this.items$.getValue().filter(e=>e.id!==n)),L(void 0)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=se({token:r,factory:r.\u0275fac,providedIn:"root"})};var Dt=(r,n)=>n.id;function Pn(r,n){r&1&&(t(0,"div",17),a(1,"\u8ACB\u8F38\u5165\u59D3\u540D\u3002"),i())}function jn(r,n){r&1&&(t(0,"div",17),a(1,"\u8ACB\u8F38\u5165\u6709\u6548\u7684\u96FB\u5B50\u90F5\u4EF6\u3002"),i())}function Nn(r,n){if(r&1&&(t(0,"div",23),m(1,"input",38),t(2,"label",39),a(3),i()()),r&2){let e=n.$implicit;l(),_("id","role-"+e.id)("value",e.id),l(),_("for","role-"+e.id),l(),c(e.name)}}function Vn(r,n){r&1&&(t(0,"div",17),a(1,"\u8ACB\u9078\u64C7\u89D2\u8272\u3002"),i())}function On(r,n){if(r&1&&(t(0,"option",25),a(1),i()),r&2){let e=n.$implicit;_("ngValue",e.id),l(),c(e.name)}}function $n(r,n){if(r&1&&(t(0,"option",25),a(1),i()),r&2){let e=n.$implicit;_("ngValue",e.id),l(),Te("",e.name,"\uFF08L",e.level,"\uFF09")}}function Mn(r,n){if(r&1&&(t(0,"option",34),a(1),i()),r&2){let e=n.$implicit;_("value",e.id),l(),c(e.name)}}var st=class r{fb=p(Z);userService=p(We);roleService=p(Be);deptService=p(Ie);jtService=p(Re);route=p(de);router=p(ce);roles=[];departments=[];jobTitles=[];allUsers=[];isEdit=!1;userId="";form=this.fb.group({name:["",F.required],email:["",[F.required,F.email]],roleId:["",F.required],status:["active",F.required],departmentId:[null],jobTitleId:[null],hireDate:[""],resignDate:[""],baseSalary:[null],agentUserId:[""]});ngOnInit(){this.roleService.getAll().subscribe(n=>this.roles=n),this.deptService.getAll().subscribe(n=>this.departments=n),this.jtService.getAll().subscribe(n=>this.jobTitles=n),this.userService.getAll().subscribe(n=>this.allUsers=n),this.userId=this.route.snapshot.paramMap.get("id")??"",this.userId&&(this.isEdit=!0,this.userService.getById(this.userId).subscribe(n=>{n&&this.form.patchValue(M(C({},n),{roleId:n.roleIds[0]??"",departmentId:n.departmentId??null,jobTitleId:n.jobTitleId??null,hireDate:n.hireDate?this.toDateString(n.hireDate):"",resignDate:n.resignDate?this.toDateString(n.resignDate):"",baseSalary:n.baseSalary??null,agentUserId:n.agentUserId??""}))}))}getAvailableAgents(){return this.allUsers.filter(n=>n.id!==this.userId)}toDateString(n){return new Date(n).toISOString().substring(0,10)}submit(){if(this.form.invalid)return;let ge=this.form.value,{roleId:n,hireDate:e,resignDate:o,departmentId:s,jobTitleId:v,agentUserId:y}=ge,T=Et(ge,["roleId","hireDate","resignDate","departmentId","jobTitleId","agentUserId"]),R=s||void 0,U=v||void 0,we=R?this.departments.find(ee=>ee.id===R)?.name:void 0,H=U?this.jobTitles.find(ee=>ee.id===U)?.name:void 0,pe=y?this.allUsers.find(ee=>ee.id===y):void 0,Fe=M(C({},T),{roleIds:n?[n]:[],departmentId:R,departmentName:we,jobTitleId:U,jobTitleName:H,hireDate:e?new Date(e):void 0,resignDate:o?new Date(o):void 0,agentUserId:y||void 0,agentName:pe?.name});(this.isEdit?this.userService.update(this.userId,Fe):this.userService.create(Fe)).subscribe(()=>this.router.navigate(["/admin/users"]))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-user-form"]],decls:95,vars:9,consts:[[1,"container-fluid","py-3"],[1,"d-flex","align-items-center","gap-2","mb-4"],["routerLink","/admin/users",1,"btn","btn-sm","btn-outline-secondary","waves-effect"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],[1,"row"],[1,"col-12","col-xl-8"],[3,"ngSubmit","formGroup"],[1,"card","border-0","shadow-sm","mb-3"],[1,"card-header","bg-transparent","fw-500"],[1,"card-body"],[1,"row","g-3"],[1,"col-12","col-md-6"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","name","placeholder","\u8ACB\u8F38\u5165\u59D3\u540D",1,"form-control"],[1,"text-danger","small","mt-1"],["type","email","formControlName","email","placeholder","user@example.com",1,"form-control"],["formControlName","status",1,"form-select"],["value","active"],["value","inactive"],[1,"d-flex","flex-wrap","gap-3","mt-1"],[1,"form-check"],["formControlName","departmentId",1,"form-select"],[3,"ngValue"],["formControlName","jobTitleId",1,"form-select"],["type","date","formControlName","hireDate",1,"form-control"],["type","date","formControlName","resignDate",1,"form-control"],[1,"input-group"],[1,"input-group-text"],["type","number","formControlName","baseSalary","placeholder","\u4F8B\u5982\uFF1A50000","min","0",1,"form-control"],["formControlName","agentUserId",1,"form-select"],["value",""],[3,"value"],[1,"d-flex","gap-2"],["type","submit",1,"btn","btn-primary","waves-effect","waves-light",3,"disabled"],["routerLink","/admin/users",1,"btn","btn-outline-secondary","waves-effect"],["type","radio","name","roleId","formControlName","roleId",1,"form-check-input",3,"id","value"],[1,"form-check-label",3,"for"]],template:function(e,o){if(e&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),f(),t(3,"svg",3),m(4,"use",4),i()(),h(),t(5,"h4",5),a(6),i()(),t(7,"div",6)(8,"div",7)(9,"form",8),A("ngSubmit",function(){return o.submit()}),t(10,"div",9)(11,"div",10),a(12,"\u57FA\u672C\u8CC7\u6599"),i(),t(13,"div",11)(14,"div",12)(15,"div",13)(16,"label",14),a(17,"\u59D3\u540D "),t(18,"span",15),a(19,"*"),i()(),m(20,"input",16),g(21,Pn,2,0,"div",17),i(),t(22,"div",13)(23,"label",14),a(24,"Email "),t(25,"span",15),a(26,"*"),i()(),m(27,"input",18),g(28,jn,2,0,"div",17),i(),t(29,"div",13)(30,"label",14),a(31,"\u72C0\u614B"),i(),t(32,"select",19)(33,"option",20),a(34,"\u5728\u8077"),i(),t(35,"option",21),a(36,"\u96E2\u8077"),i()()(),t(37,"div",13)(38,"label",14),a(39,"\u89D2\u8272 "),t(40,"span",15),a(41,"*"),i()(),t(42,"div",22),k(43,Nn,4,4,"div",23,Dt),i(),g(45,Vn,2,0,"div",17),i()()()(),t(46,"div",9)(47,"div",10),a(48,"\u54E1\u5DE5\u8CC7\u8A0A"),i(),t(49,"div",11)(50,"div",12)(51,"div",13)(52,"label",14),a(53,"\u90E8\u9580"),i(),t(54,"select",24)(55,"option",25),a(56,"\u2014 \u672A\u6307\u5B9A \u2014"),i(),k(57,On,2,2,"option",25,Dt),i()(),t(59,"div",13)(60,"label",14),a(61,"\u8077\u7A31"),i(),t(62,"select",26)(63,"option",25),a(64,"\u2014 \u672A\u6307\u5B9A \u2014"),i(),k(65,$n,2,3,"option",25,Dt),i()(),t(67,"div",13)(68,"label",14),a(69,"\u5165\u8077\u65E5"),i(),m(70,"input",27),i(),t(71,"div",13)(72,"label",14),a(73,"\u96E2\u8077\u65E5"),i(),m(74,"input",28),i(),t(75,"div",13)(76,"label",14),a(77,"\u5E95\u85AA"),i(),t(78,"div",29)(79,"span",30),a(80,"NT$"),i(),m(81,"input",31),i()(),t(82,"div",13)(83,"label",14),a(84,"\u8077\u52D9\u4EE3\u7406\u4EBA"),i(),t(85,"select",32)(86,"option",33),a(87,"\u2014 \u7121\u4EE3\u7406\u4EBA \u2014"),i(),k(88,Mn,2,2,"option",34,Dt),i()()()()(),t(90,"div",35)(91,"button",36),a(92),i(),t(93,"a",37),a(94,"\u53D6\u6D88"),i()()()()()()),e&2){let s,v,y;l(6),c(o.isEdit?"\u7DE8\u8F2F\u54E1\u5DE5":"\u65B0\u589E\u54E1\u5DE5"),l(3),_("formGroup",o.form),l(12),x((s=o.form.get("name"))!=null&&s.invalid&&((s=o.form.get("name"))!=null&&s.touched)?21:-1),l(7),x((v=o.form.get("email"))!=null&&v.invalid&&((v=o.form.get("email"))!=null&&v.touched)?28:-1),l(15),B(o.roles),l(2),x((y=o.form.get("roleId"))!=null&&y.invalid&&((y=o.form.get("roleId"))!=null&&y.touched)?45:-1),l(10),_("ngValue",null),l(2),B(o.departments),l(6),_("ngValue",null),l(2),B(o.jobTitles),l(23),B(o.getAvailableAgents()),l(3),_("disabled",o.form.invalid),l(),E(" ",o.isEdit?"\u66F4\u65B0":"\u5EFA\u7ACB"," ")}},dependencies:[X,K,Ce,ye,J,fe,Ee,$e,Y,z,be,Q,W,V],encapsulation:2})};var qn=r=>[r,"edit"],Gn=(r,n)=>n.id;function Un(r,n){if(r&1){let e=q();t(0,"tr")(1,"td",17),a(2),i(),t(3,"td",18),a(4),i(),t(5,"td")(6,"span",19),a(7),i()(),t(8,"td",20),a(9),D(10,"date"),i(),t(11,"td",21)(12,"div",22)(13,"a",23),f(),t(14,"svg",7),m(15,"use",24),i()(),h(),t(16,"button",25),A("click",function(){let s=j(e).$implicit,v=u();return N(v.delete(s))}),f(),t(17,"svg",7),m(18,"use",26),i()()()()()}if(r&2){let e=n.$implicit;l(2),c(e.name),l(2),c(e.description),l(3),E("",e.permissionCodes.length," \u500B\u6B0A\u9650"),l(2),c($(10,5,e.createdAt,"yyyy-MM-dd")),l(4),_("routerLink",re(8,qn,e.id))}}function Hn(r,n){r&1&&(t(0,"tr")(1,"td",27),a(2,"\u5C1A\u7121\u89D2\u8272\u8CC7\u6599\u3002"),i()())}var It=class r{roleService=p(Be);roles$=this.roleService.getAll();delete(n){confirm(`Delete role "${n.name}"?`)&&this.roleService.delete(n.id).subscribe()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-role-list"]],decls:32,vars:3,consts:[[1,"container-fluid","py-3"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between","gap-2","mb-4"],[1,"d-flex","align-items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#shield"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","d-inline-flex","align-items-center","gap-1","waves-effect","waves-light"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"d-none","d-md-table-cell"],[1,"d-none","d-lg-table-cell"],[1,"text-end"],[1,"fw-500"],[1,"text-muted","d-none","d-md-table-cell"],[1,"badge","bg-info"],[1,"text-muted","d-none","d-lg-table-cell"],[1,"text-end",2,"white-space","nowrap"],[1,"d-flex","justify-content-end","gap-1"],[1,"btn","btn-sm","btn-ghost-primary","d-inline-flex","align-items-center","waves-effect",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],[1,"btn","btn-sm","btn-ghost-danger","d-inline-flex","align-items-center","waves-effect",3,"click"],["href","/assets/icons/sprite.svg#trash"],["colspan","5",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),f(),t(3,"svg",3),m(4,"use",4),i(),h(),t(5,"h4",5),a(6,"\u89D2\u8272\u7BA1\u7406"),i()(),t(7,"a",6),f(),t(8,"svg",7),m(9,"use",8),i(),a(10," \u65B0\u589E\u89D2\u8272 "),i()(),h(),t(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u540D\u7A31"),i(),t(19,"th",14),a(20,"\u63CF\u8FF0"),i(),t(21,"th"),a(22,"\u6B0A\u9650"),i(),t(23,"th",15),a(24,"\u5EFA\u7ACB\u65E5\u671F"),i(),t(25,"th",16),a(26,"\u64CD\u4F5C"),i()()(),t(27,"tbody"),k(28,Un,19,10,"tr",null,Gn,!1,Hn,3,0,"tr"),D(31,"async"),i()()()()()()),e&2&&(l(28),B(ie(31,1,o.roles$)))},dependencies:[V,ae,ve],encapsulation:2})};var Jn=[{id:"1",code:"admin:access",name:"Admin Access",module:"Admin"},{id:"2",code:"users:read",name:"View Users",module:"Users"},{id:"3",code:"users:write",name:"Create/Edit Users",module:"Users"},{id:"4",code:"users:delete",name:"Delete Users",module:"Users"},{id:"5",code:"roles:read",name:"View Roles",module:"Roles"},{id:"6",code:"roles:write",name:"Create/Edit Roles",module:"Roles"},{id:"7",code:"roles:delete",name:"Delete Roles",module:"Roles"},{id:"8",code:"permissions:read",name:"View Permissions",module:"Permissions"},{id:"9",code:"permissions:write",name:"Create/Edit Permissions",module:"Permissions"},{id:"10",code:"permissions:delete",name:"Delete Permissions",module:"Permissions"},{id:"11",code:"departments:read",name:"View Departments",module:"Departments"},{id:"12",code:"departments:write",name:"Create/Edit Departments",module:"Departments"},{id:"13",code:"departments:delete",name:"Delete Departments",module:"Departments"},{id:"14",code:"job-titles:read",name:"View Job Titles",module:"JobTitles"},{id:"15",code:"job-titles:write",name:"Create/Edit Job Titles",module:"JobTitles"},{id:"16",code:"job-titles:delete",name:"Delete Job Titles",module:"JobTitles"},{id:"17",code:"approvals:read",name:"View Approvals",module:"Approvals"},{id:"18",code:"approvals:write",name:"Create/Edit Approvals",module:"Approvals"},{id:"19",code:"approvals:delete",name:"Delete Approvals",module:"Approvals"},{id:"20",code:"projects:read",name:"View Projects",module:"Projects"},{id:"21",code:"projects:write",name:"Create/Edit Projects",module:"Projects"},{id:"22",code:"projects:delete",name:"Delete Projects",module:"Projects"},{id:"23",code:"payment-requests:read",name:"View Payment Requests",module:"PaymentRequests"},{id:"24",code:"payment-requests:write",name:"Create/Edit Payment Requests",module:"PaymentRequests"},{id:"25",code:"payment-requests:delete",name:"Delete Payment Requests",module:"PaymentRequests"},{id:"26",code:"approval-tasks:read",name:"View Approval Tasks",module:"ApprovalTasks"},{id:"27",code:"approval-tasks:write",name:"Review Approval Tasks",module:"ApprovalTasks"},{id:"28",code:"leave-requests:read",name:"View Leave Requests",module:"LeaveRequests"},{id:"29",code:"leave-requests:write",name:"Create/Edit Leave Requests",module:"LeaveRequests"},{id:"30",code:"leave-requests:delete",name:"Delete Leave Requests",module:"LeaveRequests"},{id:"31",code:"travel-requests:read",name:"View Travel Requests",module:"TravelRequests"},{id:"32",code:"travel-requests:write",name:"Create/Edit Travel Requests",module:"TravelRequests"},{id:"33",code:"travel-requests:delete",name:"Delete Travel Requests",module:"TravelRequests"}],Me=class r{http=p(me);items$=new ne(Jn);getAll(){return this.items$.asObservable()}getById(n){return L(this.items$.getValue().find(e=>e.id===n))}getModules(){return[...new Set(this.items$.getValue().map(n=>n.module))]}create(n){let e=M(C({},n),{id:Date.now().toString()});return this.items$.next([...this.items$.getValue(),e]),L(e)}update(n,e){let o=this.items$.getValue().map(s=>s.id===n?C(C({},s),e):s);return this.items$.next(o),L(o.find(s=>s.id===n))}delete(n){return this.items$.next(this.items$.getValue().filter(e=>e.id!==n)),L(void 0)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=se({token:r,factory:r.\u0275fac,providedIn:"root"})};var Yn=(r,n)=>n.id;function zn(r,n){r&1&&(t(0,"div",15),a(1,"\u8ACB\u8F38\u5165\u89D2\u8272\u540D\u7A31\u3002"),i())}function Kn(r,n){if(r&1){let e=q();t(0,"div",27)(1,"input",24),A("change",function(){let s=j(e).$implicit,v=u(2);return N(v.togglePermission(s.code))}),i(),t(2,"label",28),a(3),i()()}if(r&2){let e=n.$implicit,o=u(2);l(),_("id","perm-"+e.id)("checked",o.isPermissionSelected(e.code)),l(),_("for","perm-"+e.id),l(),c(e.name)}}function Wn(r,n){if(r&1){let e=q();t(0,"div",11)(1,"div",23)(2,"input",24),A("change",function(s){let v=j(e).$implicit,y=u();return N(y.toggleModule(v,s.target.checked))}),i(),t(3,"label",25),a(4),i()(),t(5,"div",26),k(6,Kn,4,4,"div",27,Yn),i()()}if(r&2){let e=n.$implicit,o=u();l(2),_("id","module-"+e)("checked",o.isModuleAllSelected(e)),l(),_("for","module-"+e),l(),c(e),l(2),B(o.getPermissionsByModule(e))}}var mt=class r{fb=p(Z);roleService=p(Be);permissionService=p(Me);route=p(de);router=p(ce);permissions=[];modules=[];isEdit=!1;roleId="";form=this.fb.group({name:["",F.required],description:[""],permissionCodes:[[]]});ngOnInit(){this.permissionService.getAll().subscribe(n=>{this.permissions=n,this.modules=this.permissionService.getModules()}),this.roleId=this.route.snapshot.paramMap.get("id")??"",this.roleId&&(this.isEdit=!0,this.roleService.getById(this.roleId).subscribe(n=>{n&&this.form.patchValue(C({},n))}))}getPermissionsByModule(n){return this.permissions.filter(e=>e.module===n)}isPermissionSelected(n){return(this.form.value.permissionCodes??[]).includes(n)}togglePermission(n){let e=this.form.value.permissionCodes??[],o=e.includes(n)?e.filter(s=>s!==n):[...e,n];this.form.patchValue({permissionCodes:o})}toggleModule(n,e){let o=this.getPermissionsByModule(n).map(y=>y.code),s=this.form.value.permissionCodes??[],v=e?[...new Set([...s,...o])]:s.filter(y=>!o.includes(y));this.form.patchValue({permissionCodes:v})}isModuleAllSelected(n){return this.getPermissionsByModule(n).map(o=>o.code).every(o=>this.isPermissionSelected(o))}submit(){if(this.form.invalid)return;let n=this.form.value;(this.isEdit?this.roleService.update(this.roleId,n):this.roleService.create(n)).subscribe(()=>this.router.navigate(["/admin/roles"]))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-role-form"]],decls:36,vars:6,consts:[[1,"container-fluid","py-3"],[1,"d-flex","align-items-center","gap-2","mb-4"],["routerLink","/admin/roles",1,"btn","btn-sm","btn-outline-secondary","waves-effect"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],[1,"row"],[1,"col-12"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","name","placeholder","\u4F8B\u5982\uFF1A\u4E3B\u7BA1",1,"form-control"],[1,"text-danger","small","mt-1"],[1,"mb-4"],["type","text","formControlName","description","placeholder","\u7C21\u77ED\u63CF\u8FF0",1,"form-control"],[1,"border","rounded","p-3"],[1,"text-muted","small","mt-1"],[1,"d-flex","gap-2"],["type","submit",1,"btn","btn-primary","waves-effect","waves-light",3,"disabled"],["routerLink","/admin/roles",1,"btn","btn-outline-secondary","waves-effect"],[1,"d-flex","align-items-center","gap-2","mb-2"],["type","checkbox",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label","fw-600",3,"for"],[1,"d-flex","flex-wrap","gap-3","ms-4"],[1,"form-check"],[1,"form-check-label","small",3,"for"]],template:function(e,o){if(e&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),f(),t(3,"svg",3),m(4,"use",4),i()(),h(),t(5,"h4",5),a(6),i()(),t(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"form",10),A("ngSubmit",function(){return o.submit()}),t(12,"div",11)(13,"label",12),a(14,"\u89D2\u8272\u540D\u7A31 "),t(15,"span",13),a(16,"*"),i()(),m(17,"input",14),g(18,zn,2,0,"div",15),i(),t(19,"div",16)(20,"label",12),a(21,"\u63CF\u8FF0"),i(),m(22,"input",17),i(),t(23,"div",16)(24,"label",12),a(25,"\u6B0A\u9650"),i(),t(26,"div",18),k(27,Wn,8,4,"div",11,Ke),i(),t(29,"div",19),a(30),i()(),t(31,"div",20)(32,"button",21),a(33),i(),t(34,"a",22),a(35,"\u53D6\u6D88"),i()()()()()()()()),e&2){let s;l(6),c(o.isEdit?"\u7DE8\u8F2F\u89D2\u8272":"\u65B0\u589E\u89D2\u8272"),l(5),_("formGroup",o.form),l(7),x((s=o.form.get("name"))!=null&&s.invalid&&((s=o.form.get("name"))!=null&&s.touched)?18:-1),l(9),B(o.modules),l(3),E(" \u5DF2\u9078\u53D6 ",(o.form.value.permissionCodes==null?null:o.form.value.permissionCodes.length)??0," \u500B\u6B0A\u9650 "),l(2),_("disabled",o.form.invalid),l(),E(" ",o.isEdit?"\u66F4\u65B0":"\u5EFA\u7ACB"," ")}},dependencies:[X,K,J,Y,z,Q,W,V],encapsulation:2})};var Qn=r=>[r,"edit"],Zn=(r,n)=>n.id;function Xn(r,n){if(r&1){let e=q();t(0,"tr")(1,"td")(2,"code",19),a(3),i()(),t(4,"td",20),a(5),i(),t(6,"td",21),a(7),i(),t(8,"td",22)(9,"div",23)(10,"a",24),f(),t(11,"svg",7),m(12,"use",25),i()(),h(),t(13,"button",26),A("click",function(){let s=j(e).$implicit,v=u(2);return N(v.delete(s))}),f(),t(14,"svg",7),m(15,"use",27),i()()()()()}if(r&2){let e=n.$implicit;l(3),c(e.code),l(2),c(e.name),l(2),c(e.description??"\u2014"),l(3),_("routerLink",re(4,Qn,e.id))}}function er(r,n){if(r&1&&(t(0,"div",9)(1,"div",10),f(),t(2,"svg",11),m(3,"use",12),i(),a(4),i(),h(),t(5,"div",13)(6,"div",14)(7,"table",15)(8,"thead",16)(9,"tr")(10,"th"),a(11,"\u4EE3\u78BC"),i(),t(12,"th"),a(13,"\u540D\u7A31"),i(),t(14,"th",17),a(15,"\u63CF\u8FF0"),i(),t(16,"th",18),a(17,"\u64CD\u4F5C"),i()()(),t(18,"tbody"),k(19,Xn,16,6,"tr",null,Zn),i()()()()()),r&2){let e=n.$implicit,o=u();l(4),E(" ",e," "),l(15),B(o.getByModule(e))}}var Lt=class r{permissionService=p(Me);modules=this.permissionService.getModules();allPermissions=[];constructor(){this.permissionService.getAll().subscribe(n=>this.allPermissions=n)}getByModule(n){return this.allPermissions.filter(e=>e.module===n)}delete(n){confirm(`Delete permission "${n.name}"?`)&&this.permissionService.delete(n.id).subscribe()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-permission-list"]],decls:13,vars:0,consts:[[1,"container-fluid","py-3"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between","gap-2","mb-4"],[1,"d-flex","align-items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#lock"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","d-inline-flex","align-items-center","gap-1","waves-effect","waves-light"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm","mb-3"],[1,"card-header","bg-light","fw-600","d-flex","align-items-center"],[1,"sa-icon","me-2","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#folder"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"d-none","d-md-table-cell"],[1,"text-end"],[1,"text-primary"],[1,"fw-500"],[1,"text-muted","d-none","d-md-table-cell"],[1,"text-end",2,"white-space","nowrap"],[1,"d-flex","justify-content-end","gap-1"],[1,"btn","btn-sm","btn-ghost-primary","d-inline-flex","align-items-center","waves-effect",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],[1,"btn","btn-sm","btn-ghost-danger","d-inline-flex","align-items-center","waves-effect",3,"click"],["href","/assets/icons/sprite.svg#trash"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),f(),t(3,"svg",3),m(4,"use",4),i(),h(),t(5,"h4",5),a(6,"\u6B0A\u9650\u7BA1\u7406"),i()(),t(7,"a",6),f(),t(8,"svg",7),m(9,"use",8),i(),a(10," \u65B0\u589E\u6B0A\u9650 "),i()(),k(11,er,21,1,"div",9,Ke),i()),e&2&&(l(11),B(o.modules))},dependencies:[V],encapsulation:2})};var dt=class r{fb=p(Z);service=p(Me);route=p(de);router=p(ce);isEdit=!1;permId="";form=this.fb.group({code:["",F.required],name:["",F.required],module:["",F.required],description:[""]});ngOnInit(){this.permId=this.route.snapshot.paramMap.get("id")??"",this.permId&&(this.isEdit=!0,this.service.getById(this.permId).subscribe(n=>{n&&this.form.patchValue(C({},n))}))}submit(){if(this.form.invalid)return;let n=this.form.value;(this.isEdit?this.service.update(this.permId,n):this.service.create(n)).subscribe(()=>this.router.navigate(["/admin/permissions"]))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-permission-form"]],decls:46,vars:4,consts:[[1,"container-fluid","py-3"],[1,"d-flex","align-items-center","gap-2","mb-4"],["routerLink","/admin/permissions",1,"btn","btn-sm","btn-outline-secondary","waves-effect"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],[1,"row"],[1,"col-12"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","code","placeholder","module:action",1,"form-control","font-monospace"],[1,"text-muted","small","mt-1"],["type","text","formControlName","name","placeholder","\u986F\u793A\u540D\u7A31",1,"form-control"],["type","text","formControlName","module","placeholder","\u4F8B\u5982\uFF1AUsers\u3001Roles",1,"form-control"],[1,"mb-4"],["type","text","formControlName","description","placeholder","\u9078\u586B\u8AAA\u660E",1,"form-control"],[1,"d-flex","gap-2"],["type","submit",1,"btn","btn-primary","waves-effect","waves-light",3,"disabled"],["routerLink","/admin/permissions",1,"btn","btn-outline-secondary","waves-effect"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),f(),t(3,"svg",3),m(4,"use",4),i()(),h(),t(5,"h4",5),a(6),i()(),t(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"form",10),A("ngSubmit",function(){return o.submit()}),t(12,"div",11)(13,"label",12),a(14,"\u4EE3\u78BC "),t(15,"span",13),a(16,"*"),i()(),m(17,"input",14),t(18,"div",15),a(19,"\u4F8B\u5982\uFF1A"),t(20,"code"),a(21,"users:read"),i(),a(22,"\u3001"),t(23,"code"),a(24,"roles:write"),i()()(),t(25,"div",11)(26,"label",12),a(27,"\u540D\u7A31 "),t(28,"span",13),a(29,"*"),i()(),m(30,"input",16),i(),t(31,"div",11)(32,"label",12),a(33,"\u6A21\u7D44 "),t(34,"span",13),a(35,"*"),i()(),m(36,"input",17),i(),t(37,"div",18)(38,"label",12),a(39,"\u63CF\u8FF0"),i(),m(40,"input",19),i(),t(41,"div",20)(42,"button",21),a(43),i(),t(44,"a",22),a(45,"\u53D6\u6D88"),i()()()()()()()()),e&2&&(l(6),c(o.isEdit?"\u7DE8\u8F2F\u6B0A\u9650":"\u65B0\u589E\u6B0A\u9650"),l(5),_("formGroup",o.form),l(31),_("disabled",o.form.invalid),l(),E(" ",o.isEdit?"\u66F4\u65B0":"\u5EFA\u7ACB"," "))},dependencies:[X,K,J,Y,z,Q,W,V],encapsulation:2})};var tr={workStartTime:"09:00",workEndTime:"18:00",monthlyOvertimeLimit:46},kt=class r{http=p(me);settings$=new ne(tr);get(){return this.settings$.asObservable()}save(n){let e=C(C({},this.settings$.getValue()),n);return this.settings$.next(e),L(e)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=se({token:r,factory:r.\u0275fac,providedIn:"root"})};function ir(r,n){r&1&&(t(0,"div",5),f(),t(1,"svg",24),m(2,"use",26),i(),a(3," \u8A2D\u5B9A\u5DF2\u5132\u5B58\u6210\u529F\u3002 "),i())}function nr(r,n){r&1&&(t(0,"div",21),a(1,"\u8ACB\u8F38\u5165 0 \u5230 200 \u4E4B\u9593\u7684\u6578\u503C\u3002"),i())}var Bt=class r{fb=p(Z);settingsService=p(kt);saved=!1;form=this.fb.group({workStartTime:["09:00",F.required],workEndTime:["18:00",F.required],monthlyOvertimeLimit:[46,[F.required,F.min(0),F.max(200)]]});ngOnInit(){this.settingsService.get().subscribe(n=>this.form.patchValue(n))}submit(){this.form.invalid||this.settingsService.save(this.form.value).subscribe(()=>{this.saved=!0,setTimeout(()=>this.saved=!1,3e3)})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-settings"]],decls:40,vars:4,consts:[[1,"container-fluid","py-3"],[1,"d-flex","align-items-center","gap-2","mb-4"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#settings"],[1,"mb-0"],["role","alert",1,"alert","alert-success","d-flex","align-items-center","gap-2","mb-4","py-2"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-md-6","col-xl-4"],[1,"card","border-0","shadow-sm"],[1,"card-header","bg-transparent","border-bottom","d-flex","align-items-center","gap-2","fw-600"],[1,"sa-icon","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#clock"],[1,"card-body"],[1,"mb-3"],[1,"form-label","fw-500"],[1,"text-danger"],["type","time","formControlName","workStartTime",1,"form-control"],["type","time","formControlName","workEndTime",1,"form-control"],[1,"text-muted","fw-400"],["type","number","formControlName","monthlyOvertimeLimit","min","0","max","200",1,"form-control"],[1,"text-danger","small","mt-1"],[1,"col-12"],["type","submit",1,"btn","btn-primary","d-inline-flex","align-items-center","gap-1","waves-effect","waves-light",3,"disabled"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#save"],["href","/assets/icons/sprite.svg#check-circle"]],template:function(e,o){if(e&1&&(t(0,"div",0)(1,"div",1),f(),t(2,"svg",2),m(3,"use",3),i(),h(),t(4,"h4",4),a(5,"\u7CFB\u7D71\u8A2D\u5B9A"),i()(),g(6,ir,4,0,"div",5),t(7,"form",6),A("ngSubmit",function(){return o.submit()}),t(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10),f(),t(12,"svg",11),m(13,"use",12),i(),a(14," \u5DE5\u4F5C\u6642\u9593 "),i(),h(),t(15,"div",13)(16,"div",14)(17,"label",15),a(18,"\u4E0A\u73ED\u6642\u9593 "),t(19,"span",16),a(20,"*"),i()(),m(21,"input",17),i(),t(22,"div",14)(23,"label",15),a(24,"\u4E0B\u73ED\u6642\u9593 "),t(25,"span",16),a(26,"*"),i()(),m(27,"input",18),i(),t(28,"div",4)(29,"label",15),a(30,"\u6BCF\u6708\u52A0\u73ED\u6642\u6578\u9650\u5236 "),t(31,"span",19),a(32,"\uFF08\u5C0F\u6642\uFF09"),i()(),m(33,"input",20),g(34,nr,2,0,"div",21),i()()()(),t(35,"div",22)(36,"button",23),f(),t(37,"svg",24),m(38,"use",25),i(),a(39," \u5132\u5B58\u8A2D\u5B9A "),i()()()()()),e&2){let s;l(6),x(o.saved?6:-1),l(),_("formGroup",o.form),l(27),x((s=o.form.get("monthlyOvertimeLimit"))!=null&&s.invalid&&((s=o.form.get("monthlyOvertimeLimit"))!=null&&s.touched)?34:-1),l(2),_("disabled",o.form.invalid)}},dependencies:[X,K,J,fe,Y,z,be,yi,Q,W],encapsulation:2})};var rr=r=>[r,"edit"],ar=(r,n)=>n.id;function or(r,n){r&1&&(t(0,"span",18),a(1,"\u2514"),i())}function lr(r,n){if(r&1){let e=q();t(0,"tr")(1,"td",17),g(2,or,2,0,"span",18),a(3),i(),t(4,"td",19)(5,"code"),a(6),i()(),t(7,"td",20),a(8),i(),t(9,"td",20),a(10),i(),t(11,"td")(12,"span",21),a(13),i()(),t(14,"td",22)(15,"div",23)(16,"a",24),f(),t(17,"svg",7),m(18,"use",25),i()(),h(),t(19,"button",26),A("click",function(){let s=j(e).$implicit,v=u();return N(v.delete(s))}),f(),t(20,"svg",7),m(21,"use",27),i()()()()()}if(r&2){let e=n.$implicit;l(2),x(e.parentId?2:-1),l(),E(" ",e.name," "),l(3),c(e.code??"\u2014"),l(2),c(e.parentName??"\u2014"),l(2),c(e.description??"\u2014"),l(3),E("",e.employeeCount," \u4EBA"),l(3),_("routerLink",re(7,rr,e.id))}}function sr(r,n){r&1&&(t(0,"tr")(1,"td",28),a(2,"\u5C1A\u7121\u90E8\u9580\u8CC7\u6599\u3002"),i()())}var Rt=class r{deptService=p(Ie);departments$=this.deptService.getAll();delete(n){confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u90E8\u9580\u300C${n.name}\u300D\u55CE\uFF1F`)&&this.deptService.delete(n.id).subscribe()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-department-list"]],decls:34,vars:3,consts:[[1,"container-fluid","py-3"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between","gap-2","mb-4"],[1,"d-flex","align-items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#git-branch"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","d-inline-flex","align-items-center","gap-1","waves-effect","waves-light"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"d-none","d-sm-table-cell"],[1,"d-none","d-md-table-cell"],[1,"text-end"],[1,"fw-500"],[1,"text-muted","me-1"],[1,"text-muted","d-none","d-sm-table-cell"],[1,"text-muted","d-none","d-md-table-cell"],[1,"badge","bg-info"],[1,"text-end",2,"white-space","nowrap"],[1,"d-flex","justify-content-end","gap-1"],[1,"btn","btn-sm","btn-ghost-primary","d-inline-flex","align-items-center","waves-effect",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],[1,"btn","btn-sm","btn-ghost-danger","d-inline-flex","align-items-center","waves-effect",3,"click"],["href","/assets/icons/sprite.svg#trash"],["colspan","6",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),f(),t(3,"svg",3),m(4,"use",4),i(),h(),t(5,"h4",5),a(6,"\u90E8\u9580\u7BA1\u7406"),i()(),t(7,"a",6),f(),t(8,"svg",7),m(9,"use",8),i(),a(10," \u65B0\u589E\u90E8\u9580 "),i()(),h(),t(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u90E8\u9580\u540D\u7A31"),i(),t(19,"th",14),a(20,"\u4EE3\u78BC"),i(),t(21,"th",15),a(22,"\u6BCD\u90E8\u9580"),i(),t(23,"th",15),a(24,"\u63CF\u8FF0"),i(),t(25,"th"),a(26,"\u4EBA\u6578"),i(),t(27,"th",16),a(28,"\u64CD\u4F5C"),i()()(),t(29,"tbody"),k(30,lr,22,9,"tr",null,ar,!1,sr,3,0,"tr"),D(33,"async"),i()()()()()()),e&2&&(l(30),B(ie(33,1,o.departments$)))},dependencies:[V,ae],encapsulation:2})};var mr=(r,n)=>n.id;function dr(r,n){r&1&&(t(0,"div",15),a(1,"\u8ACB\u8F38\u5165\u90E8\u9580\u540D\u7A31\u3002"),i())}function ur(r,n){if(r&1&&(t(0,"option",18),a(1),i()),r&2){let e=n.$implicit;_("ngValue",e.id),l(),c(e.name)}}var ut=class r{fb=p(Z);deptService=p(Ie);route=p(de);router=p(ce);departments=[];isEdit=!1;deptId=0;form=this.fb.group({name:["",F.required],code:[""],description:[""],parentId:[null],sortOrder:[0]});ngOnInit(){this.deptService.getAll().subscribe(e=>this.departments=e);let n=this.route.snapshot.paramMap.get("id");n&&(this.isEdit=!0,this.deptId=+n,this.deptService.getById(this.deptId).subscribe(e=>{e&&this.form.patchValue(M(C({},e),{parentId:e.parentId??null}))}))}getAvailableParents(){return this.departments.filter(n=>n.id!==this.deptId)}submit(){if(this.form.invalid)return;let n=this.form.value;(this.isEdit?this.deptService.update(this.deptId,n):this.deptService.create(n)).subscribe(()=>this.router.navigate(["/admin/departments"]))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-department-form"]],decls:46,vars:6,consts:[[1,"container-fluid","py-3"],[1,"d-flex","align-items-center","gap-2","mb-4"],["routerLink","/admin/departments",1,"btn","btn-sm","btn-outline-secondary","waves-effect"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],[1,"row"],[1,"col-12","col-lg-8","col-xl-6"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","name","placeholder","\u4F8B\u5982\uFF1A\u7814\u767C\u90E8",1,"form-control"],[1,"text-danger","small","mt-1"],["type","text","formControlName","code","placeholder","\u4F8B\u5982\uFF1ARD",1,"form-control","font-monospace"],["formControlName","parentId",1,"form-select"],[3,"ngValue"],["type","number","formControlName","sortOrder","min","0",1,"form-control"],[1,"text-muted","small","mt-1"],[1,"mb-4"],["formControlName","description","rows","2","placeholder","\u9078\u586B\u8AAA\u660E",1,"form-control"],[1,"d-flex","gap-2"],["type","submit",1,"btn","btn-primary","waves-effect","waves-light",3,"disabled"],["routerLink","/admin/departments",1,"btn","btn-outline-secondary","waves-effect"]],template:function(e,o){if(e&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),f(),t(3,"svg",3),m(4,"use",4),i()(),h(),t(5,"h4",5),a(6),i()(),t(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"form",10),A("ngSubmit",function(){return o.submit()}),t(12,"div",11)(13,"label",12),a(14,"\u90E8\u9580\u540D\u7A31 "),t(15,"span",13),a(16,"*"),i()(),m(17,"input",14),g(18,dr,2,0,"div",15),i(),t(19,"div",11)(20,"label",12),a(21,"\u90E8\u9580\u4EE3\u78BC"),i(),m(22,"input",16),i(),t(23,"div",11)(24,"label",12),a(25,"\u4E0A\u5C64\u90E8\u9580"),i(),t(26,"select",17)(27,"option",18),a(28,"\u2014 \u7121\uFF08\u9802\u5C64\u90E8\u9580\uFF09\u2014"),i(),k(29,ur,2,2,"option",18,mr),i()(),t(31,"div",11)(32,"label",12),a(33,"\u6392\u5E8F\u865F"),i(),m(34,"input",19),t(35,"div",20),a(36,"\u6578\u5B57\u8D8A\u5C0F\u6392\u8D8A\u524D\u9762\u3002"),i()(),t(37,"div",21)(38,"label",12),a(39,"\u63CF\u8FF0"),i(),m(40,"textarea",22),i(),t(41,"div",23)(42,"button",24),a(43),i(),t(44,"a",25),a(45,"\u53D6\u6D88"),i()()()()()()()()),e&2){let s;l(6),c(o.isEdit?"\u7DE8\u8F2F\u90E8\u9580":"\u65B0\u589E\u90E8\u9580"),l(5),_("formGroup",o.form),l(7),x((s=o.form.get("name"))!=null&&s.invalid&&((s=o.form.get("name"))!=null&&s.touched)?18:-1),l(9),_("ngValue",null),l(2),B(o.getAvailableParents()),l(13),_("disabled",o.form.invalid),l(),E(" ",o.isEdit?"\u66F4\u65B0":"\u5EFA\u7ACB"," ")}},dependencies:[X,K,Ce,ye,J,fe,Ee,Y,z,be,Q,W,V],encapsulation:2})};var pr=r=>[r,"edit"],cr=(r,n)=>n.id;function vr(r,n){if(r&1){let e=q();t(0,"tr")(1,"td",17),a(2),i(),t(3,"td")(4,"span",18),a(5),i()(),t(6,"td",19),a(7),i(),t(8,"td"),a(9),i(),t(10,"td",20),a(11),D(12,"date"),i(),t(13,"td",21)(14,"div",22)(15,"a",23),f(),t(16,"svg",7),m(17,"use",24),i()(),h(),t(18,"button",25),A("click",function(){let s=j(e).$implicit,v=u();return N(v.delete(s))}),f(),t(19,"svg",7),m(20,"use",26),i()()()()()}if(r&2){let e=n.$implicit;l(2),c(e.name),l(3),E("L",e.level),l(2),c(e.description||"\u2014"),l(2),c(e.employeeCount),l(2),c($(12,6,e.createdAt,"yyyy-MM-dd")),l(4),_("routerLink",re(9,pr,e.id))}}function fr(r,n){r&1&&(t(0,"tr")(1,"td",27),a(2,"\u5C1A\u7121\u8077\u7A31\u8CC7\u6599\u3002"),i()())}var Pt=class r{jobTitleService=p(Re);jobTitles$=this.jobTitleService.getAll();delete(n){confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u8077\u7A31\u300C${n.name}\u300D\u55CE\uFF1F`)&&this.jobTitleService.delete(n.id).subscribe()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-job-title-list"]],decls:34,vars:3,consts:[[1,"container-fluid","py-3"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between","gap-2","mb-4"],[1,"d-flex","align-items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#briefcase"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","d-inline-flex","align-items-center","gap-1","waves-effect","waves-light"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"d-none","d-md-table-cell"],[1,"d-none","d-lg-table-cell"],[1,"text-end"],[1,"fw-500"],[1,"badge","bg-secondary-subtle","text-secondary"],[1,"text-muted","d-none","d-md-table-cell"],[1,"text-muted","small","d-none","d-lg-table-cell"],[1,"text-end",2,"white-space","nowrap"],[1,"d-flex","justify-content-end","gap-1"],[1,"btn","btn-sm","btn-ghost-primary","d-inline-flex","align-items-center","waves-effect",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],[1,"btn","btn-sm","btn-ghost-danger","d-inline-flex","align-items-center","waves-effect",3,"click"],["href","/assets/icons/sprite.svg#trash"],["colspan","6",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),f(),t(3,"svg",3),m(4,"use",4),i(),h(),t(5,"h4",5),a(6,"\u8077\u7A31\u7BA1\u7406"),i()(),t(7,"a",6),f(),t(8,"svg",7),m(9,"use",8),i(),a(10," \u65B0\u589E\u8077\u7A31 "),i()(),h(),t(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u8077\u7A31\u540D\u7A31"),i(),t(19,"th"),a(20,"\u7B49\u7D1A"),i(),t(21,"th",14),a(22,"\u63CF\u8FF0"),i(),t(23,"th"),a(24,"\u54E1\u5DE5\u4EBA\u6578"),i(),t(25,"th",15),a(26,"\u5EFA\u7ACB\u6642\u9593"),i(),t(27,"th",16),a(28,"\u64CD\u4F5C"),i()()(),t(29,"tbody"),k(30,vr,21,11,"tr",null,cr,!1,fr,3,0,"tr"),D(33,"async"),i()()()()()()),e&2&&(l(30),B(ie(33,1,o.jobTitles$)))},dependencies:[V,ae,ve],encapsulation:2})};function br(r,n){r&1&&(t(0,"div",15),a(1,"\u8ACB\u8F38\u5165\u8077\u7A31\u540D\u7A31\u3002"),i())}function gr(r,n){r&1&&(t(0,"div",15),a(1,"\u8ACB\u8F38\u5165\u6709\u6548\u7B49\u7D1A\uFF08\u6700\u5C0F\u503C\u70BA 1\uFF09\u3002"),i())}var pt=class r{fb=p(Z);jobTitleService=p(Re);route=p(de);router=p(ce);isEdit=!1;jobTitleId=0;form=this.fb.group({name:["",F.required],level:[1,[F.required,F.min(1)]],description:[""]});ngOnInit(){let n=this.route.snapshot.paramMap.get("id");n&&(this.isEdit=!0,this.jobTitleId=+n,this.jobTitleService.getById(this.jobTitleId).subscribe(e=>{e&&this.form.patchValue(e)}))}submit(){if(this.form.invalid)return;let n=this.form.value;(this.isEdit?this.jobTitleService.update(this.jobTitleId,n):this.jobTitleService.create(n)).subscribe(()=>this.router.navigate(["/admin/job-titles"]))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-job-title-form"]],decls:37,vars:6,consts:[[1,"container-fluid","py-3"],[1,"d-flex","align-items-center","gap-2","mb-4"],["routerLink","/admin/job-titles",1,"btn","btn-sm","btn-outline-secondary","waves-effect"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],[1,"row"],[1,"col-12","col-lg-6","col-xl-4"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","name","placeholder","\u4F8B\u5982\uFF1A\u8CC7\u6DF1\u5DE5\u7A0B\u5E2B",1,"form-control"],[1,"text-danger","small","mt-1"],["type","number","formControlName","level","min","1","placeholder","\u4F8B\u5982\uFF1A2",1,"form-control"],[1,"text-muted","small","mt-1"],[1,"mb-4"],["formControlName","description","rows","2","placeholder","\u9078\u586B\u8AAA\u660E",1,"form-control"],[1,"d-flex","gap-2"],["type","submit",1,"btn","btn-primary","waves-effect","waves-light",3,"disabled"],["routerLink","/admin/job-titles",1,"btn","btn-outline-secondary","waves-effect"]],template:function(e,o){if(e&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),f(),t(3,"svg",3),m(4,"use",4),i()(),h(),t(5,"h4",5),a(6),i()(),t(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"form",10),A("ngSubmit",function(){return o.submit()}),t(12,"div",11)(13,"label",12),a(14,"\u8077\u7A31\u540D\u7A31 "),t(15,"span",13),a(16,"*"),i()(),m(17,"input",14),g(18,br,2,0,"div",15),i(),t(19,"div",11)(20,"label",12),a(21,"\u7B49\u7D1A "),t(22,"span",13),a(23,"*"),i()(),m(24,"input",16),t(25,"div",17),a(26,"\u6578\u5B57\u8D8A\u5927\u7B49\u7D1A\u8D8A\u9AD8\u3002"),i(),g(27,gr,2,0,"div",15),i(),t(28,"div",18)(29,"label",12),a(30,"\u63CF\u8FF0"),i(),m(31,"textarea",19),i(),t(32,"div",20)(33,"button",21),a(34),i(),t(35,"a",22),a(36,"\u53D6\u6D88"),i()()()()()()()()),e&2){let s,v;l(6),c(o.isEdit?"\u7DE8\u8F2F\u8077\u7A31":"\u65B0\u589E\u8077\u7A31"),l(5),_("formGroup",o.form),l(7),x((s=o.form.get("name"))!=null&&s.invalid&&((s=o.form.get("name"))!=null&&s.touched)?18:-1),l(9),x((v=o.form.get("level"))!=null&&v.invalid&&((v=o.form.get("level"))!=null&&v.touched)?27:-1),l(6),_("disabled",o.form.invalid),l(),E(" ",o.isEdit?"\u66F4\u65B0":"\u5EFA\u7ACB"," ")}},dependencies:[X,K,J,fe,Y,z,be,Q,W,V],encapsulation:2})};var xr=[{id:1,name:"\u8ACB\u5047\u7533\u8ACB",code:"leave_request",description:"\u54E1\u5DE5\u8ACB\u5047\u9700\u7D93\u4E3B\u7BA1\u5BE9\u6838",isActive:!0,applicationType:"leave",steps:[{id:1,stepOrder:1,departmentId:1,departmentName:"\u7BA1\u7406\u90E8",jobTitleId:4,jobTitleName:"\u90E8\u9580\u4E3B\u7BA1",note:"\u76F4\u5C6C\u4E3B\u7BA1\u6838\u53EF"},{id:2,stepOrder:2,departmentId:1,departmentName:"\u7BA1\u7406\u90E8",jobTitleId:4,jobTitleName:"\u90E8\u9580\u4E3B\u7BA1",note:"\u4EBA\u4E8B\u90E8\u9580\u78BA\u8A8D"}],createdAt:new Date("2024-01-01")},{id:2,name:"\u63A1\u8CFC\u7533\u8ACB",code:"purchase_request",description:"\u7269\u54C1\u63A1\u8CFC\u9700\u9010\u7D1A\u5BE9\u6838",isActive:!0,applicationType:"payment_request",steps:[{id:3,stepOrder:1,jobTitleId:4,jobTitleName:"\u90E8\u9580\u4E3B\u7BA1",note:"\u90E8\u9580\u4E3B\u7BA1\u5BE9\u6838"},{id:4,stepOrder:2,departmentId:1,departmentName:"\u7BA1\u7406\u90E8",jobTitleId:4,jobTitleName:"\u90E8\u9580\u4E3B\u7BA1",note:"\u7BA1\u7406\u90E8\u6838\u51C6"}],createdAt:new Date("2024-01-01")}],Qe=class r{http=p(me);items$=new ne(xr);getAll(){return this.items$.asObservable()}getById(n){return L(this.items$.getValue().find(e=>e.id===n))}create(n){let e=M(C({},n),{id:Date.now(),steps:[],createdAt:new Date});return this.items$.next([...this.items$.getValue(),e]),L(e)}update(n,e){let o=this.items$.getValue().map(s=>s.id===n?C(C({},s),e):s);return this.items$.next(o),L(o.find(s=>s.id===n))}delete(n){return this.items$.next(this.items$.getValue().filter(e=>e.id!==n)),L(void 0)}addStep(n,e){let o=M(C({},e),{id:Date.now()}),s=this.items$.getValue().map(v=>v.id===n?M(C({},v),{steps:[...v.steps,o].sort((y,T)=>y.stepOrder-T.stepOrder)}):v);return this.items$.next(s),L(s.find(v=>v.id===n))}updateStep(n,e,o){let s=this.items$.getValue().map(v=>{if(v.id!==n)return v;let y=v.steps.map(T=>T.id===e?C(C({},T),o):T).sort((T,R)=>T.stepOrder-R.stepOrder);return M(C({},v),{steps:y})});return this.items$.next(s),L(s.find(v=>v.id===n))}deleteStep(n,e){let o=this.items$.getValue().map(s=>s.id===n?M(C({},s),{steps:s.steps.filter(v=>v.id!==e)}):s);return this.items$.next(o),L(o.find(s=>s.id===n))}static \u0275fac=function(e){return new(e||r)};static \u0275prov=se({token:r,factory:r.\u0275fac,providedIn:"root"})};var He={payment_request:"\u8ACB\u6B3E\u7533\u8ACB",leave:"\u8ACB\u5047\u7533\u8ACB",travel:"\u51FA\u5DEE\u7533\u8ACB"},Je={payment_request:"bg-info-subtle text-info",leave:"bg-success-subtle text-success",travel:"bg-primary-subtle text-primary"};var _r=r=>[r,"flow"],Sr=(r,n)=>n.id,hr=(r,n)=>n.value;function Er(r,n){r&1&&(t(0,"div",30),a(1,"\u8ACB\u8F38\u5165\u9805\u76EE\u540D\u7A31\u3002"),i())}function Cr(r,n){r&1&&(t(0,"div",30),a(1,"\u8ACB\u8F38\u5165\u4EE3\u78BC\u3002"),i())}function yr(r,n){if(r&1&&(t(0,"option",35),a(1),i()),r&2){let e=n.$implicit,o=u(),s=u(2);_("value",e.value)("disabled",s.isTypeDisabled(e.value,o)),l(),Te(" ",e.label,"",s.isTypeDisabled(e.value,o)?"\uFF08\u5DF2\u8A2D\u5B9A\uFF09":""," ")}}function Ar(r,n){if(r&1&&(t(0,"div",22)(1,"div",26)(2,"label",27),a(3,"\u9805\u76EE\u540D\u7A31 "),t(4,"span",28),a(5,"*"),i()(),m(6,"input",29),g(7,Er,2,0,"div",30),i(),t(8,"div",31)(9,"label",27),a(10,"\u4EE3\u78BC "),t(11,"span",28),a(12,"*"),i()(),m(13,"input",32),g(14,Cr,2,0,"div",30),i(),t(15,"div",26)(16,"label",27),a(17,"\u63CF\u8FF0"),i(),m(18,"input",33),i(),t(19,"div",26)(20,"label",27),a(21,"\u9069\u7528\u985E\u578B"),i(),t(22,"select",34),k(23,yr,2,4,"option",35,hr),i()(),t(25,"div",36)(26,"div",37),m(27,"input",38),t(28,"label",39),a(29,"\u555F\u7528"),i()()()()),r&2){let e,o,s=u(2);l(7),x((e=s.form.get("name"))!=null&&e.invalid&&((e=s.form.get("name"))!=null&&e.touched)?7:-1),l(7),x((o=s.form.get("code"))!=null&&o.invalid&&((o=s.form.get("code"))!=null&&o.touched)?14:-1),l(9),B(s.appTypeOptions)}}function wr(r,n){if(r&1){let e=q();t(0,"div",9)(1,"div",19),a(2),i(),t(3,"div",20)(4,"form",21),A("ngSubmit",function(){j(e);let s=u();return N(s.submit())}),g(5,Ar,30,2,"div",22),D(6,"async"),t(7,"div",23)(8,"button",24),a(9),i(),t(10,"button",25),A("click",function(){j(e);let s=u();return N(s.closeForm())}),a(11,"\u53D6\u6D88"),i()()()()()}if(r&2){let e,o=u();l(2),E(" ",o.editItem?"\u7DE8\u8F2F\u7C3D\u6838\u9805\u76EE":"\u65B0\u589E\u7C3D\u6838\u9805\u76EE"," "),l(2),_("formGroup",o.form),l(),x((e=ie(6,5,o.items$))?5:-1,e),l(3),_("disabled",o.form.invalid),l(),E(" ",o.editItem?"\u66F4\u65B0":"\u5EFA\u7ACB"," ")}}function Fr(r,n){if(r&1&&(t(0,"span"),a(1),i()),r&2){let e=u().$implicit,o=u();oe("badge "+o.appTypeClasses[e.applicationType]),l(),E(" ",o.appTypeLabels[e.applicationType]," ")}}function Tr(r,n){r&1&&(t(0,"span",41),a(1,"\u901A\u7528"),i())}function Dr(r,n){if(r&1){let e=q();t(0,"tr")(1,"td",40),a(2),i(),t(3,"td")(4,"code",41),a(5),i()(),t(6,"td",15),g(7,Fr,2,3,"span",42)(8,Tr,2,0,"span",41),i(),t(9,"td",43),a(10),i(),t(11,"td")(12,"span",44),a(13),i()(),t(14,"td")(15,"span"),a(16),i()(),t(17,"td",45),a(18),D(19,"date"),i(),t(20,"td",46)(21,"div",47)(22,"a",48),f(),t(23,"svg",7),m(24,"use",49),i()(),h(),t(25,"button",50),A("click",function(){let s=j(e).$implicit,v=u();return N(v.openEdit(s))}),f(),t(26,"svg",7),m(27,"use",51),i()(),h(),t(28,"button",52),A("click",function(){let s=j(e).$implicit,v=u();return N(v.delete(s))}),f(),t(29,"svg",7),m(30,"use",53),i()()()()()}if(r&2){let e=n.$implicit;l(2),c(e.name),l(3),c(e.code),l(2),x(e.applicationType?7:8),l(3),c(e.description||"\u2014"),l(3),E("",e.steps.length," \u6B65"),l(2),oe("badge "+(e.isActive?"bg-success-subtle text-success":"bg-secondary-subtle text-secondary")),l(),E(" ",e.isActive?"\u555F\u7528":"\u505C\u7528"," "),l(2),c($(19,10,e.createdAt,"yyyy-MM-dd")),l(4),_("routerLink",re(13,_r,e.id))}}function Ir(r,n){r&1&&(t(0,"tr")(1,"td",54),a(2,"\u5C1A\u7121\u7C3D\u6838\u9805\u76EE\u3002"),i()())}var jt=class r{approvalService=p(Qe);fb=p(Z);items$=this.approvalService.getAll();showForm=!1;editItem=null;appTypeLabels=He;appTypeClasses=Je;appTypeOptions=[{value:"",label:"\u901A\u7528\uFF08\u4E0D\u7D81\u5B9A\uFF09"},{value:"payment_request",label:"\u8ACB\u6B3E\u7533\u8ACB"},{value:"leave",label:"\u8ACB\u5047\u7533\u8ACB"},{value:"travel",label:"\u51FA\u5DEE\u7533\u8ACB"}];form=this.fb.group({name:["",F.required],code:["",F.required],description:[""],isActive:[!0],applicationType:[""]});openCreate(){this.editItem=null,this.form.reset({isActive:!0,applicationType:""}),this.showForm=!0}openEdit(n){this.editItem=n,this.form.patchValue(M(C({},n),{applicationType:n.applicationType??""})),this.showForm=!0}closeForm(){this.showForm=!1}isTypeDisabled(n,e){return n?e.some(o=>o.applicationType===n&&o.id!==this.editItem?.id):!1}submit(){if(this.form.invalid)return;let n=this.form.value,e=M(C({},n),{applicationType:n.applicationType||void 0});(this.editItem?this.approvalService.update(this.editItem.id,e):this.approvalService.create(e)).subscribe(()=>this.showForm=!1)}delete(n){confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u7C3D\u6838\u9805\u76EE\u300C${n.name}\u300D\u55CE\uFF1F`)&&this.approvalService.delete(n.id).subscribe()}toggleActive(n){this.approvalService.update(n.id,{isActive:!n.isActive}).subscribe()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-approval-list"]],decls:39,vars:4,consts:[[1,"container-fluid","py-3"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between","gap-2","mb-4"],[1,"d-flex","align-items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#check-square"],[1,"mb-0"],[1,"btn","btn-primary","d-inline-flex","align-items-center","gap-1","waves-effect","waves-light",3,"click"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm","mb-4"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"d-none","d-md-table-cell"],[1,"d-none","d-xl-table-cell"],[1,"d-none","d-lg-table-cell"],[1,"text-end"],[1,"card-header","bg-transparent","fw-500"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"row","g-3"],[1,"d-flex","gap-2","mt-3"],["type","submit",1,"btn","btn-primary","btn-sm","waves-effect","waves-light",3,"disabled"],["type","button",1,"btn","btn-outline-secondary","btn-sm","waves-effect",3,"click"],[1,"col-12","col-md-3"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","name","placeholder","\u4F8B\u5982\uFF1A\u8ACB\u5047\u7533\u8ACB",1,"form-control"],[1,"text-danger","small","mt-1"],[1,"col-12","col-md-2"],["type","text","formControlName","code","placeholder","\u4F8B\u5982\uFF1Aleave_request",1,"form-control","font-monospace"],["type","text","formControlName","description","placeholder","\u9078\u586B\u8AAA\u660E",1,"form-control"],["formControlName","applicationType",1,"form-select"],[3,"value","disabled"],[1,"col-12","col-md-1","d-flex","align-items-end"],[1,"form-check"],["type","checkbox","formControlName","isActive","id","isActive",1,"form-check-input"],["for","isActive",1,"form-check-label"],[1,"fw-500"],[1,"text-muted","small"],[3,"class"],[1,"text-muted","d-none","d-xl-table-cell"],[1,"badge","bg-info-subtle","text-info"],[1,"text-muted","small","d-none","d-lg-table-cell"],[1,"text-end",2,"white-space","nowrap"],[1,"d-flex","justify-content-end","gap-1"],["title","\u7BA1\u7406\u6D41\u7A0B",1,"btn","btn-sm","btn-ghost-info","d-inline-flex","align-items-center","waves-effect",3,"routerLink"],["href","/assets/icons/sprite.svg#git-merge"],["title","\u7DE8\u8F2F",1,"btn","btn-sm","btn-ghost-primary","d-inline-flex","align-items-center","waves-effect",3,"click"],["href","/assets/icons/sprite.svg#edit"],["title","\u522A\u9664",1,"btn","btn-sm","btn-ghost-danger","d-inline-flex","align-items-center","waves-effect",3,"click"],["href","/assets/icons/sprite.svg#trash"],["colspan","8",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),f(),t(3,"svg",3),m(4,"use",4),i(),h(),t(5,"h4",5),a(6,"\u7C3D\u6838\u7BA1\u7406"),i()(),t(7,"button",6),A("click",function(){return o.openCreate()}),f(),t(8,"svg",7),m(9,"use",8),i(),a(10," \u65B0\u589E\u9805\u76EE "),i()(),g(11,wr,12,7,"div",9),h(),t(12,"div",10)(13,"div",11)(14,"div",12)(15,"table",13)(16,"thead",14)(17,"tr")(18,"th"),a(19,"\u9805\u76EE\u540D\u7A31"),i(),t(20,"th"),a(21,"\u4EE3\u78BC"),i(),t(22,"th",15),a(23,"\u9069\u7528\u985E\u578B"),i(),t(24,"th",16),a(25,"\u63CF\u8FF0"),i(),t(26,"th"),a(27,"\u6B65\u9A5F\u6578"),i(),t(28,"th"),a(29,"\u72C0\u614B"),i(),t(30,"th",17),a(31,"\u5EFA\u7ACB\u6642\u9593"),i(),t(32,"th",18),a(33,"\u64CD\u4F5C"),i()()(),t(34,"tbody"),k(35,Dr,31,15,"tr",null,Sr,!1,Ir,3,0,"tr"),D(38,"async"),i()()()()()()),e&2&&(l(11),x(o.showForm?11:-1),l(24),B(ie(38,2,o.items$)))},dependencies:[V,X,K,Ce,ye,J,hi,Ee,Y,z,Q,W,ae,ve],encapsulation:2})};var oi=(r,n)=>n.id;function Lr(r,n){if(r&1&&(t(0,"p",10),a(1),i()),r&2){let e=u();l(),c(e.description)}}function kr(r,n){if(r&1&&(t(0,"option",29),a(1),i()),r&2){let e=n.$implicit;_("ngValue",e.id),l(),c(e.name)}}function Br(r,n){if(r&1&&(t(0,"option",29),a(1),i()),r&2){let e=n.$implicit;_("ngValue",e.id),l(),Te("",e.name,"\uFF08L",e.level,"\uFF09")}}function Rr(r,n){if(r&1){let e=q();t(0,"div",16)(1,"div",19),a(2),i(),t(3,"div",20)(4,"form",21),A("ngSubmit",function(){j(e);let s=u(2);return N(s.submitStep())}),t(5,"div",22)(6,"div",23)(7,"label",24),a(8,"\u6B65\u9A5F\u9806\u5E8F "),t(9,"span",25),a(10,"*"),i()(),m(11,"input",26),i(),t(12,"div",27)(13,"label",24),a(14,"\u90E8\u9580"),i(),t(15,"select",28)(16,"option",29),a(17,"\u2014 \u4E0D\u9650\u90E8\u9580 \u2014"),i(),k(18,kr,2,2,"option",29,oi),i()(),t(20,"div",27)(21,"label",24),a(22,"\u8077\u7A31"),i(),t(23,"select",30)(24,"option",29),a(25,"\u2014 \u4E0D\u9650\u8077\u7A31 \u2014"),i(),k(26,Br,2,3,"option",29,oi),i()(),t(28,"div",31)(29,"label",24),a(30,"\u6B65\u9A5F\u8AAA\u660E"),i(),m(31,"input",32),i()(),t(32,"div",33),a(33,"\u90E8\u9580\u6216\u8077\u7A31\u81F3\u5C11\u9078\u4E00\u3002"),i(),t(34,"div",34)(35,"button",35),a(36),i(),t(37,"button",36),A("click",function(){j(e);let s=u(2);return N(s.closeStepForm())}),a(38,"\u53D6\u6D88"),i()()()()()}if(r&2){let e=u(2);l(2),E(" ",e.editStep?"\u7DE8\u8F2F\u6B65\u9A5F":"\u65B0\u589E\u6B65\u9A5F"," "),l(2),_("formGroup",e.stepForm),l(12),_("ngValue",null),l(2),B(e.departments),l(6),_("ngValue",null),l(2),B(e.jobTitles),l(10),E(" ",e.editStep?"\u66F4\u65B0":"\u65B0\u589E"," ")}}function Pr(r,n){r&1&&(t(0,"div",17)(1,"div",37),a(2,"\u5C1A\u672A\u8A2D\u5B9A\u4EFB\u4F55\u6B65\u9A5F"),i()())}function jr(r,n){r&1&&m(0,"div",41)}function Nr(r,n){if(r&1&&(t(0,"span",46),f(),t(1,"svg",54),m(2,"use",55),i(),a(3),i()),r&2){let e=u().$implicit;l(3),E(" ",e.departmentName," ")}}function Vr(r,n){if(r&1&&(t(0,"span",47),f(),t(1,"svg",54),m(2,"use",56),i(),a(3),i()),r&2){let e=u().$implicit;l(3),E(" ",e.jobTitleName," ")}}function Or(r,n){if(r&1&&(t(0,"span",48),a(1),i()),r&2){let e=u().$implicit;l(),c(e.note)}}function $r(r,n){if(r&1){let e=q();t(0,"div",38)(1,"div",39)(2,"div",40),a(3),i(),g(4,jr,1,0,"div",41),i(),t(5,"div",42)(6,"div",43)(7,"div",44)(8,"div",45),g(9,Nr,4,1,"span",46),g(10,Vr,4,1,"span",47),g(11,Or,2,1,"span",48),i(),t(12,"div",49)(13,"button",50),A("click",function(){let s=j(e).$implicit,v=u(3);return N(v.openEditStep(s))}),f(),t(14,"svg",14),m(15,"use",51),i()(),h(),t(16,"button",52),A("click",function(){let s=j(e).$implicit,v=u(3);return N(v.deleteStep(s))}),f(),t(17,"svg",14),m(18,"use",53),i()()()()()()()}if(r&2){let e=n.$implicit,o=n.$index,s=n.$count;l(3),E(" ",e.stepOrder," "),l(),x(o!==s-1?4:-1),l(5),x(e.departmentName?9:-1),l(),x(e.jobTitleName?10:-1),l(),x(e.note?11:-1)}}function Mr(r,n){if(r&1&&(t(0,"div",18),k(1,$r,19,5,"div",38,oi),i()),r&2){let e=u();l(),B(e.steps)}}function qr(r,n){if(r&1){let e=q();t(0,"div",2)(1,"div",3)(2,"a",4),f(),t(3,"svg",5),m(4,"use",6),i()(),t(5,"svg",7),m(6,"use",8),i(),h(),t(7,"h4",9),a(8),i(),t(9,"span"),a(10),i()()(),g(11,Lr,2,1,"p",10),t(12,"div",11)(13,"h6",12),a(14),i(),t(15,"button",13),A("click",function(){j(e);let s=u();return N(s.openAddStep())}),f(),t(16,"svg",14),m(17,"use",15),i(),a(18," \u65B0\u589E\u6B65\u9A5F "),i()(),g(19,Rr,39,5,"div",16),g(20,Pr,3,0,"div",17)(21,Mr,3,0,"div",18)}if(r&2){let e=n,o=u();l(8),E("",e.name,"\uFF5C\u7C3D\u6838\u6D41\u7A0B"),l(),oe("badge "+(e.isActive?"bg-success-subtle text-success":"bg-secondary-subtle text-secondary")),l(),E(" ",e.isActive?"\u555F\u7528":"\u505C\u7528"," "),l(),x(e.description?11:-1),l(3),E("\u7C3D\u6838\u6B65\u9A5F\uFF08\u5171 ",e.steps.length," \u6B65\uFF09"),l(5),x(o.showStepForm?19:-1),l(),x(e.steps.length===0?20:21)}}function Gr(r,n){r&1&&(t(0,"p",1),a(1,"\u627E\u4E0D\u5230\u7C3D\u6838\u9805\u76EE\u3002"),i())}var Nt=class r{route=p(de);approvalService=p(Qe);deptService=p(Ie);jobTitleService=p(Re);fb=p(Z);itemId=0;item$=new ne(void 0);departments=[];jobTitles=[];showStepForm=!1;editStep=null;stepForm=this.fb.group({stepOrder:[1,[F.required,F.min(1)]],departmentId:[null],jobTitleId:[null],note:[""]});ngOnInit(){this.itemId=+(this.route.snapshot.paramMap.get("id")??0),this.approvalService.getById(this.itemId).subscribe(n=>this.item$.next(n)),this.deptService.getAll().pipe(ai(1)).subscribe(n=>this.departments=n),this.jobTitleService.getAll().pipe(ai(1)).subscribe(n=>this.jobTitles=n)}openAddStep(){this.editStep=null;let n=(this.item$.getValue()?.steps.length??0)+1;this.stepForm.reset({stepOrder:n,departmentId:null,jobTitleId:null,note:""}),this.showStepForm=!0}openEditStep(n){this.editStep=n,this.stepForm.patchValue({stepOrder:n.stepOrder,departmentId:n.departmentId??null,jobTitleId:n.jobTitleId??null,note:n.note??""}),this.showStepForm=!0}closeStepForm(){this.showStepForm=!1}submitStep(){if(this.stepForm.invalid)return;let n=this.stepForm.value,e=n.departmentId||void 0,o=n.jobTitleId||void 0;if(!e&&!o){alert("\u90E8\u9580\u6216\u8077\u7A31\u81F3\u5C11\u9078\u4E00\u3002");return}let s=e?this.departments.find(R=>R.id===e)?.name:void 0,v=o?this.jobTitles.find(R=>R.id===o)?.name:void 0,y={stepOrder:n.stepOrder,departmentId:e,departmentName:s,jobTitleId:o,jobTitleName:v,note:n.note??""};(this.editStep?this.approvalService.updateStep(this.itemId,this.editStep.id,y):this.approvalService.addStep(this.itemId,y)).subscribe(R=>{this.item$.next(R),this.showStepForm=!1})}deleteStep(n){confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u6B65\u9A5F ${n.stepOrder} \u55CE\uFF1F`)&&this.approvalService.deleteStep(this.itemId,n.id).subscribe(e=>this.item$.next(e))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-approval-flow"]],decls:4,vars:3,consts:[[1,"container-fluid","py-3"],[1,"text-muted"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between","gap-2","mb-4"],[1,"d-flex","align-items-center","gap-2"],["routerLink","/admin/approvals",1,"btn","btn-sm","btn-outline-secondary","waves-effect"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#git-merge"],[1,"mb-0"],[1,"text-muted","small","mb-4"],[1,"d-flex","align-items-center","justify-content-between","mb-3"],[1,"mb-0","text-muted"],[1,"btn","btn-outline-primary","btn-sm","d-inline-flex","align-items-center","gap-1","waves-effect",3,"click"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm","mb-4"],[1,"card","border-0","shadow-sm"],[1,"d-flex","flex-column","gap-2"],[1,"card-header","bg-transparent","fw-500"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"row","g-3"],[1,"col-6","col-md-2"],[1,"form-label","fw-500"],[1,"text-danger"],["type","number","formControlName","stepOrder","min","1",1,"form-control"],[1,"col-12","col-md-4"],["formControlName","departmentId",1,"form-select"],[3,"ngValue"],["formControlName","jobTitleId",1,"form-select"],[1,"col-12","col-md-6"],["type","text","formControlName","note","placeholder","\u9078\u586B\u8AAA\u660E",1,"form-control"],[1,"text-muted","small","mt-2"],[1,"d-flex","gap-2","mt-3"],["type","submit",1,"btn","btn-primary","btn-sm","waves-effect","waves-light"],["type","button",1,"btn","btn-outline-secondary","btn-sm","waves-effect",3,"click"],[1,"card-body","text-center","text-muted","py-5"],[1,"d-flex","gap-2","align-items-start"],[1,"d-flex","flex-column","align-items-center",2,"min-width","36px"],[1,"rounded-circle","bg-primary","text-white","d-flex","align-items-center","justify-content-center","fw-bold",2,"width","32px","height","32px","font-size",".85rem"],[1,"bg-secondary-subtle",2,"width","2px","flex","1","min-height","20px"],[1,"card","border-0","shadow-sm","flex-fill","mb-0"],[1,"card-body","py-2","px-3"],[1,"d-flex","align-items-center","justify-content-between","flex-wrap","gap-2"],[1,"d-flex","flex-wrap","gap-2","align-items-center"],[1,"badge","bg-primary-subtle","text-primary","d-inline-flex","align-items-center","gap-1",2,"white-space","nowrap"],[1,"badge","bg-warning-subtle","text-warning-emphasis","d-inline-flex","align-items-center","gap-1",2,"white-space","nowrap"],[1,"text-muted","small"],[1,"d-flex","gap-1"],["title","\u7DE8\u8F2F",1,"btn","btn-sm","btn-ghost-primary","d-inline-flex","align-items-center","waves-effect",3,"click"],["href","/assets/icons/sprite.svg#edit"],["title","\u522A\u9664",1,"btn","btn-sm","btn-ghost-danger","d-inline-flex","align-items-center","waves-effect",3,"click"],["href","/assets/icons/sprite.svg#trash"],[1,"sa-icon",2,"width","12px","height","12px","flex-shrink","0","stroke","currentColor"],["href","/assets/icons/sprite.svg#git-branch"],["href","/assets/icons/sprite.svg#briefcase"]],template:function(e,o){if(e&1&&(t(0,"div",0),g(1,qr,22,8),D(2,"async"),yt(3,Gr,2,0,"p",1),i()),e&2){let s;l(),x((s=ie(2,1,o.item$))?1:3,s)}},dependencies:[V,X,K,Ce,ye,J,fe,Ee,Y,z,be,Q,W,ae],encapsulation:2})};var Ur=[{id:1,code:"P2024-001",departmentId:3,departmentName:"\u696D\u52D9\u90E8",budgetAmount:5e5,actualAmount:48e4,businessAmount:45e4,googleDriveUrl:"https://drive.google.com/drive/folders/example1",createdAt:new Date("2024-03-01")},{id:2,code:"P2024-002",departmentId:2,departmentName:"\u8CC7\u8A0A\u90E8",budgetAmount:12e5,actualAmount:0,businessAmount:11e5,googleDriveUrl:"https://drive.google.com/drive/folders/example2",createdAt:new Date("2024-06-15")},{id:3,code:"P2025-001",departmentId:1,departmentName:"\u7BA1\u7406\u90E8",budgetAmount:3e5,actualAmount:28e4,businessAmount:25e4,googleDriveUrl:"https://drive.google.com/drive/folders/example3",createdAt:new Date("2025-01-10")}],Pe=class r{http=p(me);items$=new ne(Ur);getAll(){return this.items$.asObservable()}getById(n){return L(this.items$.getValue().find(e=>e.id===n))}create(n){let e=M(C({},n),{id:Date.now(),createdAt:new Date});return this.items$.next([...this.items$.getValue(),e]),L(e)}update(n,e){let o=this.items$.getValue().map(s=>s.id===n?C(C({},s),e):s);return this.items$.next(o),L(o.find(s=>s.id===n))}delete(n){return this.items$.next(this.items$.getValue().filter(e=>e.id!==n)),L(void 0)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=se({token:r,factory:r.\u0275fac,providedIn:"root"})};var Hr=r=>[r,"edit"],Jr=(r,n)=>n.id;function Yr(r,n){if(r&1&&(t(0,"span",17),a(1),i()),r&2){let e=u().$implicit;l(),c(e.departmentName)}}function zr(r,n){r&1&&(t(0,"span",18),a(1,"\u2014"),i())}function Kr(r,n){if(r&1&&(a(0),D(1,"number")),r&2){let e=u().$implicit;E(" ",$(1,1,e.budgetAmount,"1.0-0")," ")}}function Wr(r,n){r&1&&(t(0,"span",18),a(1,"\u2014"),i())}function Qr(r,n){if(r&1&&(a(0),D(1,"number")),r&2){let e=u().$implicit;E(" ",$(1,1,e.actualAmount,"1.0-0")," ")}}function Zr(r,n){r&1&&(t(0,"span",18),a(1,"\u2014"),i())}function Xr(r,n){if(r&1&&(a(0),D(1,"number")),r&2){let e=u().$implicit;E(" ",$(1,1,e.businessAmount,"1.0-0")," ")}}function ea(r,n){r&1&&(t(0,"span",18),a(1,"\u2014"),i())}function ta(r,n){if(r&1&&(t(0,"a",19),f(),t(1,"svg",26),m(2,"use",27),i(),a(3," \u958B\u555F "),i()),r&2){let e=u().$implicit;_("href",e.googleDriveUrl,Oe)}}function ia(r,n){r&1&&(t(0,"span",18),a(1,"\u2014"),i())}function na(r,n){if(r&1){let e=q();t(0,"tr")(1,"td",16),a(2),i(),t(3,"td"),g(4,Yr,2,1,"span",17)(5,zr,2,0,"span",18),i(),t(6,"td",14),g(7,Kr,2,4)(8,Wr,2,0,"span",18),i(),t(9,"td",14),g(10,Qr,2,4)(11,Zr,2,0,"span",18),i(),t(12,"td",14),g(13,Xr,2,4)(14,ea,2,0,"span",18),i(),t(15,"td",15),g(16,ta,4,1,"a",19)(17,ia,2,0,"span",18),i(),t(18,"td",20)(19,"div",21)(20,"a",22),f(),t(21,"svg",7),m(22,"use",23),i()(),h(),t(23,"button",24),A("click",function(){let s=j(e).$implicit,v=u();return N(v.delete(s))}),f(),t(24,"svg",7),m(25,"use",25),i()()()()()}if(r&2){let e=n.$implicit;l(2),c(e.code),l(2),x(e.departmentName?4:5),l(3),x(e.budgetAmount!=null?7:8),l(3),x(e.actualAmount!=null?10:11),l(3),x(e.businessAmount!=null?13:14),l(3),x(e.googleDriveUrl?16:17),l(4),_("routerLink",re(7,Hr,e.id))}}function ra(r,n){r&1&&(t(0,"tr")(1,"td",28),a(2,"\u5C1A\u7121\u5C08\u6848\u8CC7\u6599\u3002"),i()())}var Vt=class r{projectService=p(Pe);projects$=this.projectService.getAll();delete(n){confirm(`\u78BA\u5B9A\u8981\u522A\u9664\u5C08\u6848\u300C${n.code}\u300D\u55CE\uFF1F`)&&this.projectService.delete(n.id).subscribe()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-project-list"]],decls:36,vars:3,consts:[[1,"container-fluid","py-3"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between","gap-2","mb-4"],[1,"d-flex","align-items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#folder"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","d-inline-flex","align-items-center","gap-1","waves-effect","waves-light"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"text-end"],[1,"d-none","d-lg-table-cell"],[1,"fw-500","font-monospace"],[1,"badge","bg-primary-subtle","text-primary"],[1,"text-muted"],["target","_blank","rel","noopener",1,"d-inline-flex","align-items-center","gap-1","text-decoration-none","text-muted","small",3,"href"],[1,"text-end",2,"white-space","nowrap"],[1,"d-flex","justify-content-end","gap-1"],[1,"btn","btn-sm","btn-ghost-primary","d-inline-flex","align-items-center","waves-effect",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],[1,"btn","btn-sm","btn-ghost-danger","d-inline-flex","align-items-center","waves-effect",3,"click"],["href","/assets/icons/sprite.svg#trash"],[1,"sa-icon",2,"stroke","currentColor","width","14px","height","14px"],["href","/assets/icons/sprite.svg#external-link"],["colspan","7",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),f(),t(3,"svg",3),m(4,"use",4),i(),h(),t(5,"h4",5),a(6,"\u5C08\u6848\u7BA1\u7406"),i()(),t(7,"a",6),f(),t(8,"svg",7),m(9,"use",8),i(),a(10," \u65B0\u589E\u5C08\u6848 "),i()(),h(),t(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u7DE8\u865F"),i(),t(19,"th"),a(20,"\u90E8\u9580"),i(),t(21,"th",14),a(22,"\u9810\u5B9A\u91D1\u984D"),i(),t(23,"th",14),a(24,"\u5BE6\u969B\u91D1\u984D"),i(),t(25,"th",14),a(26,"\u696D\u52D9\u91D1\u984D"),i(),t(27,"th",15),a(28,"Google Drive"),i(),t(29,"th",14),a(30,"\u64CD\u4F5C"),i()()(),t(31,"tbody"),k(32,na,26,9,"tr",null,Jr,!1,ra,3,0,"tr"),D(35,"async"),i()()()()()()),e&2&&(l(32),B(ie(35,1,o.projects$)))},dependencies:[V,ae,De],encapsulation:2})};var aa=(r,n)=>n.id;function oa(r,n){r&1&&(t(0,"div",15),a(1,"\u8ACB\u8F38\u5165\u5C08\u6848\u7DE8\u865F\u3002"),i())}function la(r,n){if(r&1&&(t(0,"option",17),a(1),i()),r&2){let e=n.$implicit;_("ngValue",e.id),l(),c(e.name)}}function sa(r,n){r&1&&(t(0,"div",15),a(1,"\u8ACB\u9078\u64C7\u90E8\u9580\u3002"),i())}function ma(r,n){r&1&&(t(0,"div",15),a(1,"\u8ACB\u8F38\u5165\u9810\u5B9A\u91D1\u984D\uFF08\u4E0D\u53EF\u70BA\u8CA0\u6578\uFF09\u3002"),i())}function da(r,n){r&1&&(t(0,"div",15),a(1,"\u8ACB\u8F38\u5165\u5BE6\u969B\u91D1\u984D\uFF08\u4E0D\u53EF\u70BA\u8CA0\u6578\uFF09\u3002"),i())}function ua(r,n){r&1&&(t(0,"div",15),a(1,"\u8ACB\u8F38\u5165\u696D\u52D9\u91D1\u984D\uFF08\u4E0D\u53EF\u70BA\u8CA0\u6578\uFF09\u3002"),i())}function pa(r,n){r&1&&(t(0,"div",15),a(1,"\u8ACB\u8F38\u5165 Google Drive \u9023\u7D50\u3002"),i())}var ct=class r{fb=p(Z);projectService=p(Pe);deptService=p(Ie);route=p(de);router=p(ce);departments=[];isEdit=!1;projectId=0;form=this.fb.group({code:["",F.required],departmentId:[null,F.required],budgetAmount:[null,[F.required,F.min(0)]],actualAmount:[null,[F.required,F.min(0)]],businessAmount:[null,[F.required,F.min(0)]],googleDriveUrl:["",F.required]});ngOnInit(){this.deptService.getAll().subscribe(e=>this.departments=e);let n=this.route.snapshot.paramMap.get("id");n&&(this.isEdit=!0,this.projectId=+n,this.projectService.getById(this.projectId).subscribe(e=>{e&&this.form.patchValue({code:e.code,departmentId:e.departmentId??null,budgetAmount:e.budgetAmount??null,actualAmount:e.actualAmount??null,businessAmount:e.businessAmount??null,googleDriveUrl:e.googleDriveUrl??""})}))}submit(){if(this.form.invalid)return;let n=this.form.value,e=this.departments.find(v=>v.id===n.departmentId),o={code:n.code,departmentId:n.departmentId??void 0,departmentName:e?.name,budgetAmount:n.budgetAmount??void 0,actualAmount:n.actualAmount??void 0,businessAmount:n.businessAmount??void 0,googleDriveUrl:n.googleDriveUrl||void 0};(this.isEdit?this.projectService.update(this.projectId,o):this.projectService.create(o)).subscribe(()=>this.router.navigate(["/admin/projects"]))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-project-form"]],decls:63,vars:11,consts:[[1,"container-fluid","py-3"],[1,"d-flex","align-items-center","gap-2","mb-4"],["routerLink","/admin/projects",1,"btn","btn-sm","btn-outline-secondary","waves-effect"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],[1,"row"],[1,"col-12","col-lg-8","col-xl-6"],[1,"card","border-0","shadow-sm"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","code","placeholder","\u4F8B\u5982\uFF1AP2025-001",1,"form-control","font-monospace"],[1,"text-danger","small","mt-1"],["formControlName","departmentId",1,"form-select"],[3,"ngValue"],["type","number","formControlName","budgetAmount","min","0",1,"form-control"],["type","number","formControlName","actualAmount","min","0",1,"form-control"],["type","number","formControlName","businessAmount","min","0",1,"form-control"],[1,"mb-4"],["type","url","formControlName","googleDriveUrl","placeholder","https://drive.google.com/drive/folders/...",1,"form-control"],[1,"d-flex","gap-2"],["type","submit",1,"btn","btn-primary","waves-effect","waves-light",3,"disabled"],["routerLink","/admin/projects",1,"btn","btn-outline-secondary","waves-effect"]],template:function(e,o){if(e&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),f(),t(3,"svg",3),m(4,"use",4),i()(),h(),t(5,"h4",5),a(6),i()(),t(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"form",10),A("ngSubmit",function(){return o.submit()}),t(12,"div",11)(13,"label",12),a(14,"\u5C08\u6848\u7DE8\u865F "),t(15,"span",13),a(16,"*"),i()(),m(17,"input",14),g(18,oa,2,0,"div",15),i(),t(19,"div",11)(20,"label",12),a(21,"\u90E8\u9580 "),t(22,"span",13),a(23,"*"),i()(),t(24,"select",16)(25,"option",17),a(26,"\u2014 \u8ACB\u9078\u64C7\u90E8\u9580 \u2014"),i(),k(27,la,2,2,"option",17,aa),i(),g(29,sa,2,0,"div",15),i(),t(30,"div",11)(31,"label",12),a(32,"\u9810\u5B9A\u91D1\u984D "),t(33,"span",13),a(34,"*"),i()(),m(35,"input",18),g(36,ma,2,0,"div",15),i(),t(37,"div",11)(38,"label",12),a(39,"\u5BE6\u969B\u91D1\u984D "),t(40,"span",13),a(41,"*"),i()(),m(42,"input",19),g(43,da,2,0,"div",15),i(),t(44,"div",11)(45,"label",12),a(46,"\u696D\u52D9\u91D1\u984D "),t(47,"span",13),a(48,"*"),i()(),m(49,"input",20),g(50,ua,2,0,"div",15),i(),t(51,"div",21)(52,"label",12),a(53,"Google Drive \u9023\u7D50 "),t(54,"span",13),a(55,"*"),i()(),m(56,"input",22),g(57,pa,2,0,"div",15),i(),t(58,"div",23)(59,"button",24),a(60),i(),t(61,"a",25),a(62,"\u53D6\u6D88"),i()()()()()()()()),e&2){let s,v,y,T,R,U;l(6),c(o.isEdit?"\u7DE8\u8F2F\u5C08\u6848":"\u65B0\u589E\u5C08\u6848"),l(5),_("formGroup",o.form),l(7),x((s=o.form.get("code"))!=null&&s.invalid&&((s=o.form.get("code"))!=null&&s.touched)?18:-1),l(7),_("ngValue",null),l(2),B(o.departments),l(2),x((v=o.form.get("departmentId"))!=null&&v.invalid&&((v=o.form.get("departmentId"))!=null&&v.touched)?29:-1),l(7),x((y=o.form.get("budgetAmount"))!=null&&y.invalid&&((y=o.form.get("budgetAmount"))!=null&&y.touched)?36:-1),l(7),x((T=o.form.get("actualAmount"))!=null&&T.invalid&&((T=o.form.get("actualAmount"))!=null&&T.touched)?43:-1),l(7),x((R=o.form.get("businessAmount"))!=null&&R.invalid&&((R=o.form.get("businessAmount"))!=null&&R.touched)?50:-1),l(7),x((U=o.form.get("googleDriveUrl"))!=null&&U.invalid&&((U=o.form.get("googleDriveUrl"))!=null&&U.touched)?57:-1),l(2),_("disabled",o.form.invalid),l(),E(" ",o.isEdit?"\u66F4\u65B0":"\u5EFA\u7ACB"," ")}},dependencies:[X,K,Ce,ye,J,fe,Ee,Y,z,be,Q,W,V],encapsulation:2})};var ca=[{id:1,type:"vendor",projectId:1,projectCode:"P2024-001",invoices:[{id:"i1",fileName:"invoice_001.jpg",invoiceNo:"AB-12345678",amount:15e3},{id:"i2",fileName:"invoice_002.jpg",invoiceNo:"CD-87654321",amount:8500}],totalAmount:23500,approvalStatus:"approved",createdAt:new Date("2024-04-10")},{id:2,type:"travel",projectId:2,projectCode:"P2024-002",invoices:[{id:"i3",fileName:"receipt_hotel.jpg",invoiceNo:"EF-11223344",amount:4200},{id:"i4",fileName:"receipt_train.jpg",invoiceNo:"GH-55667788",amount:980}],totalAmount:5180,approvalStatus:"pending",createdAt:new Date("2024-07-05")},{id:3,type:"advance",projectId:3,projectCode:"P2025-001",invoices:[{id:"i5",fileName:"advance_001.jpg",invoiceNo:"IJ-99887766",amount:2e4}],totalAmount:2e4,approvalStatus:"rejected",createdAt:new Date("2025-02-01")}],Ze=class r{http=p(me);items$=new ne(ca);getAll(){return this.items$.asObservable()}getById(n){return L(this.items$.getValue().find(e=>e.id===n))}create(n){let e=M(C({},n),{id:Date.now(),createdAt:new Date});return this.items$.next([...this.items$.getValue(),e]),L(e)}update(n,e){let o=this.items$.getValue().map(s=>s.id===n?C(C({},s),e):s);return this.items$.next(o),L(o.find(s=>s.id===n))}delete(n){return this.items$.next(this.items$.getValue().filter(e=>e.id!==n)),L(void 0)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=se({token:r,factory:r.\u0275fac,providedIn:"root"})};var Ai={vendor:"\u5EE0\u5546\u8ACB\u6B3E",travel:"\u54E1\u5DE5\u5DEE\u65C5",advance:"\u54E1\u5DE5\u9810\u652F"},wi={vendor:"bg-info-subtle text-info",travel:"bg-primary-subtle text-primary",advance:"bg-warning-subtle text-warning-emphasis"},Ot={pending:"\u5F85\u5BE9\u6838",approved:"\u5DF2\u6838\u51C6",rejected:"\u5DF2\u62D2\u7D55",returned:"\u9000\u56DE\u4FEE\u6539"},$t={pending:"bg-warning-subtle text-warning-emphasis",approved:"bg-success-subtle text-success",rejected:"bg-danger-subtle text-danger",returned:"bg-secondary-subtle text-secondary"};var Fi=r=>[r,"edit"],va=(r,n)=>n.id;function fa(r,n){if(r&1){let e=q();t(0,"a",23),f(),t(1,"svg",7),m(2,"use",24),i()(),h(),t(3,"button",25),A("click",function(){j(e);let s=u().$implicit,v=u();return N(v.delete(s))}),f(),t(4,"svg",7),m(5,"use",26),i()()}if(r&2){let e=u().$implicit;_("routerLink",re(1,Fi,e.id))}}function ba(r,n){if(r&1&&(t(0,"a",22),f(),t(1,"svg",7),m(2,"use",27),i()()),r&2){let e=u().$implicit;_("routerLink",re(1,Fi,e.id))}}function ga(r,n){if(r&1&&(t(0,"tr")(1,"td")(2,"span"),a(3),i()(),t(4,"td",16),a(5),i(),t(6,"td")(7,"span",17),a(8),i()(),t(9,"td",18),a(10),D(11,"number"),i(),t(12,"td")(13,"span"),a(14),i()(),t(15,"td",19),a(16),D(17,"date"),i(),t(18,"td",20)(19,"div",21),g(20,fa,6,3)(21,ba,3,3,"a",22),i()()()),r&2){let e=n.$implicit,o=u();l(2),oe("badge "+o.typeClass[e.type]),l(),c(o.typeLabel[e.type]),l(2),c(e.projectCode),l(3),E("",e.invoices.length," \u5F35"),l(2),c($(11,11,e.totalAmount,"1.0-0")),l(3),oe("badge "+o.statusClass[e.approvalStatus]),l(),c(o.statusLabel[e.approvalStatus]),l(2),c($(17,14,e.createdAt,"yyyy-MM-dd")),l(4),x(e.approvalStatus==="pending"||e.approvalStatus==="returned"?20:21)}}function xa(r,n){r&1&&(t(0,"tr")(1,"td",28),a(2,"\u5C1A\u7121\u8ACB\u6B3E\u7533\u8ACB\u3002"),i()())}var Mt=class r{service=p(Ze);requests$=this.service.getAll();typeLabel=Ai;typeClass=wi;statusLabel=Ot;statusClass=$t;delete(n){confirm("\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u8ACB\u6B3E\u7533\u8ACB\u55CE\uFF1F")&&this.service.delete(n.id).subscribe()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-payment-list"]],decls:36,vars:3,consts:[[1,"container-fluid","py-3"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between","gap-2","mb-4"],[1,"d-flex","align-items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#dollar-sign"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","d-inline-flex","align-items-center","gap-1","waves-effect","waves-light"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"text-end"],[1,"d-none","d-lg-table-cell"],[1,"fw-500","font-monospace"],[1,"badge","bg-secondary-subtle","text-secondary"],[1,"text-end","fw-500"],[1,"text-muted","small","d-none","d-lg-table-cell"],[1,"text-end",2,"white-space","nowrap"],[1,"d-flex","justify-content-end","gap-1"],["title","\u6AA2\u8996",1,"btn","btn-sm","btn-ghost-secondary","d-inline-flex","align-items-center","waves-effect",3,"routerLink"],["title","\u7DE8\u8F2F",1,"btn","btn-sm","btn-ghost-primary","d-inline-flex","align-items-center","waves-effect",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],["title","\u522A\u9664",1,"btn","btn-sm","btn-ghost-danger","d-inline-flex","align-items-center","waves-effect",3,"click"],["href","/assets/icons/sprite.svg#trash"],["href","/assets/icons/sprite.svg#eye"],["colspan","7",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),f(),t(3,"svg",3),m(4,"use",4),i(),h(),t(5,"h4",5),a(6,"\u8ACB\u6B3E\u7533\u8ACB"),i()(),t(7,"a",6),f(),t(8,"svg",7),m(9,"use",8),i(),a(10," \u65B0\u589E\u7533\u8ACB "),i()(),h(),t(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u985E\u578B"),i(),t(19,"th"),a(20,"\u5C08\u6848\u7DE8\u865F"),i(),t(21,"th"),a(22,"\u767C\u7968\u6578"),i(),t(23,"th",14),a(24,"\u7E3D\u91D1\u984D"),i(),t(25,"th"),a(26,"\u7C3D\u6838\u72C0\u614B"),i(),t(27,"th",15),a(28,"\u5EFA\u7ACB\u6642\u9593"),i(),t(29,"th",14),a(30,"\u64CD\u4F5C"),i()()(),t(31,"tbody"),k(32,ga,22,17,"tr",null,va,!1,xa,3,0,"tr"),D(35,"async"),i()()()()()()),e&2&&(l(32),B(ie(35,1,o.requests$)))},dependencies:[V,ae,De,ve],encapsulation:2})};var ft=En(gn());var Ka=(r,n)=>n.id;function Wa(r,n){let e;return(e=n.get("id"))==null?null:e.value}function Qa(r,n){if(r&1&&(t(0,"option",26),a(1),i()),r&2){let e=n.$implicit;_("ngValue",e.id),l(),Te("",e.code,"",e.departmentName?"\uFF08"+e.departmentName+"\uFF09":"")}}function Za(r,n){r&1&&(t(0,"div",27),a(1,"\u8ACB\u9078\u64C7\u5C08\u6848\u3002"),i())}function Xa(r,n){if(r&1&&(t(0,"div",5)(1,"label",15),a(2,"\u7C3D\u6838\u72C0\u614B"),i(),t(3,"div")(4,"span",50),a(5),i()()()),r&2){let e=u();l(4),oe(e.statusClass[e.approvalStatus]),l(),E(" ",e.statusLabel[e.approvalStatus]," ")}}function eo(r,n){r&1&&(t(0,"div",36),a(1,"\u8ACB\u81F3\u5C11\u4E0A\u50B3\u4E00\u5F35\u767C\u7968\u3002"),i())}function to(r,n){if(r&1){let e=q();t(0,"button",62),A("click",function(){let s;j(e);let v=u().$implicit,y=u();return N(y.openPreview((s=v.get("fileName"))==null?null:s.value,(s=v.get("previewUrl"))==null?null:s.value))}),f(),t(1,"svg",63),m(2,"use",29),i(),a(3),i()}if(r&2){let e,o=u().$implicit;l(3),E(" ",(e=o.get("fileName"))==null?null:e.value," ")}}function io(r,n){if(r&1&&(t(0,"span",53),f(),t(1,"svg",63),m(2,"use",29),i(),a(3),i()),r&2){let e,o=u().$implicit;l(3),E(" ",(e=o.get("fileName"))==null?null:e.value," ")}}function no(r,n){r&1&&(t(0,"div",54),m(1,"span",64),a(2," \u8B58\u5225\u4E2D\u2026 "),i())}function ro(r,n){r&1&&m(0,"input",55)}function ao(r,n){r&1&&(t(0,"div",56),a(1,"\u2014"),i())}function oo(r,n){r&1&&m(0,"input",57)}function lo(r,n){if(r&1){let e=q();t(0,"tr",44)(1,"td",51),g(2,to,4,1,"button",52)(3,io,4,1,"span",53),i(),t(4,"td"),g(5,no,3,0,"div",54)(6,ro,1,0,"input",55),i(),t(7,"td"),g(8,ao,2,0,"div",56)(9,oo,1,0,"input",57),i(),t(10,"td",58)(11,"button",59),A("click",function(){let s=j(e).$index,v=u();return N(v.removeInvoice(s))}),f(),t(12,"svg",60),m(13,"use",61),i()()()()}if(r&2){let e,o,s=n.$implicit,v=n.$index,y=u().ocrLoadingIds.has((e=s.get("id"))==null?null:e.value);_("formGroupName",v),l(2),x((o=s.get("previewUrl"))!=null&&o.value?2:3),l(3),x(y?5:6),l(3),x(y?8:9),l(3),_("disabled",y)}}function so(r,n){r&1&&(t(0,"tr")(1,"td",65),a(2,"\u5C1A\u672A\u65B0\u589E\u767C\u7968"),i()())}function mo(r,n){if(r&1&&(t(0,"tfoot")(1,"tr",39)(2,"td",66),a(3,"\u5408\u8A08"),i(),t(4,"td",67),a(5),D(6,"number"),i(),m(7,"td"),i()()),r&2){let e=u();l(5),c($(6,1,e.totalAmount,"1.0-0"))}}function uo(r,n){r&1&&m(0,"span",47)}function po(r,n){if(r&1&&m(0,"img",75),r&2){let e=u(2);_("src",e.previewFile.url,Oe)}}function co(r,n){if(r&1&&m(0,"iframe",76),r&2){let e=u(2);_("src",e.previewFile.safeUrl,Ct)}}function vo(r,n){if(r&1&&(t(0,"div",77)(1,"a",78),f(),t(2,"svg",79),m(3,"use",80),i(),a(4," \u4E0B\u8F09\u6A94\u6848 "),i()()),r&2){let e=u(2);l(),_("href",e.previewFile.url,Oe)("download",e.previewFile.name)}}function fo(r,n){if(r&1){let e=q();t(0,"div",68),A("click",function(){j(e);let s=u();return N(s.closePreview())}),t(1,"div",69),A("click",function(s){return j(e),N(s.stopPropagation())}),t(2,"div",70)(3,"div",71)(4,"h6",72),a(5),i(),t(6,"button",73),A("click",function(){j(e);let s=u();return N(s.closePreview())}),i()(),t(7,"div",74),g(8,po,1,1,"img",75)(9,co,1,1,"iframe",76)(10,vo,5,2,"div",77),i()()()()}if(r&2){let e=u();l(5),c(e.previewFile.name),l(3),x(e.isImageFile(e.previewFile.name)?8:e.isPdfFile(e.previewFile.name)?9:10)}}var bt=class r{fb=p(Z);service=p(Ze);projects$=p(Pe);route=p(de);router=p(ce);cdr=p(_i);sanitizer=p(wt);projects=[];isEdit=!1;isReturned=!1;requestId=0;showInvoiceError=!1;approvalStatus="pending";ocrLoadingIds=new Set;get isAnyOcrPending(){return this.ocrLoadingIds.size>0}previewFile=null;openPreview(n,e){this.previewFile={name:n,url:e,safeUrl:this.sanitizer.bypassSecurityTrustResourceUrl(e)}}closePreview(){this.previewFile=null}isImageFile(n){return/\.(jpe?g|png|gif|webp|bmp)$/i.test(n)}isPdfFile(n){return/\.pdf$/i.test(n)}statusLabel=Ot;statusClass=$t;form=this.fb.group({type:["vendor",F.required],projectId:[null,F.required],invoices:this.fb.array([])});get invoiceArray(){return this.form.get("invoices")}get invoiceControls(){return this.invoiceArray.controls}get totalAmount(){return this.invoiceArray.controls.reduce((n,e)=>n+(+e.get("amount")?.value||0),0)}ngOnInit(){this.projects$.getAll().subscribe(e=>this.projects=e);let n=this.route.snapshot.paramMap.get("id");n&&(this.isEdit=!0,this.requestId=+n,this.service.getById(this.requestId).subscribe(e=>{if(!e)return;this.approvalStatus=e.approvalStatus,this.isReturned=e.approvalStatus==="returned",e.approvalStatus!=="pending"&&e.approvalStatus!=="returned"&&this.form.disable(),this.form.patchValue({type:e.type,projectId:e.projectId}),e.invoices.forEach(s=>this.invoiceArray.push(this._invoiceGroup(s.id,s.fileName,s.invoiceNo,s.amount,s.previewUrl??"")))}))}async onFilesSelected(n){let e=n.target;if(!e.files?.length)return;let o=Array.from(e.files);e.value="",this.showInvoiceError=!1;let s=o.map(T=>{let R=`${Date.now()}-${Math.random().toString(36).slice(2)}`,U=URL.createObjectURL(T);return this.ocrLoadingIds.add(R),this.invoiceArray.push(this._invoiceGroup(R,T.name,"",0,U)),{id:R,file:T}}),[v,y]=await Promise.all([(0,ft.createWorker)(["eng","chi_tra"]),(0,ft.createWorker)(["eng","chi_tra"])]);await y.setParameters({tessedit_pageseg_mode:ft.PSM.SPARSE_TEXT});try{for(let{id:T,file:R}of s)try{let[{data:{text:U}},{data:{text:we}}]=await Promise.all([v.recognize(R),y.recognize(R)]);console.log("[OCR AUTO]",U),console.log("[OCR SPARSE]",we);let H=this._extractInvoiceData(U),pe=this._extractInvoiceData(we),Fe=H.invoiceNo||pe.invoiceNo,ke=H.amount||pe.amount,ge=this.invoiceArray.controls.findIndex(ee=>ee.get("id")?.value===T);ge>=0&&this.invoiceArray.controls[ge].patchValue({invoiceNo:Fe,amount:ke})}catch{}finally{this.ocrLoadingIds.delete(T),this.cdr.markForCheck()}}finally{await Promise.all([v.terminate(),y.terminate()])}}removeInvoice(n){let e=this.invoiceArray.at(n).get("previewUrl")?.value;e?.startsWith("blob:")&&URL.revokeObjectURL(e),this.invoiceArray.removeAt(n)}submit(){if(this.form.invalid)return;if(this.invoiceArray.length===0){this.showInvoiceError=!0;return}this.showInvoiceError=!1;let n=this.form.value,e=this.projects.find(y=>y.id===n.projectId),o=this.invoiceArray.value.map(y=>M(C({},y),{amount:+y.amount})),s={type:n.type,projectId:n.projectId,projectCode:e?.code??"",invoices:o,totalAmount:this.totalAmount,approvalStatus:this.approvalStatus};(this.isEdit?this.service.update(this.requestId,s):this.service.create(s)).subscribe(()=>this.router.navigate(["/admin/payment-requests"]))}_invoiceGroup(n,e,o,s,v=""){return this.fb.group({id:[n],fileName:[e],invoiceNo:[o,F.required],amount:[s,[F.required,F.min(0)]],previewUrl:[v]})}_extractInvoiceData(n){let e=n.match(/[A-Z]{2}[-\s]?\d{8}/),o="";e&&(o=e[0].replace(/[-\s]/g,""));let s=[/(?:|||||)[^0-9]{0,20}([\d,]+)/,/(?:\s*|\s*|\s*\s*|\s*\s*\s*|\s*\s*\s*|\s*)[^0-9]{0,20}([\d,]+)/,/[^0-9]{0,10}([\d,]+)/,/\s*[^0-9]{0,10}([\d,]+)/,/(?:Amount|Total)[^0-9]{0,10}([\d,]+)/i,/NT\$\s*([\d,]+)/,/\$\s*([\d,]+)/],v=0;for(let y of s){let T=n.match(y);if(T){v=parseInt(T[1].replace(/,/g,""),10);break}}return{invoiceNo:o,amount:v}}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-payment-form"]],decls:84,vars:12,consts:[[1,"container-fluid","py-3"],[1,"d-flex","align-items-center","gap-2","mb-4"],["routerLink","/admin/payment-requests",1,"btn","btn-sm","btn-outline-secondary","waves-effect"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-lg-10","col-xl-8"],[1,"card","border-0","shadow-sm"],[1,"card-header","bg-transparent","border-bottom","d-flex","align-items-center","gap-2","fw-600"],[1,"sa-icon","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#dollar-sign"],[1,"card-body"],[1,"mb-3"],[1,"form-label","fw-500"],[1,"text-danger"],[1,"d-flex","flex-wrap","gap-3","mt-1"],[1,"form-check"],["type","radio","formControlName","type","value","vendor","id","typeVendor",1,"form-check-input"],["for","typeVendor",1,"form-check-label"],["type","radio","formControlName","type","value","travel","id","typeTravel",1,"form-check-input"],["for","typeTravel",1,"form-check-label"],["type","radio","formControlName","type","value","advance","id","typeAdvance",1,"form-check-input"],["for","typeAdvance",1,"form-check-label"],["formControlName","projectId",1,"form-select"],[3,"ngValue"],[1,"text-danger","small","mt-1"],[1,"card","border-0","shadow-sm","mt-4"],["href","/assets/icons/sprite.svg#file-text"],[1,"d-flex","flex-column","align-items-center","justify-content-center","rounded-3","py-4","px-3","mb-3","text-center",2,"cursor","pointer","border","2px dashed var(--bs-border-color)"],[1,"sa-icon","sa-icon-2x","text-muted","mb-2",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#upload"],[1,"fw-500"],[1,"text-muted","small","mt-1"],["type","file","multiple","","accept","image/*,application/pdf",1,"d-none",3,"change"],[1,"alert","alert-warning","py-2","small","mb-3"],[1,"table-responsive"],[1,"table","table-sm","mb-0"],[1,"table-light"],[2,"min-width","160px"],[2,"min-width","120px"],[2,"width","48px"],["formArrayName","invoices"],[3,"formGroupName"],[1,"mt-4","d-flex","gap-2"],["type","submit",1,"btn","btn-primary","waves-effect","waves-light",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-1"],["routerLink","/admin/payment-requests",1,"btn","btn-outline-secondary","waves-effect"],["tabindex","-1",1,"modal","d-block",2,"background","rgba(0,0,0,.6)"],[1,"badge","rounded-pill","px-3","py-2"],[1,"align-middle","small",2,"max-width","200px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap"],["type","button",1,"btn","btn-link","p-0","text-muted","small","d-inline-flex","align-items-center","gap-1",2,"text-decoration","none","max-width","100%","overflow","hidden","text-overflow","ellipsis"],[1,"text-muted","d-inline-flex","align-items-center","gap-1"],[1,"d-flex","align-items-center","gap-2","text-muted","small","py-1"],["formControlName","invoiceNo","placeholder","AB12345678",1,"form-control","form-control-sm","font-monospace"],[1,"py-1"],["type","number","formControlName","amount","min","0","placeholder","0",1,"form-control","form-control-sm"],[1,"text-end","align-middle"],["type","button",1,"btn","btn-sm","btn-ghost-danger","d-inline-flex","align-items-center","waves-effect",3,"click","disabled"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#x"],["type","button",1,"btn","btn-link","p-0","text-muted","small","d-inline-flex","align-items-center","gap-1",2,"text-decoration","none","max-width","100%","overflow","hidden","text-overflow","ellipsis",3,"click"],[1,"sa-icon","flex-shrink-0",2,"width","14px","height","14px","stroke","currentColor"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm"],["colspan","4",1,"text-center","text-muted","py-3","small"],["colspan","2",1,"text-end","fw-500","small"],[1,"fw-600"],["tabindex","-1",1,"modal","d-block",2,"background","rgba(0,0,0,.6)",3,"click"],[1,"modal-dialog","modal-lg","modal-dialog-centered",3,"click"],[1,"modal-content"],[1,"modal-header","py-2"],[1,"modal-title","mb-0","text-truncate"],["type","button",1,"btn-close",3,"click"],[1,"modal-body","p-0","text-center","bg-body-secondary"],[1,"img-fluid",2,"max-height","75vh","object-fit","contain",3,"src"],[2,"width","100%","height","75vh","border","0",3,"src"],[1,"p-5"],[1,"btn","btn-primary",3,"href","download"],[1,"sa-icon","me-1",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#download"]],template:function(e,o){if(e&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),f(),t(3,"svg",3),m(4,"use",4),i()(),h(),t(5,"h4",5),a(6),i()(),t(7,"form",6),A("ngSubmit",function(){return o.submit()}),t(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10),f(),t(12,"svg",11),m(13,"use",12),i(),a(14," \u57FA\u672C\u8CC7\u8A0A "),i(),h(),t(15,"div",13)(16,"div",14)(17,"label",15),a(18,"\u8ACB\u6B3E\u985E\u578B "),t(19,"span",16),a(20,"*"),i()(),t(21,"div",17)(22,"div",18),m(23,"input",19),t(24,"label",20),a(25,"\u5EE0\u5546\u8ACB\u6B3E"),i()(),t(26,"div",18),m(27,"input",21),t(28,"label",22),a(29,"\u54E1\u5DE5\u5DEE\u65C5"),i()(),t(30,"div",18),m(31,"input",23),t(32,"label",24),a(33,"\u54E1\u5DE5\u9810\u652F"),i()()()(),t(34,"div",14)(35,"label",15),a(36,"\u5C08\u6848 "),t(37,"span",16),a(38,"*"),i()(),t(39,"select",25)(40,"option",26),a(41,"\u2014 \u8ACB\u9078\u64C7\u5C08\u6848 \u2014"),i(),k(42,Qa,2,3,"option",26,Ka),i(),g(44,Za,2,0,"div",27),i(),g(45,Xa,6,3,"div",5),i()(),t(46,"div",28)(47,"div",10),f(),t(48,"svg",11),m(49,"use",29),i(),a(50," \u767C\u7968 "),i(),h(),t(51,"div",13)(52,"label",30),f(),t(53,"svg",31),m(54,"use",32),i(),h(),t(55,"span",33),a(56,"\u9EDE\u64CA\u4E0A\u50B3\u767C\u7968\u5716\u6A94"),i(),t(57,"span",34),a(58,"\u652F\u63F4 JPG\u3001PNG\u3001PDF\uFF0C\u53EF\u591A\u9078"),i(),t(59,"input",35),A("change",function(v){return o.onFilesSelected(v)}),i()(),g(60,eo,2,0,"div",36),t(61,"div",37)(62,"table",38)(63,"thead",39)(64,"tr")(65,"th"),a(66,"\u6A94\u6848\u540D\u7A31"),i(),t(67,"th",40),a(68,"\u767C\u7968\u865F\u78BC"),i(),t(69,"th",41),a(70,"\u91D1\u984D"),i(),m(71,"th",42),i()(),t(72,"tbody",43),k(73,lo,14,5,"tr",44,Wa,!1,so,3,0,"tr"),i(),g(76,mo,8,4,"tfoot"),i()()()(),t(77,"div",45)(78,"button",46),g(79,uo,1,0,"span",47),a(80),i(),t(81,"a",48),a(82,"\u53D6\u6D88"),i()()()()()(),g(83,fo,11,2,"div",49)),e&2){let s;l(6),c(o.isReturned?"\u4FEE\u6539\u8ACB\u6B3E\u7533\u8ACB\uFF08\u9000\u56DE\uFF09":o.isEdit?"\u7DE8\u8F2F\u8ACB\u6B3E\u7533\u8ACB":"\u65B0\u589E\u8ACB\u6B3E\u7533\u8ACB"),l(),_("formGroup",o.form),l(33),_("ngValue",null),l(2),B(o.projects),l(2),x((s=o.form.get("projectId"))!=null&&s.invalid&&((s=o.form.get("projectId"))!=null&&s.touched)?44:-1),l(),x(o.isEdit?45:-1),l(15),x(o.showInvoiceError?60:-1),l(13),B(o.invoiceControls),l(3),x(o.invoiceControls.length>0?76:-1),l(2),_("disabled",o.form.invalid||o.isAnyOcrPending),l(),x(o.isAnyOcrPending?79:-1),l(),E(" ",o.isReturned?"\u4FEE\u6539\u4E26\u91CD\u9001":o.isEdit?"\u66F4\u65B0":"\u5EFA\u7ACB"," "),l(3),x(o.previewFile?83:-1)}},dependencies:[X,K,Ce,ye,J,fe,Ee,$e,Y,z,be,Q,W,Ei,Ci,V,De],encapsulation:2})};var Ht={pending:"\u5F85\u5BE9\u6838",approved:"\u5DF2\u6838\u51C6",rejected:"\u5DF2\u62D2\u7D55",returned:"\u9000\u56DE\u4FEE\u6539"},Jt={pending:"bg-warning-subtle text-warning-emphasis",approved:"bg-success-subtle text-success",rejected:"bg-danger-subtle text-danger",returned:"bg-secondary-subtle text-secondary"},Yt={vendor:"\u5EE0\u5546\u8ACB\u6B3E",travel:"\u54E1\u5DE5\u5DEE\u65C5",advance:"\u54E1\u5DE5\u9810\u652F"},zt={annual:"\u5E74\u5047",personal:"\u4E8B\u5047",sick:"\u75C5\u5047",compensatory:"\u88DC\u4F11"};var bo=(r,n)=>[r,n,"review"],go=(r,n)=>n.applicationType+n.id;function xo(r,n){if(r&1&&(t(0,"tr")(1,"td")(2,"span"),a(3),i()(),t(4,"td",13),a(5),i(),t(6,"td",14),a(7),i(),t(8,"td")(9,"span"),a(10),i()(),t(11,"td",15),a(12),D(13,"date"),i(),t(14,"td",16)(15,"a",17),f(),t(16,"svg",18),m(17,"use"),i()()()()),r&2){let e=n.$implicit,o=u();l(2),oe("badge "+o.appTypeClass[e.applicationType]),l(),E(" ",o.appTypeLabel[e.applicationType]," "),l(2),c(e.submittedBy),l(2),c(o.getSummary(e)),l(2),oe("badge "+o.statusClass[e.status]),l(),c(o.statusLabel[e.status]),l(2),c($(13,13,e.submittedAt,"yyyy-MM-dd")),l(3),oe("btn btn-sm d-inline-flex align-items-center waves-effect "+(e.status==="pending"?"btn-ghost-primary":"btn-ghost-secondary")),_("routerLink",gi(16,bo,e.applicationType,e.id)),l(2),bi("href",e.status==="pending"?"/assets/icons/sprite.svg#edit":"/assets/icons/sprite.svg#eye")}}function _o(r,n){r&1&&(t(0,"tr")(1,"td",19),a(2,"\u5C1A\u7121\u7C3D\u6838\u4F5C\u696D\u3002"),i()())}var Kt=class r{service=p(Ft);tasks$=this.service.getAll();statusLabel=Ht;statusClass=Jt;appTypeLabel=He;appTypeClass=Je;payTypeLabel=Yt;leaveTypeLabel=zt;getSummary(n){return n.paymentDetail?`${this.payTypeLabel[n.paymentDetail.paymentType]}\u30FB${n.paymentDetail.projectCode}\uFF08${n.paymentDetail.totalAmount.toLocaleString()} \u5143\uFF09`:n.leaveDetail?`${this.leaveTypeLabel[n.leaveDetail.leaveType]}\u30FB${n.leaveDetail.days} \u5929`:n.travelDetail?`${n.travelDetail.destination}\uFF08${n.travelDetail.estimatedCost.toLocaleString()} \u5143\uFF09`:"\u2014"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-approval-task-list"]],decls:29,vars:3,consts:[[1,"container-fluid","py-3"],[1,"d-flex","align-items-center","gap-2","mb-4"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#check-square"],[1,"mb-0"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"d-none","d-md-table-cell"],[1,"d-none","d-lg-table-cell"],[1,"text-end"],[1,"fw-500"],[1,"text-muted","small","d-none","d-md-table-cell"],[1,"text-muted","small","d-none","d-lg-table-cell"],[1,"text-end",2,"white-space","nowrap"],[3,"routerLink"],[1,"sa-icon",2,"stroke","currentColor"],["colspan","6",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1),f(),t(2,"svg",2),m(3,"use",3),i(),h(),t(4,"h4",4),a(5,"\u7C3D\u6838\u4F5C\u696D"),i()(),t(6,"div",5)(7,"div",6)(8,"div",7)(9,"table",8)(10,"thead",9)(11,"tr")(12,"th"),a(13,"\u985E\u578B"),i(),t(14,"th"),a(15,"\u7533\u8ACB\u4EBA"),i(),t(16,"th",10),a(17,"\u6458\u8981"),i(),t(18,"th"),a(19,"\u72C0\u614B"),i(),t(20,"th",11),a(21,"\u7533\u8ACB\u6642\u9593"),i(),t(22,"th",12),a(23,"\u64CD\u4F5C"),i()()(),t(24,"tbody"),k(25,xo,18,19,"tr",null,go,!1,_o,3,0,"tr"),D(28,"async"),i()()()()()()),e&2&&(l(25),B(ie(28,1,o.tasks$)))},dependencies:[V,ae,ve],encapsulation:2})};var So=(r,n)=>n.id,ho=(r,n)=>n.stepOrder;function Eo(r,n){if(r&1){let e=q();t(0,"button",38),A("click",function(){j(e);let s=u().$implicit,v=u(4);return N(v.openPreview(s.fileName,s.previewUrl))}),f(),t(1,"svg",39),m(2,"use",25),i(),a(3),i()}if(r&2){let e=u().$implicit;l(3),E(" ",e.fileName," ")}}function Co(r,n){if(r&1&&(t(0,"span",35),f(),t(1,"svg",39),m(2,"use",25),i(),a(3),i()),r&2){let e=u().$implicit;l(3),E(" ",e.fileName," ")}}function yo(r,n){if(r&1&&(t(0,"tr")(1,"td",33),g(2,Eo,4,1,"button",34)(3,Co,4,1,"span",35),i(),t(4,"td",36),a(5),i(),t(6,"td",37),a(7),D(8,"number"),i()()),r&2){let e=n.$implicit;l(2),x(e.previewUrl?2:3),l(3),c(e.invoiceNo),l(2),c($(8,3,e.amount,"1.0-0"))}}function Ao(r,n){if(r&1&&(t(0,"div",13)(1,"div",14),f(),t(2,"svg",15),m(3,"use",16),i(),a(4," \u8ACB\u6B3E\u7533\u8ACB\u8CC7\u8A0A "),i(),h(),t(5,"div",17)(6,"div",18)(7,"div",19)(8,"div",20),a(9,"\u8ACB\u6B3E\u985E\u578B"),i(),t(10,"span",21),a(11),i()(),t(12,"div",19)(13,"div",20),a(14,"\u5C08\u6848\u7DE8\u865F"),i(),t(15,"span",22),a(16),i()(),t(17,"div",19)(18,"div",20),a(19,"\u7533\u8ACB\u4EBA"),i(),t(20,"span",21),a(21),i()(),t(22,"div",19)(23,"div",20),a(24,"\u7533\u8ACB\u6642\u9593"),i(),t(25,"span",23),a(26),D(27,"date"),i()(),t(28,"div",19)(29,"div",20),a(30,"\u7E3D\u91D1\u984D"),i(),t(31,"span",24),a(32),D(33,"number"),i()()()()(),t(34,"div",12)(35,"div",14),f(),t(36,"svg",15),m(37,"use",25),i(),a(38," \u767C\u7968\u660E\u7D30 "),i(),h(),t(39,"div",26)(40,"div",27)(41,"table",28)(42,"thead",29)(43,"tr")(44,"th"),a(45,"\u6A94\u6848\u540D\u7A31"),i(),t(46,"th"),a(47,"\u767C\u7968\u865F\u78BC"),i(),t(48,"th",30),a(49,"\u91D1\u984D"),i()()(),t(50,"tbody"),k(51,yo,9,6,"tr",null,So),i(),t(53,"tfoot")(54,"tr",29)(55,"td",31),a(56,"\u5408\u8A08"),i(),t(57,"td",32),a(58),D(59,"number"),i()()()()()()()),r&2){let e=n,o=u(2),s=u();l(11),c(s.payTypeLabel[e.paymentType]),l(5),c(e.projectCode),l(5),c(o.submittedBy),l(5),c($(27,6,o.submittedAt,"yyyy-MM-dd")),l(6),c($(33,9,e.totalAmount,"1.0-0")),l(19),B(e.invoices),l(7),c($(59,12,e.totalAmount,"1.0-0"))}}function wo(r,n){if(r&1&&g(0,Ao,60,15),r&2){let e,o=u();x((e=o.paymentDetail)?0:-1,e)}}function Fo(r,n){if(r&1&&(t(0,"div",13)(1,"div",14),f(),t(2,"svg",15),m(3,"use",40),i(),a(4," \u8ACB\u5047\u7533\u8ACB\u8CC7\u8A0A "),i(),h(),t(5,"div",17)(6,"div",41)(7,"div",19)(8,"div",20),a(9,"\u5047\u5225"),i(),t(10,"span",21),a(11),i()(),t(12,"div",19)(13,"div",20),a(14,"\u7533\u8ACB\u4EBA"),i(),t(15,"span",21),a(16),i()(),t(17,"div",19)(18,"div",20),a(19,"\u5929\u6578"),i(),t(20,"span",24),a(21),i()(),t(22,"div",19)(23,"div",20),a(24,"\u958B\u59CB\u65E5\u671F"),i(),t(25,"span",23),a(26),D(27,"date"),i()(),t(28,"div",19)(29,"div",20),a(30,"\u7D50\u675F\u65E5\u671F"),i(),t(31,"span",23),a(32),D(33,"date"),i()(),t(34,"div",42)(35,"div",20),a(36,"\u8ACB\u5047\u539F\u56E0"),i(),t(37,"div",43),a(38),i()()()()()),r&2){let e=n,o=u(2),s=u();l(11),c(s.leaveTypeLabel[e.leaveType]),l(5),c(o.submittedBy),l(5),E("",e.days," \u5929"),l(5),c($(27,6,e.startDate,"yyyy-MM-dd")),l(6),c($(33,9,e.endDate,"yyyy-MM-dd")),l(6),c(e.reason)}}function To(r,n){if(r&1&&g(0,Fo,39,12,"div",13),r&2){let e,o=u();x((e=o.leaveDetail)?0:-1,e)}}function Do(r,n){if(r&1&&(t(0,"div",19)(1,"div",20),a(2,"\u95DC\u806F\u5C08\u6848"),i(),t(3,"span",45),a(4),i()()),r&2){let e=u();l(4),c(e.projectCode)}}function Io(r,n){if(r&1&&(t(0,"div",13)(1,"div",14),f(),t(2,"svg",15),m(3,"use",44),i(),a(4," \u51FA\u5DEE\u7533\u8ACB\u8CC7\u8A0A "),i(),h(),t(5,"div",17)(6,"div",41)(7,"div",19)(8,"div",20),a(9,"\u51FA\u5DEE\u5730\u9EDE"),i(),t(10,"span",21),a(11),i()(),t(12,"div",19)(13,"div",20),a(14,"\u7533\u8ACB\u4EBA"),i(),t(15,"span",21),a(16),i()(),t(17,"div",19)(18,"div",20),a(19,"\u9810\u4F30\u8CBB\u7528"),i(),t(20,"span",24),a(21),D(22,"number"),i()(),t(23,"div",19)(24,"div",20),a(25,"\u51FA\u767C\u65E5\u671F"),i(),t(26,"span",23),a(27),D(28,"date"),i()(),t(29,"div",19)(30,"div",20),a(31,"\u8FD4\u56DE\u65E5\u671F"),i(),t(32,"span",23),a(33),D(34,"date"),i()(),g(35,Do,5,1,"div",19),t(36,"div",42)(37,"div",20),a(38,"\u51FA\u5DEE\u76EE\u7684"),i(),t(39,"div",43),a(40),i()()()()()),r&2){let e=n,o=u(2);l(11),c(e.destination),l(5),c(o.submittedBy),l(5),E("",$(22,7,e.estimatedCost,"1.0-0")," \u5143"),l(6),c($(28,10,e.startDate,"yyyy-MM-dd")),l(6),c($(34,13,e.endDate,"yyyy-MM-dd")),l(2),x(e.projectCode?35:-1),l(5),c(e.purpose)}}function Lo(r,n){if(r&1&&g(0,Io,41,16,"div",13),r&2){let e,o=u();x((e=o.travelDetail)?0:-1,e)}}function ko(r,n){r&1&&(t(0,"span",55),a(1,"\u2713"),i())}function Bo(r,n){r&1&&(t(0,"span",56),a(1,"\u2717"),i())}function Ro(r,n){r&1&&g(0,ko,2,0,"span",55)(1,Bo,2,0,"span",56),r&2&&x(n.action==="approved"?0:1)}function Po(r,n){if(r&1&&(t(0,"span",50),a(1),i()),r&2){let e=u().$implicit;l(),c(e.stepOrder)}}function jo(r,n){if(r&1&&(t(0,"span",51),a(1),i()),r&2){let e=u().$implicit;l(),c(e.stepOrder)}}function No(r,n){if(r&1&&(t(0,"span",53),a(1),i()),r&2){let e=u().$implicit;l(),E("\uFF08",e.departmentName,"\uFF09")}}function Vo(r,n){if(r&1&&(t(0,"div",23),a(1),i()),r&2){let e=u().$implicit;l(),c(e.note)}}function Oo(r,n){r&1&&(t(0,"span",58),a(1,"\u5DF2\u6838\u51C6"),i())}function $o(r,n){r&1&&(t(0,"span",59),a(1,"\u9000\u56DE\u4FEE\u6539"),i())}function Mo(r,n){r&1&&(t(0,"span",60),a(1,"\u5DF2\u62D2\u7D55"),i())}function qo(r,n){if(r&1&&(t(0,"div",61),a(1),i()),r&2){let e=u();l(),E("\u300C",e.reviewNote,"\u300D")}}function Go(r,n){if(r&1&&(t(0,"div",57),a(1),D(2,"date"),g(3,Oo,2,0,"span",58)(4,$o,2,0,"span",59)(5,Mo,2,0,"span",60),i(),g(6,qo,2,1,"div",61)),r&2){let e=n;l(),Te(" ",e.reviewedBy," \xB7 ",$(2,4,e.reviewedAt,"yyyy-MM-dd")," \xB7 "),l(2),x(e.action==="approved"?3:e.action==="returned"?4:5),l(3),x(e.reviewNote?6:-1)}}function Uo(r,n){r&1&&(t(0,"div",54),a(1,"\u5BE9\u6838\u4E2D\u2026"),i())}function Ho(r,n){if(r&1&&(t(0,"li",49),g(1,Ro,2,1)(2,Po,2,1,"span",50)(3,jo,2,1,"span",51),t(4,"div",52)(5,"div",21),a(6),g(7,No,2,1,"span",53),i(),g(8,Vo,2,1,"div",23),g(9,Go,7,7)(10,Uo,2,0,"div",54),i()()),r&2){let e,o,s=n.$implicit,v=n.$index,y=n.$count,T=u(2),R=u();At("mb-4",v!==y-1),l(),x((e=R.getRecord(T.approvalRecords,s.stepOrder))?1:T.currentStepOrder===s.stepOrder&&T.status==="pending"?2:3,e),l(5),E(" ",s.jobTitleName||"\u2014"," "),l(),x(s.departmentName?7:-1),l(),x(s.note?8:-1),l(),x((o=R.getRecord(T.approvalRecords,s.stepOrder))?9:T.currentStepOrder===s.stepOrder&&T.status==="pending"?10:-1,o)}}function Jo(r,n){if(r&1&&(t(0,"div",12)(1,"div",14),f(),t(2,"svg",15),m(3,"use",46),i(),a(4," \u7C3D\u6838\u6D41\u7A0B "),i(),h(),t(5,"div",17)(6,"ol",47),k(7,Ho,11,7,"li",48,ho),i()()()),r&2){let e=u();l(7),B(e.flow.steps)}}function Yo(r,n){r&1&&(t(0,"span",60),a(1,"*"),i())}function zo(r,n){r&1&&(t(0,"div",74),a(1,"\u9000\u56DE\u4FEE\u6539\u6216\u62D2\u7D55\u6642\u8ACB\u586B\u5BEB\u539F\u56E0\u3002"),i())}function Ko(r,n){if(r&1){let e=q();t(0,"div",12)(1,"div",14),f(),t(2,"svg",15),m(3,"use",8),i(),a(4," \u5BE9\u6838 "),i(),h(),t(5,"div",17)(6,"form",62),A("ngSubmit",function(){j(e);let s=u(2);return N(s.submit())}),t(7,"div",63)(8,"label",64),a(9,"\u5BE9\u6838\u7D50\u679C "),t(10,"span",60),a(11,"*"),i()(),t(12,"div",65)(13,"div",66),m(14,"input",67),t(15,"label",68),a(16,"\u6838\u51C6"),i()(),t(17,"div",66),m(18,"input",69),t(19,"label",70),a(20,"\u9000\u56DE\u4FEE\u6539"),i()(),t(21,"div",66),m(22,"input",71),t(23,"label",72),a(24,"\u62D2\u7D55\uFF08\u7D42\u6B62\uFF09"),i()()()(),t(25,"div",63)(26,"label",64),a(27," \u5BE9\u6838\u610F\u898B "),g(28,Yo,2,0,"span",60),i(),m(29,"textarea",73),g(30,zo,2,0,"div",74),i(),t(31,"div",75)(32,"button",76),a(33,"\u63D0\u4EA4\u5BE9\u6838"),i(),t(34,"a",77),a(35,"\u53D6\u6D88"),i()()()()()}if(r&2){let e,o=u(2);l(6),_("formGroup",o.form),l(22),x(((e=o.form.get("action"))==null?null:e.value)==="rejected"||((e=o.form.get("action"))==null?null:e.value)==="returned"?28:-1),l(2),x(o.showNoteError?30:-1)}}function Wo(r,n){if(r&1&&(t(0,"div",83),a(1,"\u9000\u56DE\u539F\u56E0\uFF1A"),i(),t(2,"div",84),a(3),i()),r&2){let e=u(2);l(3),c(e.reviewNote)}}function Qo(r,n){if(r&1&&(t(0,"div",12)(1,"div",78),f(),t(2,"svg",79),m(3,"use",80),i(),a(4," \u9000\u56DE\u4FEE\u6539 "),i(),h(),t(5,"div",17)(6,"p",81),a(7,"\u6B64\u7533\u8ACB\u5DF2\u9000\u56DE\uFF0C\u5F85\u7533\u8ACB\u4EBA\u4FEE\u6539\u5F8C\u91CD\u65B0\u9001\u51FA\u3002"),i(),g(8,Wo,4,1),t(9,"div",82)(10,"a",77),a(11,"\u8FD4\u56DE\u5217\u8868"),i()()()()),r&2){let e=u();l(8),x(e.reviewNote?8:-1)}}function Zo(r,n){if(r&1&&(t(0,"div",42)(1,"div",20),a(2,"\u5BE9\u6838\u610F\u898B"),i(),t(3,"div",43),a(4),i()()),r&2){let e=u(2);l(4),c(e.reviewNote)}}function Xo(r,n){if(r&1&&(t(0,"div",12)(1,"div",14),f(),t(2,"svg",15),m(3,"use",8),i(),a(4," \u5BE9\u6838\u7D50\u679C "),i(),h(),t(5,"div",17)(6,"div",41)(7,"div",19)(8,"div",20),a(9,"\u5BE9\u6838\u7D50\u679C"),i(),t(10,"span"),a(11),i()(),t(12,"div",19)(13,"div",20),a(14,"\u5BE9\u6838\u6642\u9593"),i(),t(15,"span",23),a(16),D(17,"date"),i()(),g(18,Zo,5,1,"div",42),i(),t(19,"div",85)(20,"a",77),a(21,"\u8FD4\u56DE\u5217\u8868"),i()()()()),r&2){let e=u(),o=u();l(10),oe("badge px-3 py-2 rounded-pill "+o.statusClass[e.status]),l(),E(" ",o.statusLabel[e.status]," "),l(5),c($(17,5,e.reviewedAt,"yyyy-MM-dd")),l(2),x(e.reviewNote?18:-1)}}function el(r,n){if(r&1&&(t(0,"div",3)(1,"a",4),f(),t(2,"svg",5),m(3,"use",6),i()(),t(4,"svg",7),m(5,"use",8),i(),h(),t(6,"h4",9),a(7,"\u7C3D\u6838\u5BE9\u6838"),i(),t(8,"span"),a(9),i(),t(10,"span"),a(11),i()(),t(12,"div",10)(13,"div",11),g(14,wo,1,1)(15,To,1,1)(16,Lo,1,1),g(17,Jo,9,0,"div",12),g(18,Ko,36,3,"div",12)(19,Qo,12,1,"div",12)(20,Xo,22,8,"div",12),i()()),r&2){let e,o=n,s=u();l(8),oe("badge "+s.appTypeClass[o.applicationType]),l(),c(s.appTypeLabel[o.applicationType]),l(),oe("badge "+s.statusClass[o.status]),l(),c(s.statusLabel[o.status]),l(3),x((e=o.applicationType)==="payment_request"?14:e==="leave"?15:e==="travel"?16:-1),l(3),x(o.flow?17:-1),l(),x(o.status==="pending"?18:o.status==="returned"?19:20)}}function tl(r,n){r&1&&(t(0,"p",1),a(1,"\u627E\u4E0D\u5230\u6B64\u7C3D\u6838\u4F5C\u696D\u3002"),i())}function il(r,n){if(r&1&&m(0,"img",93),r&2){let e=u(2);_("src",e.previewFile.url,Oe)}}function nl(r,n){if(r&1&&m(0,"iframe",94),r&2){let e=u(2);_("src",e.previewFile.safeUrl,Ct)}}function rl(r,n){if(r&1&&(t(0,"div",95)(1,"a",96),f(),t(2,"svg",97),m(3,"use",98),i(),a(4," \u4E0B\u8F09\u6A94\u6848 "),i()()),r&2){let e=u(2);l(),_("href",e.previewFile.url,Oe)("download",e.previewFile.name)}}function al(r,n){if(r&1){let e=q();t(0,"div",86),A("click",function(){j(e);let s=u();return N(s.closePreview())}),t(1,"div",87),A("click",function(s){return j(e),N(s.stopPropagation())}),t(2,"div",88)(3,"div",89)(4,"h6",90),a(5),i(),t(6,"button",91),A("click",function(){j(e);let s=u();return N(s.closePreview())}),i()(),t(7,"div",92),g(8,il,1,1,"img",93)(9,nl,1,1,"iframe",94)(10,rl,5,2,"div",95),i()()()()}if(r&2){let e=u();l(5),c(e.previewFile.name),l(3),x(e.isImageFile(e.previewFile.name)?8:e.isPdfFile(e.previewFile.name)?9:10)}}var Wt=class r{service=p(Ft);route=p(de);router=p(ce);fb=p(Z);sanitizer=p(wt);task$;taskId=0;applicationType="";showNoteError=!1;previewFile=null;openPreview(n,e){this.previewFile={name:n,url:e,safeUrl:this.sanitizer.bypassSecurityTrustResourceUrl(e)}}closePreview(){this.previewFile=null}isImageFile(n){return/\.(jpe?g|png|gif|webp|bmp)$/i.test(n)}isPdfFile(n){return/\.pdf$/i.test(n)}statusLabel=Ht;statusClass=Jt;appTypeLabel=He;appTypeClass=Je;payTypeLabel=Yt;leaveTypeLabel=zt;form=this.fb.group({action:["approved",F.required],reviewNote:[""]});ngOnInit(){this.applicationType=this.route.snapshot.paramMap.get("applicationType")??"",this.taskId=+this.route.snapshot.paramMap.get("id"),this.task$=this.service.getById(this.taskId,this.applicationType)}getRecord(n,e){return n.find(o=>o.stepOrder===e)}submit(){let n=this.form.value.action,e=this.form.value.reviewNote?.trim()??"";if((n==="rejected"||n==="returned")&&!e){this.showNoteError=!0;return}this.showNoteError=!1,this.service.review(this.taskId,this.applicationType,n,e).subscribe(()=>{this.router.navigate(["/admin/approval-tasks"])})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-approval-task-review"]],decls:5,vars:4,consts:[[1,"container-fluid","py-3"],[1,"text-muted"],["tabindex","-1",1,"modal","d-block",2,"background","rgba(0,0,0,.6)"],[1,"d-flex","align-items-center","gap-2","mb-4"],["routerLink","/admin/approval-tasks",1,"btn","btn-sm","btn-outline-secondary","waves-effect"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#check-square"],[1,"mb-0"],[1,"row","g-4"],[1,"col-12","col-lg-10","col-xl-8"],[1,"card","border-0","shadow-sm","mt-4"],[1,"card","border-0","shadow-sm"],[1,"card-header","bg-transparent","border-bottom","d-flex","align-items-center","gap-2","fw-600"],[1,"sa-icon","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#dollar-sign"],[1,"card-body"],[1,"row","g-3","mb-0"],[1,"col-6","col-md-4"],[1,"text-muted","small","mb-1"],[1,"fw-500"],[1,"fw-500","font-monospace"],[1,"text-muted","small"],[1,"fw-600","fs-5"],["href","/assets/icons/sprite.svg#file-text"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-sm","mb-0"],[1,"table-light"],[1,"text-end"],["colspan","2",1,"text-end","fw-500","small"],[1,"text-end","fw-600"],[1,"small",2,"max-width","200px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap"],["type","button",1,"btn","btn-link","p-0","text-muted","small","d-inline-flex","align-items-center","gap-1",2,"text-decoration","none","max-width","100%","overflow","hidden","text-overflow","ellipsis"],[1,"text-muted","d-inline-flex","align-items-center","gap-1"],[1,"font-monospace","small"],[1,"text-end","fw-500"],["type","button",1,"btn","btn-link","p-0","text-muted","small","d-inline-flex","align-items-center","gap-1",2,"text-decoration","none","max-width","100%","overflow","hidden","text-overflow","ellipsis",3,"click"],[1,"sa-icon","flex-shrink-0",2,"width","14px","height","14px","stroke","currentColor"],["href","/assets/icons/sprite.svg#calendar"],[1,"row","g-3"],[1,"col-12"],[1,"border","rounded","p-3","bg-body-secondary","small"],["href","/assets/icons/sprite.svg#map-pin"],[1,"font-monospace","fw-500"],["href","/assets/icons/sprite.svg#git-merge"],[1,"list-unstyled","mb-0"],[1,"d-flex","align-items-start","gap-3",3,"mb-4"],[1,"d-flex","align-items-start","gap-3"],[1,"badge","bg-primary","rounded-circle","d-flex","align-items-center","justify-content-center","flex-shrink-0",2,"width","28px","height","28px","min-width","28px","font-size",".75rem"],[1,"badge","bg-secondary-subtle","text-secondary","rounded-circle","d-flex","align-items-center","justify-content-center","flex-shrink-0",2,"width","28px","height","28px","min-width","28px","font-size",".75rem"],[1,"flex-grow-1"],[1,"text-muted","fw-400"],[1,"text-primary","small","mt-1"],[1,"badge","bg-success","rounded-circle","d-flex","align-items-center","justify-content-center","flex-shrink-0",2,"width","28px","height","28px","min-width","28px","font-size",".85rem"],[1,"badge","bg-danger","rounded-circle","d-flex","align-items-center","justify-content-center","flex-shrink-0",2,"width","28px","height","28px","min-width","28px","font-size",".85rem"],[1,"text-muted","small","mt-1"],[1,"text-success"],[1,"text-warning-emphasis"],[1,"text-danger"],[1,"text-muted","small","fst-italic","mt-1"],[3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label","fw-500"],[1,"d-flex","flex-wrap","gap-4","mt-1"],[1,"form-check"],["type","radio","formControlName","action","value","approved","id","actionApprove",1,"form-check-input"],["for","actionApprove",1,"form-check-label","fw-500","text-success"],["type","radio","formControlName","action","value","returned","id","actionReturn",1,"form-check-input"],["for","actionReturn",1,"form-check-label","fw-500","text-warning-emphasis"],["type","radio","formControlName","action","value","rejected","id","actionReject",1,"form-check-input"],["for","actionReject",1,"form-check-label","fw-500","text-danger"],["formControlName","reviewNote","rows","3","placeholder","\u586B\u5BEB\u5BE9\u6838\u610F\u898B\uFF08\u9000\u56DE\u4FEE\u6539\u6216\u62D2\u7D55\u6642\u5FC5\u586B\uFF09...",1,"form-control"],[1,"text-danger","small","mt-1"],[1,"d-flex","gap-2"],["type","submit",1,"btn","btn-primary","waves-effect","waves-light"],["routerLink","/admin/approval-tasks",1,"btn","btn-outline-secondary","waves-effect"],[1,"card-header","bg-warning-subtle","border-bottom","d-flex","align-items-center","gap-2","fw-600","text-warning-emphasis"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#rotate-ccw"],[1,"text-muted","small","mb-2"],[1,"mt-2"],[1,"text-muted","small","mb-1","fw-500"],[1,"border","rounded","p-3","bg-body-secondary","small","mb-3"],[1,"mt-3"],["tabindex","-1",1,"modal","d-block",2,"background","rgba(0,0,0,.6)",3,"click"],[1,"modal-dialog","modal-lg","modal-dialog-centered",3,"click"],[1,"modal-content"],[1,"modal-header","py-2"],[1,"modal-title","mb-0","text-truncate"],["type","button",1,"btn-close",3,"click"],[1,"modal-body","p-0","text-center","bg-body-secondary"],[1,"img-fluid",2,"max-height","75vh","object-fit","contain",3,"src"],[2,"width","100%","height","75vh","border","0",3,"src"],[1,"p-5"],[1,"btn","btn-primary",3,"href","download"],[1,"sa-icon","me-1",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#download"]],template:function(e,o){if(e&1&&(t(0,"div",0),g(1,el,21,9),D(2,"async"),yt(3,tl,2,0,"p",1),i(),g(4,al,11,2,"div",2)),e&2){let s;l(),x((s=ie(2,2,o.task$))?1:3,s),l(3),x(o.previewFile?4:-1)}},dependencies:[V,X,K,J,$e,Y,z,Q,W,ae,ve,De],encapsulation:2})};var ol=[{id:1,leaveType:"annual",startDate:new Date("2026-03-01"),endDate:new Date("2026-03-05"),days:5,reason:"\u500B\u4EBA\u65C5\u904A",approvalStatus:"pending",createdAt:new Date("2026-02-10")},{id:2,leaveType:"sick",startDate:new Date("2026-02-20"),endDate:new Date("2026-02-21"),days:2,reason:"\u8EAB\u9AD4\u4E0D\u9069\u5C31\u91AB",approvalStatus:"approved",createdAt:new Date("2026-02-20"),reviewedAt:new Date("2026-02-20"),reviewNote:"\u6838\u51C6"},{id:3,leaveType:"compensatory",startDate:new Date("2026-02-15"),endDate:new Date("2026-02-15"),days:1,reason:"\u88DC\u4F11\u52A0\u73ED\u6642\u6578",approvalStatus:"rejected",createdAt:new Date("2026-02-13"),reviewedAt:new Date("2026-02-14"),reviewNote:"\u88DC\u4F11\u6642\u6578\u4E0D\u8DB3\uFF0C\u8ACB\u78BA\u8A8D\u5F8C\u91CD\u65B0\u7533\u8ACB"}],Xe=class r{http=p(me);items$=new ne(ol);getAll(){return this.items$.asObservable()}getById(n){return L(this.items$.getValue().find(e=>e.id===n))}create(n){let e=M(C({},n),{id:Date.now(),approvalStatus:"pending",createdAt:new Date});return this.items$.next([...this.items$.getValue(),e]),L(e)}update(n,e){let o=this.items$.getValue().map(s=>s.id===n?C(C({},s),e):s);return this.items$.next(o),L(o.find(s=>s.id===n))}delete(n){return this.items$.next(this.items$.getValue().filter(e=>e.id!==n)),L(void 0)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=se({token:r,factory:r.\u0275fac,providedIn:"root"})};var xn={annual:"\u5E74\u5047",personal:"\u4E8B\u5047",sick:"\u75C5\u5047",compensatory:"\u88DC\u4F11"},_n={annual:"bg-primary-subtle text-primary",personal:"bg-info-subtle text-info",sick:"bg-warning-subtle text-warning-emphasis",compensatory:"bg-secondary-subtle text-secondary"},Qt={pending:"\u5F85\u5BE9\u6838",approved:"\u5DF2\u6838\u51C6",rejected:"\u5DF2\u62D2\u7D55",returned:"\u9000\u56DE\u4FEE\u6539"},Zt={pending:"bg-warning-subtle text-warning-emphasis",approved:"bg-success-subtle text-success",rejected:"bg-danger-subtle text-danger",returned:"bg-secondary-subtle text-secondary"};var Sn=r=>[r,"edit"],ll=(r,n)=>n.id;function sl(r,n){if(r&1){let e=q();t(0,"a",24),f(),t(1,"svg",7),m(2,"use",25),i()(),h(),t(3,"button",26),A("click",function(){j(e);let s=u().$implicit,v=u();return N(v.delete(s))}),f(),t(4,"svg",7),m(5,"use",27),i()()}if(r&2){let e=u().$implicit;_("routerLink",re(1,Sn,e.id))}}function ml(r,n){if(r&1&&(t(0,"a",23),f(),t(1,"svg",7),m(2,"use",28),i()()),r&2){let e=u().$implicit;_("routerLink",re(1,Sn,e.id))}}function dl(r,n){if(r&1&&(t(0,"tr")(1,"td")(2,"span"),a(3),i()(),t(4,"td",17),a(5),D(6,"date"),i(),t(7,"td",17),a(8),D(9,"date"),i(),t(10,"td",18),a(11),D(12,"number"),i(),t(13,"td",19),a(14),i(),t(15,"td")(16,"span"),a(17),i()(),t(18,"td",20),a(19),D(20,"date"),i(),t(21,"td",21)(22,"div",22),g(23,sl,6,3)(24,ml,3,3,"a",23),i()()()),r&2){let e=n.$implicit,o=u();l(2),oe("badge "+o.typeClass[e.leaveType]),l(),c(o.typeLabel[e.leaveType]),l(2),c($(6,12,e.startDate,"yyyy-MM-dd")),l(3),c($(9,15,e.endDate,"yyyy-MM-dd")),l(3),E("",$(12,18,e.days,"1.0-1")," \u5929"),l(3),c(e.reason),l(2),oe("badge "+o.statusClass[e.approvalStatus]),l(),c(o.statusLabel[e.approvalStatus]),l(2),c($(20,21,e.createdAt,"yyyy-MM-dd")),l(4),x(e.approvalStatus==="pending"||e.approvalStatus==="returned"?23:24)}}function ul(r,n){r&1&&(t(0,"tr")(1,"td",29),a(2,"\u5C1A\u7121\u8ACB\u5047\u7533\u8ACB\u3002"),i()())}var Xt=class r{service=p(Xe);requests$=this.service.getAll();typeLabel=xn;typeClass=_n;statusLabel=Qt;statusClass=Zt;delete(n){confirm("\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u8ACB\u5047\u7533\u8ACB\u55CE\uFF1F")&&this.service.delete(n.id).subscribe()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-leave-request-list"]],decls:38,vars:3,consts:[[1,"container-fluid","py-3"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between","gap-2","mb-4"],[1,"d-flex","align-items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#calendar"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","d-inline-flex","align-items-center","gap-1","waves-effect","waves-light"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"text-end"],[1,"d-none","d-md-table-cell"],[1,"d-none","d-lg-table-cell"],[1,"text-muted","small"],[1,"text-end","fw-500"],[1,"text-muted","small","d-none","d-md-table-cell"],[1,"text-muted","small","d-none","d-lg-table-cell"],[1,"text-end",2,"white-space","nowrap"],[1,"d-flex","justify-content-end","gap-1"],["title","\u6AA2\u8996",1,"btn","btn-sm","btn-ghost-secondary","d-inline-flex","align-items-center","waves-effect",3,"routerLink"],["title","\u7DE8\u8F2F",1,"btn","btn-sm","btn-ghost-primary","d-inline-flex","align-items-center","waves-effect",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],["title","\u522A\u9664",1,"btn","btn-sm","btn-ghost-danger","d-inline-flex","align-items-center","waves-effect",3,"click"],["href","/assets/icons/sprite.svg#trash"],["href","/assets/icons/sprite.svg#eye"],["colspan","8",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),f(),t(3,"svg",3),m(4,"use",4),i(),h(),t(5,"h4",5),a(6,"\u8ACB\u5047\u7533\u8ACB"),i()(),t(7,"a",6),f(),t(8,"svg",7),m(9,"use",8),i(),a(10," \u65B0\u589E\u7533\u8ACB "),i()(),h(),t(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u5047\u5225"),i(),t(19,"th"),a(20,"\u958B\u59CB\u65E5\u671F"),i(),t(21,"th"),a(22,"\u7D50\u675F\u65E5\u671F"),i(),t(23,"th",14),a(24,"\u5929\u6578"),i(),t(25,"th",15),a(26,"\u539F\u56E0"),i(),t(27,"th"),a(28,"\u72C0\u614B"),i(),t(29,"th",16),a(30,"\u7533\u8ACB\u6642\u9593"),i(),t(31,"th",14),a(32,"\u64CD\u4F5C"),i()()(),t(33,"tbody"),k(34,dl,25,24,"tr",null,ll,!1,ul,3,0,"tr"),D(37,"async"),i()()()()()()),e&2&&(l(34),B(ie(37,1,o.requests$)))},dependencies:[V,ae,ve,De],encapsulation:2})};function pl(r,n){if(r&1&&(t(0,"div",27),f(),t(1,"svg",37),m(2,"use",38),i(),h(),t(3,"span",39),a(4,"\u76EE\u524D\u53EF\u88DC\u4F11\u6642\u6578\uFF1A"),t(5,"strong"),a(6),i()()()),r&2){let e=u();l(6),E("",e.overtimeHours," \u5C0F\u6642")}}function cl(r,n){r&1&&(t(0,"div",31),a(1,"\u8ACB\u9078\u64C7\u958B\u59CB\u65E5\u671F\u3002"),i())}function vl(r,n){r&1&&(t(0,"div",31),a(1,"\u8ACB\u9078\u64C7\u7D50\u675F\u65E5\u671F\u3002"),i())}function fl(r,n){r&1&&(t(0,"div",31),a(1,"\u8ACB\u8F38\u5165\u6709\u6548\u5929\u6578\uFF08\u6700\u5C11 0.5\uFF09\u3002"),i())}function bl(r,n){r&1&&(t(0,"div",31),a(1,"\u8ACB\u586B\u5BEB\u8ACB\u5047\u539F\u56E0\u3002"),i())}function gl(r,n){if(r&1&&(t(0,"div",35)(1,"button",40),a(2),i(),t(3,"a",41),a(4,"\u53D6\u6D88"),i()()),r&2){let e=u();l(),_("disabled",e.form.invalid),l(),E(" ",e.isReturned?"\u4FEE\u6539\u4E26\u91CD\u9001":e.isEdit?"\u66F4\u65B0":"\u9001\u51FA\u7533\u8ACB"," ")}}function xl(r,n){r&1&&(t(0,"div",36)(1,"a",41),a(2,"\u8FD4\u56DE\u5217\u8868"),i()())}var gt=class r{fb=p(Z);service=p(Xe);route=p(de);router=p(ce);isEdit=!1;requestId=0;isReadOnly=!1;isReturned=!1;overtimeHours=16;statusLabel=Qt;statusClass=Zt;form=this.fb.group({leaveType:["annual",F.required],startDate:["",F.required],endDate:["",F.required],days:[1,[F.required,F.min(.5)]],reason:["",F.required]});ngOnInit(){let n=this.route.snapshot.paramMap.get("id");n&&(this.isEdit=!0,this.requestId=+n,this.service.getById(this.requestId).subscribe(e=>{e&&(this.isReturned=e.approvalStatus==="returned",this.isReadOnly=e.approvalStatus!=="pending"&&e.approvalStatus!=="returned",this.form.patchValue({leaveType:e.leaveType,startDate:e.startDate instanceof Date?e.startDate.toISOString().split("T")[0]:String(e.startDate),endDate:e.endDate instanceof Date?e.endDate.toISOString().split("T")[0]:String(e.endDate),days:e.days,reason:e.reason}),this.isReadOnly&&this.form.disable())}))}submit(){if(this.form.invalid||this.isReadOnly)return;let n=this.form.value,e={leaveType:n.leaveType,startDate:new Date(n.startDate),endDate:new Date(n.endDate),days:+n.days,reason:n.reason};(this.isEdit?this.service.update(this.requestId,e):this.service.create(e)).subscribe(()=>this.router.navigate(["/admin/leave-requests"]))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-leave-request-form"]],decls:70,vars:8,consts:[[1,"container-fluid","py-3"],[1,"d-flex","align-items-center","gap-2","mb-4"],["routerLink","/admin/leave-requests",1,"btn","btn-sm","btn-outline-secondary","waves-effect"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-lg-10","col-xl-8"],[1,"card","border-0","shadow-sm"],[1,"card-header","bg-transparent","border-bottom","d-flex","align-items-center","gap-2","fw-600"],[1,"sa-icon","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#calendar"],[1,"card-body"],[1,"mb-3"],[1,"form-label","fw-500"],[1,"text-danger"],[1,"d-flex","flex-wrap","gap-3","mt-1"],[1,"form-check"],["type","radio","formControlName","leaveType","value","annual","id","typeAnnual",1,"form-check-input"],["for","typeAnnual",1,"form-check-label"],["type","radio","formControlName","leaveType","value","personal","id","typePersonal",1,"form-check-input"],["for","typePersonal",1,"form-check-label"],["type","radio","formControlName","leaveType","value","sick","id","typeSick",1,"form-check-input"],["for","typeSick",1,"form-check-label"],["type","radio","formControlName","leaveType","value","compensatory","id","typeComp",1,"form-check-input"],["for","typeComp",1,"form-check-label"],[1,"alert","alert-info","d-flex","align-items-center","gap-2","py-2","mt-2","mb-0"],[1,"row","g-3","mb-3"],[1,"col-12","col-md-4"],["type","date","formControlName","startDate",1,"form-control"],[1,"text-danger","small","mt-1"],["type","date","formControlName","endDate",1,"form-control"],["type","number","formControlName","days","min","0.5","step","0.5","placeholder","1",1,"form-control"],["formControlName","reason","rows","3","placeholder","\u8ACB\u586B\u5BEB\u8ACB\u5047\u539F\u56E0...",1,"form-control"],[1,"mt-4","d-flex","gap-2"],[1,"mt-4"],[1,"sa-icon","flex-shrink-0",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#clock"],[1,"small"],["type","submit",1,"btn","btn-primary","waves-effect","waves-light",3,"disabled"],["routerLink","/admin/leave-requests",1,"btn","btn-outline-secondary","waves-effect"]],template:function(e,o){if(e&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),f(),t(3,"svg",3),m(4,"use",4),i()(),h(),t(5,"h4",5),a(6),i()(),t(7,"form",6),A("ngSubmit",function(){return o.submit()}),t(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10),f(),t(12,"svg",11),m(13,"use",12),i(),a(14," \u8ACB\u5047\u8CC7\u8A0A "),i(),h(),t(15,"div",13)(16,"div",14)(17,"label",15),a(18,"\u5047\u5225 "),t(19,"span",16),a(20,"*"),i()(),t(21,"div",17)(22,"div",18),m(23,"input",19),t(24,"label",20),a(25,"\u5E74\u5047"),i()(),t(26,"div",18),m(27,"input",21),t(28,"label",22),a(29,"\u4E8B\u5047"),i()(),t(30,"div",18),m(31,"input",23),t(32,"label",24),a(33,"\u75C5\u5047"),i()(),t(34,"div",18),m(35,"input",25),t(36,"label",26),a(37,"\u88DC\u4F11"),i()()(),g(38,pl,7,1,"div",27),i(),t(39,"div",28)(40,"div",29)(41,"label",15),a(42,"\u958B\u59CB\u65E5\u671F "),t(43,"span",16),a(44,"*"),i()(),m(45,"input",30),g(46,cl,2,0,"div",31),i(),t(47,"div",29)(48,"label",15),a(49,"\u7D50\u675F\u65E5\u671F "),t(50,"span",16),a(51,"*"),i()(),m(52,"input",32),g(53,vl,2,0,"div",31),i(),t(54,"div",29)(55,"label",15),a(56,"\u5929\u6578 "),t(57,"span",16),a(58,"*"),i()(),m(59,"input",33),g(60,fl,2,0,"div",31),i()(),t(61,"div",14)(62,"label",15),a(63,"\u8ACB\u5047\u539F\u56E0 "),t(64,"span",16),a(65,"*"),i()(),m(66,"textarea",34),g(67,bl,2,0,"div",31),i()()(),g(68,gl,5,2,"div",35)(69,xl,3,0,"div",36),i()()()()),e&2){let s,v,y,T,R;l(6),c(o.isEdit?o.isReadOnly?"\u6AA2\u8996\u8ACB\u5047\u7533\u8ACB":o.isReturned?"\u4FEE\u6539\u8ACB\u5047\u7533\u8ACB\uFF08\u9000\u56DE\uFF09":"\u7DE8\u8F2F\u8ACB\u5047\u7533\u8ACB":"\u65B0\u589E\u8ACB\u5047\u7533\u8ACB"),l(),_("formGroup",o.form),l(31),x(((s=o.form.get("leaveType"))==null?null:s.value)==="compensatory"?38:-1),l(8),x((v=o.form.get("startDate"))!=null&&v.invalid&&((v=o.form.get("startDate"))!=null&&v.touched)?46:-1),l(7),x((y=o.form.get("endDate"))!=null&&y.invalid&&((y=o.form.get("endDate"))!=null&&y.touched)?53:-1),l(7),x((T=o.form.get("days"))!=null&&T.invalid&&((T=o.form.get("days"))!=null&&T.touched)?60:-1),l(7),x((R=o.form.get("reason"))!=null&&R.invalid&&((R=o.form.get("reason"))!=null&&R.touched)?67:-1),l(),x(o.isReadOnly?69:68)}},dependencies:[X,K,J,fe,$e,Y,z,be,Q,W,V],encapsulation:2})};var _l=[{id:1,destination:"\u53F0\u5357",startDate:new Date("2026-03-10"),endDate:new Date("2026-03-12"),estimatedCost:3e3,purpose:"\u5BA2\u6236\u73FE\u5834\u62DC\u8A2A\u8207\u9700\u6C42\u78BA\u8A8D",projectId:1,projectCode:"P2024-001",approvalStatus:"pending",createdAt:new Date("2026-03-01")},{id:2,destination:"\u53F0\u4E2D",startDate:new Date("2026-02-25"),endDate:new Date("2026-02-26"),estimatedCost:1500,purpose:"\u4F9B\u61C9\u5546\u5DE5\u5EE0\u53C3\u8A2A",projectId:2,projectCode:"P2024-002",approvalStatus:"approved",createdAt:new Date("2026-02-20"),reviewedAt:new Date("2026-02-24"),reviewNote:"\u6838\u51C6"}],et=class r{http=p(me);items$=new ne(_l);getAll(){return this.items$.asObservable()}getById(n){return L(this.items$.getValue().find(e=>e.id===n))}create(n){let e=M(C({},n),{id:Date.now(),approvalStatus:"pending",createdAt:new Date});return this.items$.next([...this.items$.getValue(),e]),L(e)}update(n,e){let o=this.items$.getValue().map(s=>s.id===n?C(C({},s),e):s);return this.items$.next(o),L(o.find(s=>s.id===n))}delete(n){return this.items$.next(this.items$.getValue().filter(e=>e.id!==n)),L(void 0)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=se({token:r,factory:r.\u0275fac,providedIn:"root"})};var ei={pending:"\u5F85\u5BE9\u6838",approved:"\u5DF2\u6838\u51C6",rejected:"\u5DF2\u62D2\u7D55",returned:"\u9000\u56DE\u4FEE\u6539"},ti={pending:"bg-warning-subtle text-warning-emphasis",approved:"bg-success-subtle text-success",rejected:"bg-danger-subtle text-danger",returned:"bg-secondary-subtle text-secondary"};var hn=r=>[r,"edit"],Sl=(r,n)=>n.id;function hl(r,n){if(r&1){let e=q();t(0,"a",25),f(),t(1,"svg",7),m(2,"use",26),i()(),h(),t(3,"button",27),A("click",function(){j(e);let s=u().$implicit,v=u();return N(v.delete(s))}),f(),t(4,"svg",7),m(5,"use",28),i()()}if(r&2){let e=u().$implicit;_("routerLink",re(1,hn,e.id))}}function El(r,n){if(r&1&&(t(0,"a",24),f(),t(1,"svg",7),m(2,"use",29),i()()),r&2){let e=u().$implicit;_("routerLink",re(1,hn,e.id))}}function Cl(r,n){if(r&1&&(t(0,"tr")(1,"td",17),a(2),i(),t(3,"td",18),a(4),D(5,"date"),i(),t(6,"td",18),a(7),D(8,"date"),i(),t(9,"td",19),a(10),D(11,"number"),i(),t(12,"td",20),a(13),i(),t(14,"td",21),a(15),i(),t(16,"td")(17,"span"),a(18),i()(),t(19,"td",22)(20,"div",23),g(21,hl,6,3)(22,El,3,3,"a",24),i()()()),r&2){let e=n.$implicit,o=u();l(2),c(e.destination),l(2),c($(5,10,e.startDate,"yyyy-MM-dd")),l(3),c($(8,13,e.endDate,"yyyy-MM-dd")),l(3),c($(11,16,e.estimatedCost,"1.0-0")),l(3),c(e.purpose),l(2),c(e.projectCode||"\u2014"),l(2),oe("badge "+o.statusClass[e.approvalStatus]),l(),c(o.statusLabel[e.approvalStatus]),l(3),x(e.approvalStatus==="pending"||e.approvalStatus==="returned"?21:22)}}function yl(r,n){r&1&&(t(0,"tr")(1,"td",30),a(2,"\u5C1A\u7121\u51FA\u5DEE\u7533\u8ACB\u3002"),i()())}var ii=class r{service=p(et);requests$=this.service.getAll();statusLabel=ei;statusClass=ti;delete(n){confirm("\u78BA\u5B9A\u8981\u522A\u9664\u6B64\u51FA\u5DEE\u7533\u8ACB\u55CE\uFF1F")&&this.service.delete(n.id).subscribe()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-travel-request-list"]],decls:38,vars:3,consts:[[1,"container-fluid","py-3"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between","gap-2","mb-4"],[1,"d-flex","align-items-center","gap-2"],[1,"sa-icon","sa-icon-2x","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#map-pin"],[1,"mb-0"],["routerLink","new",1,"btn","btn-primary","d-inline-flex","align-items-center","gap-1","waves-effect","waves-light"],[1,"sa-icon",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#plus"],[1,"card","border-0","shadow-sm"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"text-end"],[1,"d-none","d-md-table-cell"],[1,"d-none","d-lg-table-cell"],[1,"fw-500"],[1,"text-muted","small"],[1,"text-end","fw-500"],[1,"text-muted","small","d-none","d-md-table-cell"],[1,"font-monospace","small","d-none","d-lg-table-cell"],[1,"text-end",2,"white-space","nowrap"],[1,"d-flex","justify-content-end","gap-1"],["title","\u6AA2\u8996",1,"btn","btn-sm","btn-ghost-secondary","d-inline-flex","align-items-center","waves-effect",3,"routerLink"],["title","\u7DE8\u8F2F",1,"btn","btn-sm","btn-ghost-primary","d-inline-flex","align-items-center","waves-effect",3,"routerLink"],["href","/assets/icons/sprite.svg#edit"],["title","\u522A\u9664",1,"btn","btn-sm","btn-ghost-danger","d-inline-flex","align-items-center","waves-effect",3,"click"],["href","/assets/icons/sprite.svg#trash"],["href","/assets/icons/sprite.svg#eye"],["colspan","8",1,"text-center","text-muted","py-4"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),f(),t(3,"svg",3),m(4,"use",4),i(),h(),t(5,"h4",5),a(6,"\u51FA\u5DEE\u7533\u8ACB"),i()(),t(7,"a",6),f(),t(8,"svg",7),m(9,"use",8),i(),a(10," \u65B0\u589E\u7533\u8ACB "),i()(),h(),t(11,"div",9)(12,"div",10)(13,"div",11)(14,"table",12)(15,"thead",13)(16,"tr")(17,"th"),a(18,"\u51FA\u5DEE\u5730\u9EDE"),i(),t(19,"th"),a(20,"\u958B\u59CB\u65E5\u671F"),i(),t(21,"th"),a(22,"\u7D50\u675F\u65E5\u671F"),i(),t(23,"th",14),a(24,"\u9810\u4F30\u8CBB\u7528"),i(),t(25,"th",15),a(26,"\u76EE\u7684"),i(),t(27,"th",16),a(28,"\u5C08\u6848"),i(),t(29,"th"),a(30,"\u72C0\u614B"),i(),t(31,"th",14),a(32,"\u64CD\u4F5C"),i()()(),t(33,"tbody"),k(34,Cl,23,19,"tr",null,Sl,!1,yl,3,0,"tr"),D(37,"async"),i()()()()()()),e&2&&(l(34),B(ie(37,1,o.requests$)))},dependencies:[V,ae,ve,De],encapsulation:2})};var Al=(r,n)=>n.id;function wl(r,n){r&1&&(t(0,"div",19),a(1,"\u8ACB\u586B\u5BEB\u51FA\u5DEE\u5730\u9EDE\u3002"),i())}function Fl(r,n){r&1&&(t(0,"div",19),a(1,"\u8ACB\u8F38\u5165\u9810\u4F30\u8CBB\u7528\u3002"),i())}function Tl(r,n){r&1&&(t(0,"div",19),a(1,"\u8ACB\u9078\u64C7\u51FA\u767C\u65E5\u671F\u3002"),i())}function Dl(r,n){r&1&&(t(0,"div",19),a(1,"\u8ACB\u9078\u64C7\u8FD4\u56DE\u65E5\u671F\u3002"),i())}function Il(r,n){if(r&1&&(t(0,"option",25),a(1),i()),r&2){let e=n.$implicit;_("ngValue",e.id),l(),Te("",e.code,"",e.departmentName?"\uFF08"+e.departmentName+"\uFF09":"")}}function Ll(r,n){r&1&&(t(0,"div",19),a(1,"\u8ACB\u586B\u5BEB\u51FA\u5DEE\u76EE\u7684\u3002"),i())}function kl(r,n){if(r&1&&(t(0,"div",28)(1,"button",30),a(2),i(),t(3,"a",31),a(4,"\u53D6\u6D88"),i()()),r&2){let e=u();l(),_("disabled",e.form.invalid),l(),E(" ",e.isReturned?"\u4FEE\u6539\u4E26\u91CD\u9001":e.isEdit?"\u66F4\u65B0":"\u9001\u51FA\u7533\u8ACB"," ")}}function Bl(r,n){r&1&&(t(0,"div",29)(1,"a",31),a(2,"\u8FD4\u56DE\u5217\u8868"),i()())}var xt=class r{fb=p(Z);service=p(et);projects$=p(Pe);route=p(de);router=p(ce);isEdit=!1;requestId=0;isReadOnly=!1;isReturned=!1;projects=[];statusLabel=ei;statusClass=ti;form=this.fb.group({destination:["",F.required],startDate:["",F.required],endDate:["",F.required],estimatedCost:[0,[F.required,F.min(0)]],purpose:["",F.required],projectId:[null]});ngOnInit(){this.projects$.getAll().subscribe(e=>this.projects=e);let n=this.route.snapshot.paramMap.get("id");n&&(this.isEdit=!0,this.requestId=+n,this.service.getById(this.requestId).subscribe(e=>{e&&(this.isReturned=e.approvalStatus==="returned",this.isReadOnly=e.approvalStatus!=="pending"&&e.approvalStatus!=="returned",this.form.patchValue({destination:e.destination,startDate:e.startDate instanceof Date?e.startDate.toISOString().split("T")[0]:String(e.startDate),endDate:e.endDate instanceof Date?e.endDate.toISOString().split("T")[0]:String(e.endDate),estimatedCost:e.estimatedCost,purpose:e.purpose,projectId:e.projectId??null}),this.isReadOnly&&this.form.disable())}))}submit(){if(this.form.invalid||this.isReadOnly)return;let n=this.form.value,e=this.projects.find(v=>v.id===n.projectId),o={destination:n.destination,startDate:new Date(n.startDate),endDate:new Date(n.endDate),estimatedCost:+n.estimatedCost,purpose:n.purpose,projectId:n.projectId??void 0,projectCode:e?.code};(this.isEdit?this.service.update(this.requestId,o):this.service.create(o)).subscribe(()=>this.router.navigate(["/admin/travel-requests"]))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-travel-request-form"]],decls:63,vars:9,consts:[[1,"container-fluid","py-3"],[1,"d-flex","align-items-center","gap-2","mb-4"],["routerLink","/admin/travel-requests",1,"btn","btn-sm","btn-outline-secondary","waves-effect"],[1,"sa-icon"],["href","/assets/icons/sprite.svg#arrow-left"],[1,"mb-0"],[3,"ngSubmit","formGroup"],[1,"row","g-4"],[1,"col-12","col-lg-10","col-xl-8"],[1,"card","border-0","shadow-sm"],[1,"card-header","bg-transparent","border-bottom","d-flex","align-items-center","gap-2","fw-600"],[1,"sa-icon","text-primary",2,"stroke","currentColor"],["href","/assets/icons/sprite.svg#map-pin"],[1,"card-body"],[1,"row","g-3","mb-3"],[1,"col-12","col-md-6"],[1,"form-label","fw-500"],[1,"text-danger"],["type","text","formControlName","destination","placeholder","\u4F8B\u5982\uFF1A\u53F0\u5357\u3001\u53F0\u4E2D",1,"form-control"],[1,"text-danger","small","mt-1"],["type","number","formControlName","estimatedCost","min","0","placeholder","0",1,"form-control"],[1,"col-12","col-md-4"],["type","date","formControlName","startDate",1,"form-control"],["type","date","formControlName","endDate",1,"form-control"],["formControlName","projectId",1,"form-select"],[3,"ngValue"],[1,"mb-3"],["formControlName","purpose","rows","3","placeholder","\u8ACB\u586B\u5BEB\u51FA\u5DEE\u76EE\u7684...",1,"form-control"],[1,"mt-4","d-flex","gap-2"],[1,"mt-4"],["type","submit",1,"btn","btn-primary","waves-effect","waves-light",3,"disabled"],["routerLink","/admin/travel-requests",1,"btn","btn-outline-secondary","waves-effect"]],template:function(e,o){if(e&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),f(),t(3,"svg",3),m(4,"use",4),i()(),h(),t(5,"h4",5),a(6),i()(),t(7,"form",6),A("ngSubmit",function(){return o.submit()}),t(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10),f(),t(12,"svg",11),m(13,"use",12),i(),a(14," \u51FA\u5DEE\u8CC7\u8A0A "),i(),h(),t(15,"div",13)(16,"div",14)(17,"div",15)(18,"label",16),a(19,"\u51FA\u5DEE\u5730\u9EDE "),t(20,"span",17),a(21,"*"),i()(),m(22,"input",18),g(23,wl,2,0,"div",19),i(),t(24,"div",15)(25,"label",16),a(26,"\u9810\u4F30\u8CBB\u7528\uFF08\u5143\uFF09"),t(27,"span",17),a(28,"*"),i()(),m(29,"input",20),g(30,Fl,2,0,"div",19),i()(),t(31,"div",14)(32,"div",21)(33,"label",16),a(34,"\u51FA\u767C\u65E5\u671F "),t(35,"span",17),a(36,"*"),i()(),m(37,"input",22),g(38,Tl,2,0,"div",19),i(),t(39,"div",21)(40,"label",16),a(41,"\u8FD4\u56DE\u65E5\u671F "),t(42,"span",17),a(43,"*"),i()(),m(44,"input",23),g(45,Dl,2,0,"div",19),i(),t(46,"div",21)(47,"label",16),a(48,"\u95DC\u806F\u5C08\u6848\uFF08\u9078\u586B\uFF09"),i(),t(49,"select",24)(50,"option",25),a(51,"\u2014 \u4E0D\u95DC\u806F\u5C08\u6848 \u2014"),i(),k(52,Il,2,3,"option",25,Al),i()()(),t(54,"div",26)(55,"label",16),a(56,"\u51FA\u5DEE\u76EE\u7684 "),t(57,"span",17),a(58,"*"),i()(),m(59,"textarea",27),g(60,Ll,2,0,"div",19),i()()(),g(61,kl,5,2,"div",28)(62,Bl,3,0,"div",29),i()()()()),e&2){let s,v,y,T,R;l(6),c(o.isEdit?o.isReadOnly?"\u6AA2\u8996\u51FA\u5DEE\u7533\u8ACB":o.isReturned?"\u4FEE\u6539\u51FA\u5DEE\u7533\u8ACB\uFF08\u9000\u56DE\uFF09":"\u7DE8\u8F2F\u51FA\u5DEE\u7533\u8ACB":"\u65B0\u589E\u51FA\u5DEE\u7533\u8ACB"),l(),_("formGroup",o.form),l(16),x((s=o.form.get("destination"))!=null&&s.invalid&&((s=o.form.get("destination"))!=null&&s.touched)?23:-1),l(7),x((v=o.form.get("estimatedCost"))!=null&&v.invalid&&((v=o.form.get("estimatedCost"))!=null&&v.touched)?30:-1),l(8),x((y=o.form.get("startDate"))!=null&&y.invalid&&((y=o.form.get("startDate"))!=null&&y.touched)?38:-1),l(7),x((T=o.form.get("endDate"))!=null&&T.invalid&&((T=o.form.get("endDate"))!=null&&T.touched)?45:-1),l(5),_("ngValue",null),l(2),B(o.projects),l(8),x((R=o.form.get("purpose"))!=null&&R.invalid&&((R=o.form.get("purpose"))!=null&&R.touched)?60:-1),l(),x(o.isReadOnly?62:61)}},dependencies:[X,K,Ce,ye,J,fe,Ee,Y,z,be,Q,W,V],encapsulation:2})};var Mp=[{path:"",redirectTo:"users",pathMatch:"full"},{path:"users",component:Tt,data:{title:"\u54E1\u5DE5\u7BA1\u7406"}},{path:"users/new",component:st,data:{title:"\u65B0\u589E\u54E1\u5DE5"}},{path:"users/:id/edit",component:st,data:{title:"\u7DE8\u8F2F\u54E1\u5DE5"}},{path:"departments",component:Rt,data:{title:"\u90E8\u9580\u7BA1\u7406"}},{path:"departments/new",component:ut,data:{title:"\u65B0\u589E\u90E8\u9580"}},{path:"departments/:id/edit",component:ut,data:{title:"\u7DE8\u8F2F\u90E8\u9580"}},{path:"job-titles",component:Pt,data:{title:"\u8077\u7A31\u7BA1\u7406"}},{path:"job-titles/new",component:pt,data:{title:"\u65B0\u589E\u8077\u7A31"}},{path:"job-titles/:id/edit",component:pt,data:{title:"\u7DE8\u8F2F\u8077\u7A31"}},{path:"approvals",component:jt,data:{title:"\u7C3D\u6838\u7BA1\u7406"}},{path:"approvals/:id/flow",component:Nt,data:{title:"\u7C3D\u6838\u6D41\u7A0B"}},{path:"roles",component:It,canActivate:[Ue],data:{title:"\u89D2\u8272\u7BA1\u7406",permission:"superadmin"}},{path:"roles/new",component:mt,canActivate:[Ue],data:{title:"\u65B0\u589E\u89D2\u8272",permission:"superadmin"}},{path:"roles/:id/edit",component:mt,canActivate:[Ue],data:{title:"\u7DE8\u8F2F\u89D2\u8272",permission:"superadmin"}},{path:"permissions",component:Lt,canActivate:[Ue],data:{title:"\u6B0A\u9650\u7BA1\u7406",permission:"superadmin"}},{path:"permissions/new",component:dt,canActivate:[Ue],data:{title:"\u65B0\u589E\u6B0A\u9650",permission:"superadmin"}},{path:"permissions/:id/edit",component:dt,canActivate:[Ue],data:{title:"\u7DE8\u8F2F\u6B0A\u9650",permission:"superadmin"}},{path:"projects",component:Vt,data:{title:"\u5C08\u6848\u7BA1\u7406"}},{path:"projects/new",component:ct,data:{title:"\u65B0\u589E\u5C08\u6848"}},{path:"projects/:id/edit",component:ct,data:{title:"\u7DE8\u8F2F\u5C08\u6848"}},{path:"payment-requests",component:Mt,data:{title:"\u8ACB\u6B3E\u7533\u8ACB"}},{path:"payment-requests/new",component:bt,data:{title:"\u65B0\u589E\u8ACB\u6B3E\u7533\u8ACB"}},{path:"payment-requests/:id/edit",component:bt,data:{title:"\u7DE8\u8F2F\u8ACB\u6B3E\u7533\u8ACB"}},{path:"leave-requests",component:Xt,data:{title:"\u8ACB\u5047\u7533\u8ACB"}},{path:"leave-requests/new",component:gt,data:{title:"\u65B0\u589E\u8ACB\u5047\u7533\u8ACB"}},{path:"leave-requests/:id/edit",component:gt,data:{title:"\u7DE8\u8F2F\u8ACB\u5047\u7533\u8ACB"}},{path:"travel-requests",component:ii,data:{title:"\u51FA\u5DEE\u7533\u8ACB"}},{path:"travel-requests/new",component:xt,data:{title:"\u65B0\u589E\u51FA\u5DEE\u7533\u8ACB"}},{path:"travel-requests/:id/edit",component:xt,data:{title:"\u7DE8\u8F2F\u51FA\u5DEE\u7533\u8ACB"}},{path:"approval-tasks",component:Kt,data:{title:"\u7C3D\u6838\u4F5C\u696D"}},{path:"approval-tasks/:applicationType/:id/review",component:Wt,data:{title:"\u5BE9\u6838"}},{path:"settings",component:Bt,data:{title:"\u7CFB\u7D71\u8A2D\u5B9A"}}];export{Mp as ADMIN_ROUTES};
