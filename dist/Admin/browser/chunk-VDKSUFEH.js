import{Pc as p,Sc as v,U as l,Z as n,a as o,b as m,l as d,p as s}from"./chunk-D3HV4FU7.js";function c(a){let e=new Date;return e.setDate(e.getDate()-a),e}function f(a){let e=new Date;return e.setDate(e.getDate()+a),e}var g=[{id:1,employeeId:"1",overtimeDate:new Date,projectIds:[1,3],projectCodes:["P2024-001","P2024-003"],estimatedHours:3,reason:"\u5C08\u6848\u8D95\u5DE5\uFF0C\u9700\u52A0\u73ED\u5B8C\u6210\u6A21\u7D44\u958B\u767C\u8207\u7CFB\u7D71\u6E2C\u8A66",approvalStatus:"approved",createdAt:c(1),reviewedAt:c(1),reviewNote:"\u6838\u51C6"},{id:2,employeeId:"2",overtimeDate:f(1),projectIds:[2],projectCodes:["P2024-002"],estimatedHours:2,reason:"\u5BA2\u6236\u5831\u544A\u622A\u6B62\u65E5\u524D\u9700\u5B8C\u6210",approvalStatus:"pending",createdAt:new Date}],b=class a{http=n(p);auth=n(v);items$=new d(g);getAll(){return this.items$.asObservable()}getPaged(e,t){let i=this.auth.currentUser()?.id,r=this.items$.getValue().filter(h=>h.employeeId===i),u=(e-1)*t,O=Math.max(1,Math.ceil(r.length/t));return s({items:r.slice(u,u+t),totalCount:r.length,page:e,pageSize:t,totalPages:O})}getById(e){return s(this.items$.getValue().find(t=>t.id===e))}create(e){let t=this.auth.currentUser()?.id,i=m(o({},e),{id:Date.now(),employeeId:t,approvalStatus:"pending",createdAt:new Date});return this.items$.next([...this.items$.getValue(),i]),s(i)}update(e,t){let i=this.items$.getValue().map(r=>r.id===e?o(o({},r),t):r);return this.items$.next(i),s(i.find(r=>r.id===e))}delete(e){return this.items$.next(this.items$.getValue().filter(t=>t.id!==e)),s(void 0)}getApprovedForToday(){let e=this.auth.currentUser()?.id,t=new Date().toISOString().split("T")[0],i=this.items$.getValue().filter(r=>r.employeeId===e&&r.approvalStatus==="approved"&&new Date(r.overtimeDate).toISOString().split("T")[0]===t);return s(i)}static \u0275fac=function(t){return new(t||a)};static \u0275prov=l({token:a,factory:a.\u0275fac,providedIn:"root"})};export{b as a};
